<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <meta name="generator" content="pandoc">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
                                <title>ラグランジュ形式の力学</title>

        <style>
            .btn-square {
                display: inline-block;
                padding: 0.5em 0.5em;
                text-decoration: none;
                background: #668ad8;
                color: #FFF;
                border-bottom: solid 4px #626295;
                border-radius: 5px;
            }

            .btn-square:active {
                -webkit-transform: translateY(4px);
                transform: translateY(4px);
                border-bottom: none;
            }

            .markdown-body {
                box-sizing: border-box;
                min-width: 200px;
                max-width: 980px;
                margin: 0 auto;
                padding: 45px;
            }

            @media (max-width: 767px) {
                .markdown-body {
                    padding: 15px;
                }
            }
        </style>

        <meta name="viewport" content="width=device-width, initial-scale=1">

                <script
                src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
                type="text/javascript"></script>
                        <link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
        <link rel="icon" href="https://kaityo256.github.io/classical_mechanics/favicon.ico">
        <link rel="stylesheet" href="https://kaityo256.github.io/classical_mechanics/github-markdown.css"
            type="text/css" />
    </head>

    <body>
        <article class="markdown-body">
                                    <header>
                <h1 class="title">ラグランジュ形式の力学</h1>
                                                            </header>
                                    <p><a href="../index.html">[Up]</a>
                                    <a
                                    href="https://github.com/kaityo256/classical_mechanics">[Repository]</a></p>
                                    <p>これから、解析力学の解析力学らしいところ、すなわち変数変換に対する運動方程式の変換について扱う。解析力学はニュートン力学を再定式化したものであるから、本質的には同じ問題を別の表示に書き換えているのに過ぎない。しかし、別の形式で書き直した方が見通しがよくなるし、ニュートン力学では見えなかった世界が見えてくる。これからニュートン力学からラグランジュ形式の力学、そしてハミルトン形式の力学へと続いていくが、その前にニュートン力学のままだと変数変換が面倒であることを見ておこう。</p>
                                    <h1
                                    id="座標変換とベクトル">座標変換とベクトル</h1>
                                    <p>解析力学とは、座標変換の学問である。そこで、座標変換について簡単にまとめておこう。一般に、ベクトルは適当な基底を選ぶことで成分表示できる。同じベクトルでも、別の基底を選ぶと成分が変わる。この成分の変化のし方により、ベクトルは反変ベクトルと共変ベクトルに分類される。</p>
                                    <figure>
                                    <img
                                    src="fig/contravariant_vector.png"
                                    alt="反変ベクトル" />
                                    <figcaption
                                    aria-hidden="true">反変ベクトル</figcaption>
                                    </figure>
                                    <p>例を挙げよう。基底<span
                                    class="math inline">\(\{\boldsymbol{e}_1,
                                    \boldsymbol{e}_2\}\)</span>で張られる二次元空間があり、あるベクトル<span
                                    class="math inline">\(\boldsymbol{u}\)</span>がこの基底により</p>
                                    <p><span class="math display">\[
                                    \boldsymbol{u} = 6 \boldsymbol{e}_1
                                    + 4 \boldsymbol{e}_2
                                    \]</span></p>
                                    <p>と展開されているとしよう。この時、ベクトルの成分表示は<span
                                    class="math inline">\(\boldsymbol{u}
                                    =
                                    (6,4)\)</span>となる。さて、基底の長さを2倍にしてみよう。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \tilde{\boldsymbol{e}}_1 &amp;= 2
                                    \boldsymbol{e}_1 \\
                                    \tilde{\boldsymbol{e}}_2 &amp;= 2
                                    \boldsymbol{e}_2
                                    \end{aligned}
                                    \]</span></p>
                                    <p>新しい基底<span
                                    class="math inline">\(\{\tilde{\boldsymbol{e}}_1,
                                    \tilde{\boldsymbol{e}}_2\}\)</span>で<span
                                    class="math inline">\(\boldsymbol{u}\)</span>を展開すると、</p>
                                    <p><span class="math display">\[
                                    \boldsymbol{u} = 3
                                    \tilde{\boldsymbol{e}}_1 + 2
                                    \tilde{\boldsymbol{e}}_2
                                    \]</span></p>
                                    <p>となる。この時、ベクトルの成分表示は<span
                                    class="math inline">\(\boldsymbol{u}
                                    =
                                    (3,2)\)</span>と、元の半分になる。このように、基底の長さを2倍にした時、成分が半分となるようなベクトルを、基底と反対向きの変換を受けるという意味で反変ベクトル(contravariant
                                    vectorと呼ぶ。このように、基底で展開した成分は反変ベクトルとなる。反変ベクトルの正確な定義は後に与える。</p>
                                    <p>この事実を一般化しておこう。いま、あるベクトル<span
                                    class="math inline">\(\boldsymbol{u}\)</span>が正規直交基底<span
                                    class="math inline">\(\{\boldsymbol{e}_i\}\)</span>により、以下のように成分表示されているとしよう。</p>
                                    <p><span class="math display">\[
                                    \boldsymbol{u} = u^i
                                    \boldsymbol{e}_i
                                    \]</span></p>
                                    <p>同じ記号が現れた場合(今回は<span
                                    class="math inline">\(i\)</span>)はその記号について和を取るというアインシュタイン規約を用いている。さて、なにか適当な行列<span
                                    class="math inline">\(T\)</span>を用いて、基底が<span
                                    class="math inline">\(\{\boldsymbol{e}_i\}\)</span>から、別の正規直交基底<span
                                    class="math inline">\(\{\tilde{\boldsymbol{e}}_i\}\)</span>に以下のように変換されたとする。</p>
                                    <p><span class="math display">\[
                                    \tilde{\boldsymbol{e}}_i = T^k_{\,i}
                                    \boldsymbol{e}_k
                                    \]</span></p>
                                    <p>ベクトル<span
                                    class="math inline">\(\boldsymbol{u}\)</span>を新しい基底<span
                                    class="math inline">\(\{\tilde{\boldsymbol{e}}_i\}\)</span>で展開すると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \boldsymbol{u} &amp;= \tilde{u}^k
                                    \tilde{\boldsymbol{e}}_k \\
                                    &amp;= \tilde{u}^k T^j_{\,k}
                                    \boldsymbol{e}_j
                                    \end{aligned}
                                    \]</span></p>
                                    <p>両辺について<span
                                    class="math inline">\(\boldsymbol{e}^i\)</span>と内積をとると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    u^i &amp;= \tilde{u}^k T^j_{\,k}
                                    (\boldsymbol{e}^i,\boldsymbol{e}_j),\\
                                    &amp;= \tilde{u}^k T^j_{\,k}
                                    \delta^i_{\,j}, \\
                                    &amp;= T^i_{\,k} \tilde{u}^k.
                                    \end{aligned}
                                    \]</span></p>
                                    <p>基底の変換と並べてみると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \tilde{\boldsymbol{e}}_i &amp;=
                                    T^k_{\,i} \boldsymbol{e}_k \\
                                    u^i &amp;= T^i_{\,k} \tilde{u}^k
                                    \end{aligned}
                                    \]</span></p>
                                    <p>チルダが現れる項が左右逆になっていることがわかる。基底の変換と反対の変換を受けるから、<span
                                    class="math inline">\(\boldsymbol{u}\)</span>は反変ベクトルと呼ぶ。</p>
                                    <p>反変ベクトルは逆に、チルダが同じ側に現れるのが共変ベクトルである。定義から、基底自身は共変ベクトルとなる。さらに、先程、反変ベクトルであることがわかった成分ベクトルを縦ベクトルとすると、その双対である横ベクトルが共変ベクトルとなる。</p>
                                    <p><span
                                    class="math inline">\(\{\boldsymbol{e}_i\}\)</span>や<span
                                    class="math inline">\(\{\tilde{\boldsymbol{e}}_i\}\)</span>が張っていた縦ベクトルの空間と共役な空間を張る、横ベクトルの基底<span
                                    class="math inline">\(\{\boldsymbol{e}^i\}\)</span>や<span
                                    class="math inline">\(\{\tilde{\boldsymbol{e}}^i\}\)</span>を考えよう。以下のように、共役なベクトルとの直交性を課す。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    (\boldsymbol{e}^j,\boldsymbol{e}_i)
                                    &amp;= \delta^j_{\,i} \\
                                    (\tilde{\boldsymbol{e}}^j,\tilde{\boldsymbol{e}}_i)
                                    &amp;= \delta^j_{\,i} \\
                                    \end{aligned}
                                    \]</span></p>
                                    <p>さて、縦ベクトルが<span
                                    class="math inline">\(\tilde{\boldsymbol{e}}_i
                                    = T^k_{\,i}
                                    \boldsymbol{e}_k\)</span>と変換される時、横ベクトルがどのように変換されるか見てみよう。チルダ付きの横ベクトルが、チルダの無い横ベクトルで</p>
                                    <p><span class="math display">\[
                                    \tilde{\boldsymbol{e}}^i = M^i_{\,k}
                                    \boldsymbol{e}^k
                                    \]</span></p>
                                    <p>と展開できるとする。両辺、<span
                                    class="math inline">\(\boldsymbol{e}_j\)</span>との内積を取ると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    (\tilde{\boldsymbol{e}}^i,
                                    \boldsymbol{e}_j) &amp;= M^i_{\,k}
                                    (\boldsymbol{e}^k, \boldsymbol{e}_j)
                                    &amp;= M^i_{\,k} \delta^k_{\,j} \\
                                    &amp;= M^i_{\,j}
                                    \end{aligned}
                                    \]</span></p>
                                    <p>縦ベクトルのチルダ付きとチルダ無しの関係を考える。</p>
                                    <p><span class="math display">\[
                                    \tilde{\boldsymbol{e}}_i = T^k_{\,i}
                                    \boldsymbol{e}_k.
                                    \]</span></p>
                                    <p><span
                                    class="math inline">\(\tilde{\boldsymbol{e}}^j\)</span>と内積をとると、左辺は直交性から</p>
                                    <p><span class="math display">\[
                                    (\tilde{\boldsymbol{e}}^j,
                                    \tilde{\boldsymbol{e}}_i) =
                                    \delta^j_{\,i}.
                                    \]</span></p>
                                    <p>右辺は、先程求めた<span
                                    class="math inline">\((\tilde{\boldsymbol{e}}^i,
                                    \boldsymbol{e}_j) =
                                    M^i_{\,j}\)</span>を代入することで</p>
                                    <p><span class="math display">\[
                                    T^k_{\,i} (\tilde{\boldsymbol{e}}^j,
                                    \boldsymbol{e}_k) =   M^j_{\,k}
                                    T^k_{\,i}
                                    \]</span></p>
                                    <p>以上から、</p>
                                    <p><span class="math display">\[
                                    M^j_{\,k} T^k_{\,i} = \delta^j_{\,i}
                                    \]</span></p>
                                    <p>これは、行列<span
                                    class="math inline">\(M\)</span>と<span
                                    class="math inline">\(T\)</span>が互いに逆行列の関係にあることを意味する。</p>
                                    <p>さて、横ベクトル<span
                                    class="math inline">\(\boldsymbol{v}\)</span>が、横ベクトルの基底で</p>
                                    <p><span class="math display">\[
                                    \boldsymbol{v} = v_i
                                    \boldsymbol{e}^i = \tilde{v}_i
                                    \boldsymbol{e}^i
                                    \]</span></p>
                                    <p>と展開されているとしよう。縦ベクトルと同様な議論から、</p>
                                    <p><span class="math display">\[
                                    v^i = M^i_{\,k} \tilde{v}^k
                                    \]</span></p>
                                    <p>が成立する。両辺に行列<span
                                    class="math inline">\(T\)</span>をかけると、</p>
                                    <p>縦ベクトルの基底の変換の式と並べると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \tilde{\boldsymbol{e}}_i &amp;=
                                    T^k_{\,i} \boldsymbol{e}_k \\
                                    \tilde{v}^k &amp;= T^k_{\,i }v^i
                                    \end{aligned}
                                    \]</span></p>
                                    <p>のように、基底の変換とベクトルの変換のチルダのある方が同じ側に来ることがわかる。このような変換をするベクトルを共変ベクトルと呼ぶ。すなわち、横ベクトルは縦ベクトルの基底変換に対して共変性を持つ。</p>
                                    <p>解析力学においては、線形でない基底変換も考慮する。一般に、<span
                                    class="math inline">\(\{x^i\}\)</span>から<span
                                    class="math inline">\(\{\tilde{x}^i\}\)</span>への座標変換において、</p>
                                    <p><span class="math display">\[
                                    \tilde{A}^i = \frac{\partial
                                    \tilde{x}^i}{\partial x^j} A^j
                                    \]</span></p>
                                    <p>のように変換を受けるベクトル<span
                                    class="math inline">\(\boldsymbol{A}\)</span>を
                                    <strong>反変ベクトル(contravariant
                                    vector)</strong>
                                    と呼び、添字を右上につける。チルダのある量を左辺に持ってきた時、右辺の変換行列の偏微分の分子にチルダが現れるのが反変ベクトルである。この変換公式が反変ベクトルの定義を与える。ここで、座標の変換行列を偏微分で表現したが、この変換が先程の線形変換を特殊な場合として含んでいることに注意すること。</p>
                                    <p>逆に、</p>
                                    <p><span class="math display">\[
                                    \tilde{B}_i = \frac{\partial
                                    x^i}{\partial \tilde{x}^j} B_j
                                    \]</span></p>
                                    <p>のように変換を受けるベクトル<span
                                    class="math inline">\(\boldsymbol{B}\)</span>を
                                    <strong>共変ベクトル (covariant
                                    vector)</strong>
                                    と呼び、添字を右下につける。チルダのある量を左辺に持ってきた時、右辺の変換行列の偏微分の分母にチルダが現れるのが反変ベクトルである。この変換公式が共変ベクトルの定義を与える。</p>
                                    <p>非線形な座標変換の典型例がデカルト座標から極座標への変換である。例えば<span
                                    class="math inline">\((x,y)\)</span>と<span
                                    class="math inline">\((r,\theta)\)</span>の変換を考えよう。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    x &amp;= r \cos\theta \\
                                    y &amp;= r \sin \theta
                                    \end{aligned}
                                    \]</span></p>
                                    <p>この変換は非線形だが、全微分を考えるとベクトルとみなすことができる。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    dx &amp;= \cos \theta dr - r \sin
                                    \theta d\theta \\
                                    dy &amp;= \sin \theta dr + r \cos
                                    \theta d\theta \\
                                    \end{aligned}
                                    \]</span></p>
                                    <p>これは、基底<span
                                    class="math inline">\(\{dr,
                                    d\theta\}\)</span>から、<span
                                    class="math inline">\(\{dx,
                                    dy\}\)</span>への線形変換と見ることができる。後で見やすいように、<span
                                    class="math inline">\((r,\theta)\)</span>を<span
                                    class="math inline">\((x^1,x^2)\)</span>、<span
                                    class="math inline">\((x,y)\)</span>を<span
                                    class="math inline">\(\tilde{x}^1,
                                    \tilde{x}^2\)</span>と表記すると、先程の全微分の式は、</p>
                                    <p><span class="math display">\[
                                    d\tilde{x}^i = \frac{\partial
                                    \tilde{x}^i}{\partial x^k} dx^k
                                    \]</span></p>
                                    <p>とまとめることができる。例えば</p>
                                    <p><span class="math display">\[
                                    \frac{\partial \tilde{x}_1}{\partial
                                    x_2} \equiv \frac{\partial
                                    x}{\partial \theta}
                                    \]</span></p>
                                    <p>である。このように、座標の微分<span
                                    class="math inline">\(dx,
                                    dy\)</span>や<span
                                    class="math inline">\(dr,
                                    d\theta\)</span>は自然に反変ベクトルとなる。</p>
                                    <p>数学的準備の章にて、<span
                                    class="math inline">\(dx\)</span>を縦ベクトルとみなすと、<span
                                    class="math inline">\(\partial_x\)</span>が自然な双対基底であり、横ベクトルとみなせることを見た。従って、<span
                                    class="math inline">\(\partial_x,
                                    \partial_y\)</span>は共変ベクトルとなることが期待される。</p>
                                    <p>いま、<span
                                    class="math inline">\((x^1,
                                    x^2)\)</span>で張られる空間に、スカラー関数<span
                                    class="math inline">\(f(x^1,
                                    x^2)\)</span>があるとしよう。この関数の勾配(gradient)が、変数変換<span
                                    class="math inline">\((x^1, x^2)
                                    \rightarrow (\tilde{x}^1,
                                    \tilde{x}^2)\)</span>でどのように変換されるか見てみよう。合成関数の偏微分の公式から、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{\partial f}{\partial
                                    \tilde{x}^1} &amp;=
                                    \frac{\partial f}{\partial x^1}
                                    \frac{\partial x^1}{\partial
                                    \tilde{x}^1}+
                                    \frac{\partial f}{\partial x^2}
                                    \frac{\partial x^2}{\partial
                                    \tilde{x}^1}\\
                                    \frac{\partial f}{\partial
                                    \tilde{x}^2} &amp;=
                                    \frac{\partial f}{\partial x^1}
                                    \frac{\partial x^1}{\partial
                                    \tilde{x}^2}+
                                    \frac{\partial f}{\partial x^2}
                                    \frac{\partial x^2}{\partial
                                    \tilde{x}^2}\\
                                    \end{aligned}
                                    \]</span></p>
                                    <p>これが任意の<span
                                    class="math inline">\(f\)</span>について成り立つので、</p>
                                    <p><span class="math display">\[
                                    \tilde{\partial}_i = \frac{\partial
                                    x^k}{\partial \tilde{x}^i}
                                    \partial_k
                                    \]</span></p>
                                    <p>ここで、<span
                                    class="math inline">\(\partial_i
                                    \equiv
                                    \partial_{q_i}\)</span>、<span
                                    class="math inline">\(\tilde{\partial}_i
                                    \equiv
                                    \partial_{\tilde{q}_i}\)</span>という表記を用いた。右辺に現れる偏微分の分母にチルダのある量が現れているため、<span
                                    class="math inline">\(\{\partial_i\}\)</span>は共変ベクトルであることがわかる(そのため、添字を下に書いている)。</p>
                                    <p>二つ並べると共変性、反変性がわかりやすい。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    d\tilde{x}^i &amp;= \frac{\partial
                                    \tilde{x}^i}{\partial x^k} dx^k\\
                                    \tilde{\partial}_i &amp;=
                                    \frac{\partial x^k}{\partial
                                    \tilde{x}^i} \partial_k
                                    \end{aligned}
                                    \]</span></p>
                                    <p>チルダなしの量からチルダ付きの量に変換した時、偏微分の上下どちらにチルダが現れるかが逆になっていることがわかる。このように、座標変換により変換を受ける量を一般に
                                    <strong>ベクトル (vector)</strong>
                                    と呼ぶ。一方、座標変換により変換を受けない量を
                                    <strong>スカラー(scolar)</strong>
                                    と呼ぶ。例えば二次元平面 <span
                                    class="math inline">\((x^1,
                                    x^2)\)</span>で定義された関数<span
                                    class="math inline">\(f(x^1,x^2)\)</span>は、座標変換<span
                                    class="math inline">\((x^1, x^2)
                                    \rightarrow (\tilde{x}^1,
                                    \tilde{x}^2)\)</span>により値が変わらない。これは、例えば座標を変えても、今立っている場所の標高が変わらないのと同様である。一方、座標のスケールをメートルからキロメートルに変えると、勾配の大きさは変わる。メートルで勾配を測っている時には「メートルあたりどれだけ高さが変化するか」であったが、キロメートルで測ると「キロメートルあたりどれだけ高さが変化するか」となるため、勾配ベクトルは大きくなる。従って、勾配は共変ベクトルである。</p>
                                    <p>反変ベクトルと共変ベクトルは、スカラーを掛けたり割ったりしても反変性や共変性は変わらない。また、反変ベクトルと共変ベクトルは内積を取ることでスカラー量となる。また、ベクトルが等式で結ばれている時、片方が反変ベクトルであるなら、もう片方も反変ベクトルでなければならない。</p>
                                    <h1
                                    id="ニュートンの運動方程式の共変性">ニュートンの運動方程式の共変性</h1>
                                    <p>物理学は自然法則を記述する学問である。何かの現象を記述する際、どのような座標系を選ぶかは任意であるから、物理法則が座標系に依存してはならない。一般に速度や位置はベクトル量であるから座標変換によりその値を変えるが、その関係を示す運動法則は変わってはならない。このような性質を
                                    <strong>共変性(covariance)</strong>
                                    と呼ぶ。以下では、ニュートンの運動方程式が座標変換に対してどのように変換を受けるか見てみよう。</p>
                                    <p>ニュートンの運動方程式は以下のように書ける。</p>
                                    <p><span class="math display">\[
                                    m\frac{d \boldsymbol{v}}{dt} =
                                    \boldsymbol{F}
                                    \]</span></p>
                                    <p>上記では質量は一定としたが、燃料を消費しながら飛ぶロケットなど、運動に従って質量が変化する場合もあるため、質量と速度をまとめた運動量を導入しよう。</p>
                                    <p><span class="math display">\[
                                    \boldsymbol{p} = m \boldsymbol{v}
                                    \]</span></p>
                                    <p>するとニュートンの運動方程式は、運動量の時間変化が、加えられた力と一致する、という意味となる。</p>
                                    <p><span class="math display">\[
                                    \dot{\boldsymbol{p}} =
                                    \boldsymbol{F}
                                    \]</span></p>
                                    <p>さて、このベクトルを成分表示にあたり、<span
                                    class="math inline">\(\boldsymbol{p}\)</span>や<span
                                    class="math inline">\(\boldsymbol{F}\)</span>が反変ベクトルであるか、共変ベクトルであるかを調べなければならない(そうでなければ添字を上付きにすべきか下付きにすべきかわからない)。まず、通常の位置ベクトル<span
                                    class="math inline">\(\boldsymbol{r}\)</span>は、定義から明らかに反変ベクトルである。時間はスカラー量であるから、位置ベクトルの時間微分である速度ベクトルは反変ベクトルである。さらに、質量はスカラー量であるから、速度ベクトルに質量をかけた運動量も反変ベクトルであり、その時間微分も反変ベクトルであるから、等式で結ばれている力ベクトル<span
                                    class="math inline">\(\boldsymbol{F}\)</span>も反変ベクトルとなる。</p>
                                    <p>さて、運動量も力も反変ベクトルであることがわかったので、上付きの添字で成分表示しよう。</p>
                                    <p><span class="math display">\[
                                    \dot{p}^i = F^i
                                    \]</span></p>
                                    <p>となる。今、座標変換<span
                                    class="math inline">\((x^1,
                                    x^2,x^3)\rightarrow
                                    (\tilde{x}^1,\tilde{x}^2,\tilde{x}^3)\)</span>により、<span
                                    class="math inline">\(\boldsymbol{p}
                                    \rightarrow
                                    \tilde{\boldsymbol{p}}\)</span>に変換されたとしよう。反変ベクトルの定義から、変換則は</p>
                                    <p><span class="math display">\[
                                    \tilde{p}^i = \frac{\partial
                                    \tilde{x}^i}{\partial x^k} p^k
                                    \]</span></p>
                                    <p>で与えられる。ここで、成分が</p>
                                    <p><span class="math display">\[
                                    T^i_{\,k} \equiv \frac{\partial
                                    \tilde{x}^i}{\partial x^k}
                                    \]</span></p>
                                    <p>で与えられる行列<span
                                    class="math inline">\(T\)</span>を用意すると、運動量ベクトルは以下のように変換される。</p>
                                    <p><span class="math display">\[
                                    \tilde{\boldsymbol{p}} = T
                                    \boldsymbol{p}
                                    \]</span></p>
                                    <p>力ベクトル<span
                                    class="math inline">\(\boldsymbol{F}\)</span>も同様な変換を受ける。以上から、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \dot{\tilde{p}^i} - \tilde{F}^i
                                    &amp;= T (\dot{p}^i - F^i) \\
                                    \end{aligned}
                                    \]</span></p>
                                    <p>となる。もともとのニュートンの運動方程式から<span
                                    class="math inline">\(\dot{p}^i -
                                    F^i =
                                    0\)</span>であるから右辺がゼロとなるため、左辺もゼロとなる。すなわち、運動方程式</p>
                                    <p><span class="math display">\[
                                    \dot{p}^i = F^i
                                    \]</span></p>
                                    <p>が成立している時、変換後の成分においても</p>
                                    <p><span class="math display">\[
                                    \dot{\tilde{p}^i} =\tilde{F}^i
                                    \]</span></p>
                                    <p>が成り立つ。すなわち、ニュートンの運動方程式は座標の線形変換に対して形を変えない。このような事実を「ニュートンの方程式は、座標の線形変換に対して
                                    <strong>共変(covariant)</strong>
                                    である」と表現する。</p>
                                    <p><strong>共変性(covaiance)</strong>
                                    は
                                    <strong>不変性(invariance)</strong>
                                    とは異なる。例えばスカラー量は座標変換で値そのものを変えないので不変(invariant)である。一方、運動方程式は、座標変換によりベクトルの値は変更を受けるが、形を変えない。従って、線形変換で移ることができる異なる座標系に住む人にとって、同じ形の法則が成り立つ。</p>
                                    <p>同様に、ニュートンの運動方程式はある座標に対して等速直線運動する座標系から見ても形を変えない。これは、以下の座標変換に対応する。</p>
                                    <p><span class="math display">\[
                                    \tilde{\boldsymbol{x}} =
                                    \boldsymbol{x} + \boldsymbol{v}t +
                                    \boldsymbol{c}
                                    \]</span></p>
                                    <p>ニュートンの運動方程式は座標の一般の線形変換に対して共変であるが、系のスケールを変える変換はエネルギースケールを変えてしまうため、スケール変換を伴わない線形変換のみを考慮することが多い。スケール変換を伴わない線形変換は、回転と鏡映変換に分離できる。この、回転、鏡映変換、平行移動、等速度推進の変換をまとめて
                                    <strong>ガリレイ変換(Galilean
                                    transformation)</strong>
                                    と呼ぶ。ニュートンの運動方程式は、ガリレイ変換に対して共変である。</p>
                                    <p>ガリレイ変換は、ある慣性系に対して加速度を持たない別の慣性系への座標変換を表現している。ニュートンの運動方程式がガリレイ変換により共変であるとは、ニュートンの運動方程式がすべての慣性系において同じ形をしていることを意味する。これは逆に、「どの慣性系から見ても同じ運動法則が成り立つようにニュートンの運動方程式が構成されている」と考えることもできる。「どの慣性系から見ても同じ運動法則が成り立つ」という要請をガリレイの相対性原理と呼ぶ。一方、電磁場の基礎方程式であるマクスウェルの方程式は、ガリレイ変換に対して共変ではないが、ローレンツ変換に対して共変性を持つ。ローレンツ変換において、物体の速度が光速に対して無視できるという近似をするとガリレイ変換に帰着する。アインシュタインは運動方程式やマクスウェル方程式を含む全ての物理法則が、あらゆる慣性系から同じように見えなければならないという原理を要請することで、特殊相対性理論を用いた。この要請を特殊相対性原理と呼ぶ。</p>
                                    <p>一般に、物理法則を記述する支配方程式がどのような変換に対して共変であるかを議論するのは重要である。今後、ラグランジュ形式の力学、ハミルトン形式の力学においても、その方程式がどのような変換に対して共変であるかを議論していく。</p>
                                    <h2 id="極座標">極座標</h2>
                                    <h1
                                    id="点変換とラグランジアンの共変性">点変換とラグランジアンの共変性</h1>
                                    <p>ラグランジアンを一般化座標<span
                                    class="math inline">\(q\)</span>と一般化速度<span
                                    class="math inline">\(\dot{q}\)</span>の関数、<span
                                    class="math inline">\(L(\dot{q},q)\)</span>で書いておくと、オイラー・ラグランジュの運動方程式
                                    <span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{q}} \right) -
                                    \frac{\partial L}{\partial q} = 0
                                    \]</span>
                                    が変数変換によって形を変えない。ラグランジアンの共変性は多変数の時にこそ活きるが、かなり式変形がややこしくなるので、まずは一変数の場合について見てみよう。</p>
                                    <p>ある変数<span
                                    class="math inline">\(q\)</span>について、変数変換<span
                                    class="math inline">\(Q =
                                    f(q)\)</span>を考える。<span
                                    class="math inline">\(q\)</span>がオイラー・ラグランジュの運動方程式を満たす時、変数変換後の変数<span
                                    class="math inline">\(Q\)</span>についてもオイラー・ラグランジュの運動方程式
                                    <span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{Q}} \right) -
                                    \frac{\partial L}{\partial Q} = 0
                                    \]</span>
                                    を満たす、というのが証明したいことである。</p>
                                    <p>そのために、まず<span
                                    class="math inline">\(Q =
                                    f(q)\)</span>を<span
                                    class="math inline">\(Q\)</span>について逆に解いて
                                    <span class="math display">\[
                                    q = f^{-1}(Q)
                                    \]</span> と書く。ここで、<span
                                    class="math inline">\(f^{-1}\)</span>を<span
                                    class="math inline">\(q\)</span>と同一視し、以後は<span
                                    class="math inline">\(q(Q)\)</span>と書く。すると、<span
                                    class="math inline">\(\dot{q}\)</span>は、
                                    <span class="math display">\[
                                    \dot{q} = \frac{dq}{dQ} \dot{Q}
                                    \]</span> と書ける。ここで<span
                                    class="math inline">\(dq/dQ\)</span>は<span
                                    class="math inline">\(Q\)</span>の関数であることから、<span
                                    class="math inline">\(\dot{q}\)</span>は<span
                                    class="math inline">\(Q\)</span>と<span
                                    class="math inline">\(\dot{Q}\)</span>両方の関数である。</p>
                                    <p>以上から、変数変換後のラグランジアンの<span
                                    class="math inline">\(Q\)</span>、<span
                                    class="math inline">\(\dot{Q}\)</span>依存性を明示すると</p>
                                    <p><span class="math display">\[
                                    L(\dot{q}, q) =
                                    L(\dot{q}(\dot{Q},Q), q(Q))
                                    \]</span> となる。</p>
                                    <p>さて、このラグランジアン<span
                                    class="math inline">\(L\)</span>の<span
                                    class="math inline">\(Q\)</span>や<span
                                    class="math inline">\(\dot{Q}\)</span>による偏微分を考えよう。<span
                                    class="math inline">\(Q\)</span>依存性は、<span
                                    class="math inline">\(\dot{q}\)</span>、<span
                                    class="math inline">\(q\)</span>の両方の箇所に入っているから、
                                    <span class="math display">\[
                                    \frac{\partial L}{\partial Q} =
                                    \frac{\partial L}{\partial \dot{q}}
                                    \frac{d\dot{q}}{dQ}
                                    +
                                    \frac{\partial L}{\partial q}
                                    \frac{dq}{dQ}
                                    \]</span></p>
                                    <p>一方、<span
                                    class="math inline">\(\dot{Q}\)</span>は<span
                                    class="math inline">\(\dot{q}\)</span>の場所にしか現れないので、</p>
                                    <p><span class="math display">\[
                                    \frac{\partial L}{\partial
                                    \dot{Q}}  = \frac{\partial
                                    L}{\partial \dot{q}}
                                    \frac{d\dot{q}}{d\dot{Q}}.
                                    \]</span></p>
                                    <p>ここで、合成関数の微分公式から</p>
                                    <p><span class="math display">\[
                                    \frac{d\dot{q}}{d\dot{Q}} =
                                    \frac{dq}{dt}\frac{dt}{dQ} =
                                    \frac{dq}{dQ}.
                                    \]</span></p>
                                    <p>以上より、</p>
                                    <p><span class="math display">\[
                                    \frac{\partial L}{\partial \dot{Q}}
                                    = \frac{\partial L}{\partial
                                    \dot{q}}\frac{dq}{dQ}
                                    \]</span></p>
                                    <p>オイラー・ラグランジュの運動方程式を作るためにこれを時間で微分すると、</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{Q}}\right) =
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{q}}\right)
                                    \frac{dq}{dQ} + \frac{\partial
                                    L}{\partial \dot{q}} \frac{d
                                    \dot{q}}{dQ}
                                    \]</span></p>
                                    <p>以上から、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{Q}}\right) -
                                    \frac{\partial L}{\partial Q}
                                    &amp;=
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{q}}\right)
                                    \frac{dq}{dQ}
                                    + \cancel{\frac{\partial L}{\partial
                                    \dot{q}} \frac{d \dot{q}}{dQ}}\\
                                    &amp;- \frac{\partial L}{\partial q}
                                    \frac{dq}{dQ} -
                                    \cancel{\frac{\partial L}{\partial
                                    \dot{q}} \frac{d\dot{q}}{dQ}} \\
                                    &amp;= \left[
                                    \underbrace{
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{q}}\right) +
                                    \frac{\partial L}{\partial q}
                                    }_{=0}
                                    \right]
                                    \frac{dq}{dQ} \\
                                    &amp;=0
                                    \end{aligned}
                                    \]</span></p>
                                    <p><span
                                    class="math inline">\(q\)</span>を<span
                                    class="math inline">\(Q(q)\)</span>に変数変換した場合、<span
                                    class="math inline">\(q\)</span>がオイラー・ラグランジュの運動方程式に従うのであれば、<span
                                    class="math inline">\(Q\)</span>も全く同じ形の式に従うことが証明された。</p>
                                    <h1
                                    id="多変数の場合">多変数の場合</h1>
                                    <p>これまで、なるべく1自由度系で議論を構築してきた。しかし、ほとんどの場合、我々の興味ある系は複数の自由度を持つ。例えば3次元空間に<span
                                    class="math inline">\(n\)</span>個粒子がいれば、座標を指定するだけで<span
                                    class="math inline">\(3n\)</span>個の変数が必要である。そこで、系の状態が<span
                                    class="math inline">\(N\)</span>個の一般化座標<span
                                    class="math inline">\(q_1, q_2,
                                    \cdots,
                                    q_N\)</span>で指定されていると考えよう。単振り子なら<span
                                    class="math inline">\(N=1\)</span>、二重振り子なら<span
                                    class="math inline">\(N=2\)</span>、3次元<span
                                    class="math inline">\(n\)</span>粒子系なら<span
                                    class="math inline">\(N=3n\)</span>だ。このような多自由度系のラグランジアンの変数変換について扱おう。</p>
                                    <p>この<span
                                    class="math inline">\(N\)</span>自由度系において、ラグランジアン<span
                                    class="math inline">\(L(\dot{q}_1,
                                    \dot{q}_2, \cdots, \dot{q}_N, q_1,
                                    q_2, \cdots,
                                    q_N)\)</span>が与えられており、以下のオイラー・ラグランジュの式が成り立つとしよう。</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left( \frac{\partial
                                    L}{\partial \dot{q}_i}\right) -
                                    \frac{\partial L}{\partial q_i} = 0
                                    \]</span></p>
                                    <p>ただし<span
                                    class="math inline">\(i\)</span>は<span
                                    class="math inline">\(1\)</span>から<span
                                    class="math inline">\(N\)</span>までの値をとり、そのすべてにおいてこの式が成立しているとする。ここで、<span
                                    class="math inline">\((q_1, q_2,
                                    \cdots, q_N)\)</span>から<span
                                    class="math inline">\((Q_1, Q_2,
                                    \cdots,
                                    Q_N)\)</span>への変換を考える。具体的には<span
                                    class="math inline">\(N\)</span>本の関数<span
                                    class="math inline">\(f_i\)</span>を使って、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    Q_1 &amp;= f_1(q_1, q_2, \cdots,
                                    q_N) \\
                                    Q_2 &amp;= f_2(q_1, q_2, \cdots,
                                    q_N) \\
                                    &amp;\cdots \\
                                    Q_N &amp;= f_N(q_1, q_2, \cdots,
                                    q_N)
                                    \end{aligned}
                                    \]</span></p>
                                    <p>と変換が与えられたとする。この時、新しい変数においても</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left( \frac{\partial
                                    L}{\partial \dot{Q}_i}\right) -
                                    \frac{\partial L}{\partial Q_i} = 0
                                    \]</span></p>
                                    <p>が全ての<span
                                    class="math inline">\(i\)</span>で成立することを証明したい。やることは1自由度系とほとんど同様だが、偏微分などがややこしくなる。</p>
                                    <h1
                                    id="記号の節約表記について">記号の節約表記について</h1>
                                    <p>ここで、ラグランジアンを扱う際にどの変数を独立とみなし、どの変数が独立でないのかがよくわからなくなることが多い。これは主に表記において記号の節約を行うことに起因する。例えば、ある関数<span
                                    class="math inline">\(f\)</span>を使って<span
                                    class="math inline">\(Q =
                                    f(q)\)</span>と変換する時、<span
                                    class="math inline">\(Q\)</span>の時間微分は</p>
                                    <p><span class="math display">\[
                                    \frac{dQ}{dt} = \frac{df}{dq}
                                    \frac{dq}{dt}
                                    \]</span></p>
                                    <p>と書ける。これは単なる合成関数の微分公式であるから何も問題はない。しかし、多くの場合<span
                                    class="math inline">\(f\)</span>は<span
                                    class="math inline">\(Q\)</span>と同一視され、</p>
                                    <p><span class="math display">\[
                                    \dot{Q} = \frac{dQ}{dq} \dot{q}
                                    \]</span></p>
                                    <p>と書かれる。さらに、ラグランジアンにおいて<span
                                    class="math inline">\(L(\dot{q},
                                    q)\)</span>とし、<span
                                    class="math inline">\(\dot{q}\)</span>と<span
                                    class="math inline">\(q\)</span>は独立だとみなすが、ラグランジアンを時間積分する際には<span
                                    class="math inline">\(q\)</span>と<span
                                    class="math inline">\(\dot{q}\)</span>には<span
                                    class="math inline">\(\dot{q} =
                                    dq/dt\)</span>の関係がある。これを記号の節約をせずにきちんと書くなら、ラグランジアンを<span
                                    class="math inline">\(L(v,
                                    x)\)</span>と異なる記号で書いておけば独立であることがわかりやすく、これを時間積分する際には積分路が<span
                                    class="math inline">\(s(t)\)</span>で指定されるとして、<span
                                    class="math inline">\(x =
                                    s(t)\)</span>、<span
                                    class="math inline">\(v =
                                    \dot{s}(t)\)</span>と表記することにすれば、<span
                                    class="math inline">\(x\)</span>と<span
                                    class="math inline">\(v\)</span>がどのような関係があるのかがわかりやすい。媒介変数であることがわかりやすいように<span
                                    class="math inline">\(\xi\)</span>や<span
                                    class="math inline">\(\eta\)</span>といった記号を使う流儀もある。しかし、このように表記すると記号が増え、かえって本質が見えづらいと感じる人もいるであろう。大多数の読者は深く考えず、なんとなく「そういうものだ」と納得するであろうし、今はそれで良いと思う。もし将来、真面目に計算して何が独立で何がそうでないか混乱した時に、混乱の原因が変数の節約にあるかもしれないと思い至ればそれで良い。どうせ解析力学をきちんと理解するのは時間がかかる。まずはざっと式変形の地図を頭にイメージできるようにして、あとで「あれ？」と思ったら別の書籍を調べて正確な理解を目指せば良い。</p>
                    </article>
    </body>

    </html>