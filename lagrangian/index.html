<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <meta name="generator" content="pandoc">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
                                <title>ラグランジュ形式の力学</title>

        <style>
            .btn-square {
                display: inline-block;
                padding: 0.5em 0.5em;
                text-decoration: none;
                background: #668ad8;
                color: #FFF;
                border-bottom: solid 4px #626295;
                border-radius: 5px;
            }

            .btn-square:active {
                -webkit-transform: translateY(4px);
                transform: translateY(4px);
                border-bottom: none;
            }

            .markdown-body {
                box-sizing: border-box;
                min-width: 200px;
                max-width: 980px;
                margin: 0 auto;
                padding: 45px;
            }

            @media (max-width: 767px) {
                .markdown-body {
                    padding: 15px;
                }
            }
        </style>

        <meta name="viewport" content="width=device-width, initial-scale=1">

                <script
                src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
                type="text/javascript"></script>
                        <link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
        <link rel="icon" href="https://kaityo256.github.io/classical_mechanics/favicon.ico">
        <link rel="stylesheet" href="https://kaityo256.github.io/classical_mechanics/github-markdown.css"
            type="text/css" />
    </head>

    <body>
        <article class="markdown-body">
                                    <header>
                <h1 class="title">ラグランジュ形式の力学</h1>
                                                            </header>
                                    <p><a href="../index.html">[Up]</a>
                                    <a
                                    href="https://github.com/kaityo256/classical_mechanics">[Repository]</a></p>
                                    <!--- abstract --->
                                    <p>本章では、変数変換に対する運動方程式の変換について学ぶ。解析力学はニュートン力学を再定式化したものであるから、本質的には同じ問題を別の表示に書き換えているに過ぎない。しかし、別の形式で書き直すことで見通しがよくなり、ニュートン力学では見えなかった世界が見えてくる。まずは、ラグランジュ形式の力学が、ニュートン力学よりも広いタイプの変数変換に対して「見通しが良い」ことを見てみよう。
                                    <!--- end ---></p>
                                    <h1 id="極座標の例">極座標の例</h1>
                                    <figure>
                                    <img src="fig/polar_coordinate.png"
                                    alt="極座標における運動方程式" />
                                    <figcaption
                                    aria-hidden="true">極座標における運動方程式</figcaption>
                                    </figure>
                                    <p>極座標における運動を考えよう。以下のような二次元の極座標系を考える。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    x &amp;= r\cos\theta, \\
                                    y &amp;= r\sin \theta.
                                    \end{aligned}
                                    \]</span></p>
                                    <p>この系がポテンシャル<span
                                    class="math inline">\(U(x,y)\)</span>による保存力により運動しているとしよう。ユークリッド座標で記述した運動方程式は、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    m \ddot{x} &amp;= F_x =
                                    -\frac{\partial U}{\partial x}, \\
                                    m \ddot{y} &amp;= F_y =
                                    -\frac{\partial U}{\partial y}.
                                    \end{aligned}
                                    \]</span></p>
                                    <p><span
                                    class="math inline">\(r\)</span>方向の加速度<span
                                    class="math inline">\(a_r\)</span>、<span
                                    class="math inline">\(\theta\)</span>方向の加速度<span
                                    class="math inline">\(a_\theta\)</span>、<span
                                    class="math inline">\(r\)</span>方向の力<span
                                    class="math inline">\(F_r\)</span>、<span
                                    class="math inline">\(\theta\)</span>方向の力<span
                                    class="math inline">\(F_\theta\)</span>を用いると、ニュートンの運動方程式は</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    m a_r &amp;= F_r, \\
                                    m a_\theta &amp;= F_\theta
                                    \end{aligned}
                                    \]</span></p>
                                    <p>となる。この式を<span
                                    class="math inline">\(r,
                                    \theta\)</span>を用いて書き下すのが目的である。図を見るとわかるように、<span
                                    class="math inline">\((dx,dy)\)</span>
                                    の座標系から見て<span
                                    class="math inline">\((dr,
                                    d\theta)\)</span>の座標系は反時計回りに角度<span
                                    class="math inline">\(\theta\)</span>
                                    だけ回転している。したがって、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \begin{pmatrix}
                                    a_r \\ a_\theta
                                    \end{pmatrix}
                                    &amp;=
                                    \begin{pmatrix}
                                    \cos \theta &amp; \sin \theta \\
                                    -\sin \theta &amp; \cos \theta
                                    \end{pmatrix}
                                    \begin{pmatrix}
                                    \ddot{x} \\ \ddot{y}
                                    \end{pmatrix},\\
                                    \begin{pmatrix}
                                    F_r \\ F_\theta
                                    \end{pmatrix}
                                    &amp;=
                                    \begin{pmatrix}
                                    \cos \theta &amp; \sin \theta \\
                                    -\sin \theta &amp; \cos \theta
                                    \end{pmatrix}
                                    \begin{pmatrix}
                                    F_x \\ F_y
                                    \end{pmatrix}
                                    \end{aligned}
                                    \]</span></p>
                                    <p>が成り立つ。</p>
                                    <p>まず、力について考えよう。力の<span
                                    class="math inline">\(r\)</span>方向の向きの成分を考えると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    F_r &amp;= F_x \cos \theta + F_y
                                    \sin \theta \\
                                    &amp;= - \frac{\partial U}{\partial
                                    x} \cos \theta - \frac{\partial
                                    U}{\partial y} \sin \theta.
                                    \end{aligned}
                                    \]</span></p>
                                    <p>ここで、もともと</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    x &amp;= r \cos \theta,\\
                                    y &amp;= r \sin \theta
                                    \end{aligned}
                                    \]</span></p>
                                    <p>であったから、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{\partial x}{\partial r} &amp;=
                                    \cos \theta,\\
                                    \frac{\partial y}{\partial r} &amp;=
                                    \sin \theta
                                    \end{aligned}
                                    \]</span></p>
                                    <p>である。これを用いると</p>
                                    <p><span class="math display">\[
                                    F_r = - \frac{\partial U}{\partial
                                    x}\frac{\partial x}{\partial r} -
                                    \frac{\partial U}{\partial
                                    y}\frac{\partial y}{\partial r}.
                                    \]</span></p>
                                    <p>ここで、<span
                                    class="math inline">\(U(x,y)\)</span>について、合成関数の微分公式から</p>
                                    <p><span class="math display">\[
                                    \frac{\partial U}{\partial r} =
                                    \frac{\partial U}{\partial
                                    x}\frac{\partial x}{\partial r} +
                                    \frac{\partial U}{\partial
                                    y}\frac{\partial y}{\partial r}.
                                    \]</span></p>
                                    <p>以上から、</p>
                                    <p><span class="math display">\[
                                    F_r = -\frac{\partial U}{\partial r}
                                    \]</span></p>
                                    <p>が得られる。</p>
                                    <p>同様に、<span
                                    class="math inline">\(\theta\)</span>方向の力についての成分を考えると</p>
                                    <p><span class="math display">\[
                                    F_\theta = - F_x \sin \theta + F_y
                                    \cos \theta
                                    \]</span></p>
                                    <p>となる。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{\partial x}{\partial \theta}
                                    &amp;= - r\sin \theta, \\
                                    \frac{\partial y}{\partial \theta}
                                    &amp;=  r\cos \theta
                                    \end{aligned}
                                    \]</span></p>
                                    <p>を代入すると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    F_\theta &amp;= -
                                    \frac{1}{r}\frac{\partial
                                    U}{\partial x} \frac{\partial
                                    x}{\partial \theta} -
                                    \frac{1}{r}\frac{\partial
                                    U}{\partial y} \frac{\partial
                                    y}{\partial \theta} \\
                                    &amp;= -\frac{1}{r} \frac{\partial
                                    U}{\partial \theta}.
                                    \end{aligned}
                                    \]</span></p>
                                    <p>これで運動方程式の右辺が求まった。次は左辺である。加速度の成分も力と同様に、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    a_r &amp;= \ddot{x} \cos \theta +
                                    \ddot{y} \sin \theta,\
                                    a_\theta &amp;= -\ddot{x} \sin
                                    \theta + \ddot{y} \cos \theta.
                                    \end{aligned}
                                    \]</span></p>
                                    <p>これを求めるために、極座標の定義を時間微分する。まず一度微分する。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \dot{x} &amp;= \dot{r} \cos \theta -
                                    r \dot{\theta} \sin \theta, \\
                                    \dot{y} &amp;= \dot{r} \sin \theta +
                                    r \dot{\theta} \cos \theta.
                                    \end{aligned}
                                    \]</span></p>
                                    <p>さらにもう一度微分する。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \ddot{x} &amp;= \ddot{r} \cos \theta
                                    - 2\dot{r} \dot{\theta} \sin \theta
                                    - r\ddot{\theta} \sin \theta- r
                                    \dot{\theta}^2 \cos \theta, \\
                                    \ddot{y} &amp;= \ddot{r} \sin \theta
                                    + 2\dot{r} \dot{\theta} \cos \theta
                                    + r\ddot{\theta} \cos \theta- r
                                    \dot{\theta}^2 \sin \theta.
                                    \end{aligned}
                                    \]</span></p>
                                    <p>これで<span
                                    class="math inline">\(a_r\)</span>が計算できる。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    a_r &amp;= \ddot{x} \cos \theta +
                                    \ddot{y} \sin \theta\\
                                    &amp;= \ddot{r} - r \dot{\theta}^2.
                                    \end{aligned}
                                    \]</span></p>
                                    <p>次は<span
                                    class="math inline">\(a_\theta\)</span>を計算しよう。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    a_\theta &amp;= -\ddot{x} \sin
                                    \theta + \ddot{y} \cos \theta \\
                                    &amp;= 2 \dot{r}\dot{\theta} + r
                                    \ddot{\theta} \\
                                    &amp;= \frac{1}{r}(2
                                    r\dot{r}\dot{\theta} + r^2
                                    \ddot{\theta})\\
                                    &amp;=
                                    \frac{1}{r}\frac{d}{dt}(r^2\dot{\theta}).
                                    \end{aligned}
                                    \]</span></p>
                                    <p>以上をまとめると、最終的に<span
                                    class="math inline">\(r,
                                    \theta\)</span>に関する運動方程式</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    m (\ddot{r} - r \dot{\theta}^2)
                                    &amp;= - \frac{\partial U}{\partial
                                    r}, \\
                                    m \frac{d}{dt} \left(r^2
                                    \dot{\theta} \right) &amp;= -
                                    \frac{\partial U}{\partial \theta}
                                    \end{aligned}
                                    \]</span></p>
                                    <p>を得る。非常に面倒であったことがわかるであろう。ただ、<span
                                    class="math inline">\(r,
                                    \theta\)</span>で記述されている運動方程式は、もとの運動方程式を角度<span
                                    class="math inline">\(\theta\)</span>だけ回転させた</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    m a_r &amp;= F_r, \\
                                    m a_\theta &amp;= F_\theta
                                    \end{aligned}
                                    \]</span></p>
                                    <p>であったことは覚えておくと良い。</p>
                                    <p>では、ラグランジアンから導出しよう。運動エネルギーを<span
                                    class="math inline">\(r,
                                    \theta\)</span>で書くと、</p>
                                    <p><span class="math display">\[
                                    K = \frac{1}{2}m(\dot{r}^2 +
                                    r^2\dot{\theta}^2)
                                    \]</span></p>
                                    <p>であるから、極座標のラグランジアンは</p>
                                    <p><span class="math display">\[
                                    L(r, \theta, \dot{r},\dot{\theta}) =
                                    \frac{1}{2}m(\dot{r}^2 +
                                    r^2\dot{\theta}^2) - U(r, \theta).
                                    \]</span></p>
                                    <p>自由度<span
                                    class="math inline">\(r\)</span>に関するオイラー・ラグランジュ方程式は、</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{r}}\right) -
                                    \frac{\partial L}{\partial r} = m
                                    \ddot{r} - mr \dot{\theta}^2 +
                                    \frac{\partial U}{\partial r}
                                    = 0.
                                    \]</span></p>
                                    <p>自由度<span
                                    class="math inline">\(\theta\)</span>に関するオイラー・ラグランジュ方程式は、</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{\theta}}\right) -
                                    \frac{\partial L}{\partial \theta} =
                                    m\frac{d}{dt}(r^2 \dot{\theta}) +
                                    \frac{\partial U}{\partial \theta} =
                                    0.
                                    \]</span></p>
                                    <p>それぞれ整理すると、先程得られた式と全く同じ運動方程式が得られる。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    m (\ddot{r} - r \dot{\theta}^2)
                                    &amp;= - \frac{\partial U}{\partial
                                    r}, \\
                                    m \frac{d}{dt} \left(r^2
                                    \dot{\theta} \right) &amp;= -
                                    \frac{\partial U}{\partial \theta}.
                                    \end{aligned}
                                    \]</span></p>
                                    <p>このように、一度ラグランジアンを書いてしまえば、ラグランジアンだけを変数変換することで、後はオイラー・ラグランジュの方程式を書き下すだけで新しい変数が従う運動方程式が得られる。3次元の極座標や、より一般の変数変換をニュートンの運動方程式で扱うのは極めて面倒だが、ラグランジアンを用いればかなり見通しよく計算ができる。以下では、オイラー・ラグランジュ方程式が任意の座標変換に対して共変であることを証明しよう。</p>
                                    <p>なお、この証明を覚える必要はまったくない。しかし、「証明できる」ということと「証明には数学のツールとして合成関数の偏微分くらいしか使わない」ということをなんとなく知っておくのは大事である。</p>
                                    <h1
                                    id="点変換とラグランジアンの共変性">点変換とラグランジアンの共変性</h1>
                                    <p>これから証明したいことは、一般の変数変換<span
                                    class="math inline">\((q^1, q^2,
                                    \cdots, q^N) \rightarrow (Q^1, Q^2,
                                    \cdots,
                                    Q^N)\)</span>において、元の変数がオイラー・ラグランジュ方程式</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{q}^i} \right) -
                                    \frac{\partial L}{\partial q^i} = 0
                                    \quad (i = 1,2,\cdots, N)
                                    \]</span></p>
                                    <p>に従うならば、新しい変数も</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{Q}^i} \right) -
                                    \frac{\partial L}{\partial Q^i} = 0
                                    \quad (i = 1,2,\cdots, N)
                                    \]</span></p>
                                    <p>に従う、という命題である。このような変換を
                                    <strong>点変換</strong>(point
                                    transformation)
                                    と呼ぶ。オイラー・ラグランジュ方程式は任意の点変換に対して共変である。しかし、この導出はかなり複雑であるため、まずは一自由度系で証明しよう。</p>
                                    <p>ある変数<span
                                    class="math inline">\(q\)</span>について、変数変換<span
                                    class="math inline">\(Q =
                                    f(q)\)</span>を考える。<span
                                    class="math inline">\(q\)</span>がオイラー・ラグランジュの運動方程式</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{q}} \right) -
                                    \frac{\partial L}{\partial q} = 0
                                    \]</span></p>
                                    <p>を満たす時、変数変換後の変数<span
                                    class="math inline">\(Q\)</span>についてもオイラー・ラグランジュの運動方程式</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{Q}} \right) -
                                    \frac{\partial L}{\partial Q} = 0
                                    \]</span></p>
                                    <p>を満たす、というのが証明したいことである。</p>
                                    <p>そのために、まず<span
                                    class="math inline">\(Q =
                                    f(q)\)</span>を<span
                                    class="math inline">\(Q\)</span>について逆に解いて</p>
                                    <p><span class="math display">\[
                                    q = f^{-1}(Q)
                                    \]</span></p>
                                    <p>と書く。ここで、<span
                                    class="math inline">\(f^{-1}\)</span>を<span
                                    class="math inline">\(q\)</span>と同一視し、以後は<span
                                    class="math inline">\(q(Q)\)</span>と書く。すると、<span
                                    class="math inline">\(\dot{q}\)</span>は、</p>
                                    <p><span class="math display">\[
                                    \dot{q} \equiv \frac{d}{dt}q(Q)
                                    =  \frac{dq}{dQ} \dot{Q}
                                    \]</span></p>
                                    <p>と書ける。ここで<span
                                    class="math inline">\(dq/dQ\)</span>は<span
                                    class="math inline">\(Q\)</span>の関数であるから、<span
                                    class="math inline">\(\dot{q}\)</span>は<span
                                    class="math inline">\(Q\)</span>と<span
                                    class="math inline">\(\dot{Q}\)</span>両方の関数である。そこで、<span
                                    class="math inline">\(\dot{q} =
                                    \dot{q}(Q,\dot{Q})\)</span>と表現する。後のために、いくつか関係式を導出しておく。<span
                                    class="math inline">\(\dot{q}\)</span>は<span
                                    class="math inline">\(Q\)</span>及び<span
                                    class="math inline">\(\dot{Q}\)</span>の関数であるから、それらが独立だと思って<span
                                    class="math inline">\(Q\)</span>や<span
                                    class="math inline">\(\dot{Q}\)</span>で偏微分する。まず、<span
                                    class="math inline">\(\dot{q}\)</span>を<span
                                    class="math inline">\(Q\)</span>で偏微分すると、</p>
                                    <p><span class="math display">\[
                                    \frac{\partial \dot{q}}{\partial Q}
                                    = \frac{d^2q}{dQ^2} \dot{Q}.
                                    \]</span></p>
                                    <p>次に、<span
                                    class="math inline">\(\dot{q}\)</span>を<span
                                    class="math inline">\(\dot{Q}\)</span>で偏微分すると、</p>
                                    <p><span class="math display">\[
                                    \frac{\partial \dot{q}}{\partial
                                    \dot{Q}} = \frac{dq}{dQ}.
                                    \]</span></p>
                                    <p>更に時間微分すると、</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    \dot{q}}{\partial \dot{Q}}\right) =
                                    \frac{d^2q}{dQ^2} \dot{Q}.
                                    \]</span></p>
                                    <p>従って、</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    \dot{q}}{\partial \dot{Q}}\right) =
                                    \frac{\partial \dot{q}}{\partial Q}
                                    \]</span></p>
                                    <p>が証明された。さて、ラグランジアンの<span
                                    class="math inline">\(Q,
                                    \dot{Q}\)</span>依存性をあらわに書くと</p>
                                    <p><span class="math display">\[
                                    L(\dot{q}, q) =
                                    L(\dot{q}(\dot{Q},Q), q(Q)).
                                    \]</span></p>
                                    <p>このラグランジアン<span
                                    class="math inline">\(L\)</span>の<span
                                    class="math inline">\(\dot{Q}\)</span>による偏微分を考えよう。<span
                                    class="math inline">\(\dot{Q}\)</span>は<span
                                    class="math inline">\(\dot{q}\)</span>の場所にしか現れないため</p>
                                    <p><span class="math display">\[
                                    \frac{\partial L}{\partial
                                    \dot{Q}}  = \frac{\partial
                                    L}{\partial \dot{q}} \frac{\partial
                                    \dot{q}}{\partial \dot{Q}} =
                                    \frac{\partial L}{\partial
                                    \dot{q}}\frac{dq}{dQ}.
                                    \]</span></p>
                                    <p>ただし、先程導いた関係式 <span
                                    class="math inline">\(\partial
                                    \dot{q}/\partial \dot{Q} =
                                    dq/dQ\)</span>を用いた。<span
                                    class="math inline">\(Q,
                                    \dot{Q}\)</span>に関するオイラー・ラグランジュ方程式を作りたいので、さらに時間で微分すると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{Q}} \right) &amp;=
                                    \frac{d}{dt} \left(\frac{\partial
                                    L}{\partial \dot{q}} \right)
                                    \underbrace{\frac{\partial
                                    \dot{q}}{\partial \dot{Q}}}_{d q/d
                                    Q} + \frac{\partial L}{\partial
                                    \dot{q}}
                                    \underbrace{\frac{d}{dt}\left(\frac{dq}{dQ}\right)}_{\partial
                                    \dot{q}/\partial Q} \\
                                    &amp;=\frac{d}{dt}
                                    \left(\frac{\partial L}{\partial
                                    \dot{q}} \right) \frac{d q}{d Q} +
                                    \frac{\partial L}{\partial \dot{q}}
                                    \frac{\partial \dot{q}}{\partial Q}.
                                    \end{aligned}
                                    \]</span></p>
                                    <p>次にラグランジアンの<span
                                    class="math inline">\(Q\)</span>による偏微分を考える。<span
                                    class="math inline">\(\dot{q},
                                    q\)</span>は両方とも<span
                                    class="math inline">\(Q\)</span>依存性を持つため、</p>
                                    <p><span class="math display">\[
                                    \frac{\partial L}{\partial Q} =
                                    \frac{\partial L}{\partial \dot{q}}
                                    \frac{\partial \dot{q}}{\partial Q}
                                    +
                                    \frac{\partial L}{\partial q}
                                    \frac{dq}{dQ}.
                                    \]</span></p>
                                    <p>以上から、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{Q}}\right) -
                                    \frac{\partial L}{\partial Q}
                                    &amp;=
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{q}}\right)
                                    \frac{dq}{dQ} +
                                    \cancel{\frac{\partial L}{\partial
                                    \dot{q}} \frac{\partial
                                    \dot{q}}{\partial Q}}\\
                                    &amp;- \frac{\partial L}{\partial q}
                                    \frac{dq}{dQ} -
                                    \cancel{\frac{\partial L}{\partial
                                    \dot{q}} \frac{\partial
                                    \dot{q}}{\partial Q}} \\
                                    &amp;= \left[
                                    \underbrace{
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{q}}\right) +
                                    \frac{\partial L}{\partial q}
                                    }_{=0}
                                    \right]
                                    \frac{dq}{dQ} \\
                                    &amp;=0.
                                    \end{aligned}
                                    \]</span></p>
                                    <p><span
                                    class="math inline">\(q\)</span>を<span
                                    class="math inline">\(Q(q)\)</span>に変数変換した場合、<span
                                    class="math inline">\(q\)</span>がオイラー・ラグランジュの運動方程式に従うのであれば、<span
                                    class="math inline">\(Q\)</span>も全く同じ形の式に従うことが証明された。</p>
                                    <p>以上の変換を図解しておこう。</p>
                                    <figure>
                                    <img
                                    src="fig/point_transformation.png"
                                    alt="点変換の流れ" />
                                    <figcaption
                                    aria-hidden="true">点変換の流れ</figcaption>
                                    </figure>
                                    <h1
                                    id="多変数の場合">多変数の場合</h1>
                                    <p>これまで、なるべく1自由度系で議論を構築してきた。しかし、ほとんどの場合、我々の興味ある系は複数の自由度を持つ。例えば3次元空間に<span
                                    class="math inline">\(n\)</span>個粒子がいれば、座標を指定するだけで<span
                                    class="math inline">\(3n\)</span>個の変数が必要である。そこで、系の状態が<span
                                    class="math inline">\(N\)</span>個の一般化座標<span
                                    class="math inline">\(q_1, q_2,
                                    \cdots,
                                    q_N\)</span>で指定されていると考えよう。単振り子なら<span
                                    class="math inline">\(N=1\)</span>、二重振り子なら<span
                                    class="math inline">\(N=2\)</span>、3次元<span
                                    class="math inline">\(n\)</span>粒子系なら<span
                                    class="math inline">\(N=3n\)</span>だ。このような多自由度系のラグランジアンの変数変換について扱おう。</p>
                                    <p>この<span
                                    class="math inline">\(N\)</span>自由度系において、ラグランジアン<span
                                    class="math inline">\(L(q_1, q_2,
                                    \cdots, q_N, \dot{q}_1, \dot{q}_2,
                                    \cdots,
                                    \dot{q}_N)\)</span>が与えられており、以下のオイラー・ラグランジュの式が成り立つとしよう。</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left( \frac{\partial
                                    L}{\partial \dot{q}^i}\right) -
                                    \frac{\partial L}{\partial q^i} = 0.
                                    \]</span></p>
                                    <p>ただし<span
                                    class="math inline">\(i\)</span>は<span
                                    class="math inline">\(1\)</span>から<span
                                    class="math inline">\(N\)</span>までの値をとり、そのすべてにおいてこの式が成立しているとする。ここで、一般的な点変換<span
                                    class="math inline">\((q^1, q^2,
                                    \cdots, q^N) \rightarrow (Q^1, Q^2,
                                    \cdots,
                                    Q^N)\)</span>を考える。具体的には<span
                                    class="math inline">\(N\)</span>本の関数<span
                                    class="math inline">\(f_i\)</span>を使って、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    Q^1 &amp;= Q^1(q^1, q^2, \cdots,
                                    q^N), \\
                                    Q^2 &amp;= Q^2(q^1, q^2, \cdots,
                                    q^N), \\
                                    &amp;\vdots \\
                                    Q^N &amp;= Q^N(q^1, q^2, \cdots,
                                    q^N)
                                    \end{aligned}
                                    \]</span></p>
                                    <p>と変換が与えられたとする(変数と変換の関数を同一視していることに注意)。この時、新しい変数においても</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left( \frac{\partial
                                    L}{\partial \dot{Q}^i}\right) -
                                    \frac{\partial L}{\partial Q^i} = 0
                                    \]</span></p>
                                    <p>が全ての<span
                                    class="math inline">\(i\)</span>で成立する。すなわち、オイラー・ラグランジュ方程式は多自由度系の一般の点変換において共変である。以後、参考のために多自由度系における証明を記載するが、この証明を追う必要はない。証明の流れは一自由度系とほとんど同様だが、偏微分などがややこしくなる。</p>
                                    <p>まず、変数変換<span
                                    class="math inline">\(\{q^i\}
                                    \rightarrow
                                    \{Q^i\}\)</span>を逆に解いて</p>
                                    <p><span class="math display">\[
                                    q^i = q^i(Q^1, Q^2, \cdots, Q^N)
                                    \quad (i = 1,2,\cdots, N)
                                    \]</span></p>
                                    <p>という関係が得られたとしよう。これを時間微分すると、</p>
                                    <p><span class="math display">\[
                                    \dot{q}^i = \frac{\partial
                                    q^i}{\partial Q^k} \dot{Q}^k
                                    \]</span></p>
                                    <p>となる。ここで、アインシュタイン記法を使っており、実際には<span
                                    class="math inline">\(k\)</span>について和を取っている。これを<span
                                    class="math inline">\(\dot{Q}^k\)</span>で偏微分すると、和のうち<span
                                    class="math inline">\(k\)</span>のインデックスに関するものだけが残るため、</p>
                                    <p><span class="math display">\[
                                    \frac{\partial \dot{q}^i}{\partial
                                    \dot{Q}^k} = \frac{\partial
                                    q^i}{\partial Q^k}
                                    \]</span></p>
                                    <p>を得る。これをさらに時間微分すると、</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    \dot{q}^i}{\partial
                                    \dot{Q}^k}\right) = \frac{\partial^2
                                    q^i}{\partial Q^k \partial Q^j}
                                    \dot{Q}^j
                                    \]</span></p>
                                    <p>となる。ここで、また<span
                                    class="math inline">\(\dot{q}^i\)</span>の表式に戻る。ただし、後の都合のために和を<span
                                    class="math inline">\(j\)</span>で取っておく。</p>
                                    <p><span class="math display">\[
                                    \dot{q}^i = \frac{\partial
                                    q^i}{\partial Q^j} \dot{Q}^j.
                                    \]</span></p>
                                    <p>これを<span
                                    class="math inline">\(Q^k\)</span>で偏微分すると、</p>
                                    <p><span class="math display">\[
                                    \frac{\partial \dot{q}^i}{\partial
                                    Q^k} = \frac{\partial^2
                                    \dot{q}^i}{\partial Q^j\partial Q^k}
                                    \dot{Q}^j.
                                    \]</span></p>
                                    <p>先程得た式と比べることで、</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    \dot{q}^i}{\partial
                                    \dot{Q}^k}\right) = \frac{\partial
                                    \dot{q}^i}{\partial Q^k}
                                    \]</span></p>
                                    <p>を得た。さて、ラグランジアンを新しい変数で偏微分していこう。適宜、途中で得た関係式を代入している。</p>
                                    <p><span class="math display">\[
                                    \frac{\partial L}{\partial
                                    \dot{Q}^k} = \frac{\partial
                                    L}{\partial \dot{q}^i}\frac{\partial
                                    \dot{q}^i}{\partial \dot{Q}^k}.
                                    \]</span></p>
                                    <p>さらにこれを時間微分すると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{d}{dt} \left(\frac{\partial
                                    L}{\partial \dot{Q}^k}\right) &amp;=
                                    \frac{d}{dt} \left(\frac{\partial
                                    L}{\partial \dot{q}^i}\right)
                                    \frac{\partial \dot{q}^i}{\partial
                                    \dot{Q}^k} + \frac{\partial
                                    L}{\partial \dot{q}^i} \frac{d}{dt}
                                    \left( \frac{\partial
                                    \dot{q}^i}{\partial \dot{Q}^k}
                                    \right) \\
                                    &amp;= \frac{d}{dt}
                                    \left(\frac{\partial L}{\partial
                                    \dot{q}^i}\right)  \frac{\partial
                                    q^i}{\partial Q^k} + \frac{\partial
                                    L}{\partial \dot{q}^i}
                                    \frac{\partial \dot{q}^i}{\partial
                                    Q^k}.
                                    \end{aligned}
                                    \]</span></p>
                                    <p>一方、<span
                                    class="math inline">\(L\)</span>を<span
                                    class="math inline">\(Q^k\)</span>で偏微分すると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{\partial L}{\partial Q^k}
                                    &amp;= \frac{\partial L}{\partial
                                    q^i}\frac{\partial q^i}{\partial
                                    Q^k} + \frac{\partial L}{\partial
                                    \dot{q}^i}\frac{\partial
                                    \dot{q}^i}{\partial Q^k}.
                                    \end{aligned}
                                    \]</span></p>
                                    <p>先程求めた式との差を取ると、</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt} \left(\frac{\partial
                                    L}{\partial \dot{Q}^k}\right) +
                                    \frac{\partial L}{\partial Q^k} =
                                    \underbrace{\left(\frac{d}{dt}
                                    \left(\frac{\partial L}{\partial
                                    \dot{q}^i}\right)  - \frac{\partial
                                    L}{\partial \dot{q}^i}\right)}_{=0}
                                    \frac{\partial q^i}{\partial Q^k}.
                                    \]</span></p>
                                    <p>以上から、元の変数でオイラー・ラグランジュ方程式が成り立つと、新しい変数でもオイラー・ラグランジュ方程式が成り立つ、すなわち、オイラー・ラグランジュ方程式が任意の点変換において共変であることが示された。繰り返しになるが、この証明を追う必要はない。しかし「面倒ではあるが、基本的な微分の公式だけで証明できる」ということは頭に入れておいて欲しい。</p>
                                    <h1
                                    id="電磁場中の粒子の運動">電磁場中の粒子の運動</h1>
                                    <p>電磁場中を荷電粒子が運動すると、電磁場からの力を受ける。いま、電荷<span
                                    class="math inline">\(q\)</span>の粒子が、電場<span
                                    class="math inline">\(\mathbf{E}\)</span>、磁束密度<span
                                    class="math inline">\(\mathbf{B}\)</span>の中を速度<span
                                    class="math inline">\(\mathbf{v}\)</span>で運動すると、</p>
                                    <p><span class="math display">\[
                                    \mathbf{F} = q(\mathbf{E} +
                                    \mathbf{v}\times\mathbf{B})
                                    \]</span></p>
                                    <p>の力を受ける。この力に対応するポテンシャルが</p>
                                    <p><span class="math display">\[
                                    U = q \left( \phi - \dot{\mathbf{r}}
                                    \cdot \mathbf{A} \right)
                                    \]</span></p>
                                    <p>と書けることを、ラグランジアンから導出しよう。</p>
                                    <p>まず、電場<span
                                    class="math inline">\(\mathbf{E}\)</span>のみを考える。スカラーポテンシャル<span
                                    class="math inline">\(\phi(x,y,z)\)</span>を用いて</p>
                                    <p><span class="math display">\[
                                    \mathbf{E} = - \nabla \phi
                                    \]</span></p>
                                    <p>と書けているとしよう。ポテンシャルエネルギーを</p>
                                    <p><span class="math display">\[
                                    U = q \phi
                                    \]</span></p>
                                    <p>で定義すると、この系のラグランジアンは</p>
                                    <p><span class="math display">\[
                                    L =
                                    \frac{1}{2}m(\dot{x}^2+\dot{y}^2+\dot{z}^2)
                                    - q \phi(x,y,z)
                                    \]</span></p>
                                    <p>となる。<span
                                    class="math inline">\(x\)</span>成分についてオイラー・ラグランジュ方程式を作ってみよう。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{x}} \right) -
                                    \frac{\partial L}{\partial x}
                                    &amp;= m\ddot{x} +q \frac{\partial
                                    \phi}{\partial x} \\
                                    &amp;= 0.
                                    \end{aligned}
                                    \]</span></p>
                                    <p><span class="math inline">\(y,
                                    z\)</span>成分も同様であるから、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    m\ddot{x} &amp;= -q \frac{\partial
                                    \phi}{\partial x}, \\
                                    m\ddot{y} &amp;= -q \frac{\partial
                                    \phi}{\partial y}, \\
                                    m\ddot{z} &amp;= -q \frac{\partial
                                    \phi}{\partial z}.
                                    \end{aligned}
                                    \]</span></p>
                                    <p>したがって、位置ベクトル</p>
                                    <p><span class="math display">\[
                                    \mathbf{r} =
                                    \begin{pmatrix}
                                    x \\ y \\z
                                    \end{pmatrix}
                                    \]</span></p>
                                    <p>を用いると、</p>
                                    <p><span class="math display">\[
                                    m \ddot{\mathbf{r}} =  - q \nabla
                                    \phi = q \mathbf{E}
                                    \]</span></p>
                                    <p>となる。これは、これまでニュートン力学で扱ってきたポテンシャルそのままである。</p>
                                    <p>次に、磁束密度<span
                                    class="math inline">\(\mathrm{B}\)</span>のみがある中での運動を考える。磁束密度が時間非依存のベクトルポテンシャル<span
                                    class="math inline">\(\mathbf{A}\)</span>を用いて</p>
                                    <p><span class="math display">\[
                                    \mathrm{B} = \nabla \times
                                    \mathrm{A}
                                    \]</span></p>
                                    <p>と書けているとしよう。後のために成分を書き下しておく。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    B_x &amp;= \frac{\partial
                                    A_z}{\partial y} - \frac{\partial
                                    A_y}{\partial z},\\
                                    B_y &amp;= \frac{\partial
                                    A_x}{\partial z} - \frac{\partial
                                    A_z}{\partial x},\\
                                    B_z &amp;= \frac{\partial
                                    A_y}{\partial x} - \frac{\partial
                                    A_x}{\partial y}.
                                    \end{aligned}
                                    \]</span></p>
                                    <p>この時、ポテンシャルエネルギーを</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    U &amp;= - q \dot{\mathbf{r}}  \cdot
                                    \mathbf{A}\\
                                    &amp;= -q
                                    (\dot{x}A_x  +  \dot{y}A_y  +
                                    \dot{z}A_z)
                                    \end{aligned}
                                    \]</span></p>
                                    <p>で定義する。今度はポテンシャルに速度成分が含まれるため、計算がややこしくなる。この系のラグランジアンは</p>
                                    <p><span class="math display">\[
                                    L(\mathbf{r}, \dot{\mathbf{r}}) =
                                    \frac{1}{2}m(\dot{x}^2+\dot{y}^2+\dot{z}^2)
                                    + q (\dot{x}A_x  +  \dot{y}A_y  +
                                    \dot{z}A_z).
                                    \]</span></p>
                                    <p>まず、両辺を<span
                                    class="math inline">\(\dot{x}\)</span>で偏微分する。</p>
                                    <p><span class="math display">\[
                                    \frac{\partial L}{\partial \dot{x}}
                                    = m\dot{x} + q A_x.
                                    \]</span></p>
                                    <p><span
                                    class="math inline">\(A_x(x,y,z)\)</span>であり、<span
                                    class="math inline">\((x,y,z)\)</span>が時間依存することに注意して、さらに時間微分すると、</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{x}} \right)
                                    = m \ddot{x} + q \left(\dot{x}
                                    \frac{\partial A_x}{\partial x} +
                                    \dot{y} \frac{\partial A_x}{\partial
                                    y} + \dot{z} \frac{\partial
                                    A_x}{\partial z}\right).
                                    \]</span></p>
                                    <p>次に、ラグランジアンを<span
                                    class="math inline">\(x\)</span>で偏微分すると、</p>
                                    <p><span class="math display">\[
                                    \frac{\partial L}{\partial x} = q
                                    \left(\dot{x}\frac{\partial
                                    A_x}{\partial x}+
                                    \dot{y}\frac{\partial A_y}{\partial
                                    x}+\dot{z}\frac{\partial
                                    A_z}{\partial x}\right).
                                    \]</span></p>
                                    <p>辺々引くと、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{x}} \right) -
                                    \frac{\partial L}{\partial x} &amp;=
                                    m\ddot{x} - q \left\{\dot{y}
                                    \underbrace{\left(\frac{\partial
                                    A_y}{\partial x} - \frac{\partial
                                    A_x}{\partial y} \right)}_{B_z} -
                                    \dot{z}
                                    \underbrace{\left(\frac{\partial
                                    A_x}{\partial z} - \frac{\partial
                                    A_z}{\partial x}
                                    \right)}_{B_y}\right\} \\
                                    &amp;= m\ddot{x} - q (\dot{y}B_z -
                                    \dot{z}B_y)\\
                                    &amp;= 0.
                                    \end{aligned}
                                    \]</span></p>
                                    <p>したがって、</p>
                                    <p><span class="math display">\[
                                    m \ddot{x} = q (\dot{y} B_z -
                                    \dot{z} B_y). \\
                                    \]</span></p>
                                    <p>他の成分も同様に求めることができるので、結果として以下の運動方程式を得る。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    m \ddot{x} &amp;= q (\dot{y} B_z -
                                    \dot{z} B_y) \\
                                    m \ddot{y} &amp;= q (\dot{z} B_x -
                                    \dot{x} B_z) \\
                                    m \ddot{z} &amp;= q (\dot{x} B_y -
                                    \dot{y} B_x)
                                    \end{aligned}
                                    \]</span></p>
                                    <p>ベクトル表記すると、</p>
                                    <p><span class="math display">\[
                                    m \ddot{\mathbf{r}} = q
                                    \dot{\mathbf{r}} \times \mathbf{B}.
                                    \]</span></p>
                                    <p>以上から、電磁場中を荷電粒子が運動する際、その荷電粒子が感じるポテンシャルエネルギーは</p>
                                    <p><span class="math display">\[
                                    U(\mathrm{r}, \dot{\mathrm{r}}) = q
                                    (\phi - \dot{\mathbf{r}}\cdot
                                    \mathbf{A})
                                    \]</span></p>
                                    <p>であることがわかった。このポテンシャルエネルギーはスカラー関数とベクトル関数を含んでいるため、それぞれスカラーポテンシャル、ベクトルポテンシャルと呼ぶ。</p>
                                    <p>電磁気学でベクトルポテンシャルをならった時に「スカラーポテンシャルを考える理由はまだわかるが、ベクトルポテンシャルというものをなぜ考えなければならないのだろう？」と疑問に思ったことはないだろうか？上記の議論がその答えの一部を与えている。</p>
                                    <p>スカラーポテンシャルのように、ポテンシャル関数が位置のみに依存する場合は、単にその勾配が力を与えていた。しかし、速度にも依存する場合は、オイラー・ラグランジュ方程式から、すなわち変分原理から計算しないと力を求めることができない。逆にいえば、速度に依存するポテンシャルを考えれば、変分原理から磁場による力も表現できるということである。変分原理の考え方に基づけば、「なぜ磁場中を運動する荷電粒子は、磁場と直交する向きに力を受けるのか」という問に対して「あるベクトルポテンシャルと速度の内積でポテンシャルエネルギーが与えられている時、それを含めたラグランジアンを最小化するように運動を決めるとそうなるから」と答えることができる。このように、まずスカラーポテンシャルやベクトルポテンシャルを用いてラグランジアンを定義し、変分原理により運動方程式を導出すると、その運動方程式に電場や磁束密度による力が現れる、という流れを見ると、電場や磁束密度よりもスカラーポテンシャルやベクトルポテンシャルの方が「より根源的な量」である気がしてくるであろう。もちろんそれは「そんな気がしてくる」というだけであって、変分原理は「我々が適切なラグランジアンを見つけると、適切な運動方程式を生み出す」という以上の意味はないが、何が本質であるかに思いを馳せること自体は、解析力学の学習に有用であろうと思う。</p>
                                    <h1
                                    id="記号の節約表記について">記号の節約表記について</h1>
                                    <p>ラグランジアンを扱う際、どの変数を独立とみなし、どの変数が独立でないのかがよくわからなくなることが多い。これは主に表記において記号の節約を行うことに起因する。例えば、ある関数<span
                                    class="math inline">\(f\)</span>を使って<span
                                    class="math inline">\(Q =
                                    f(q)\)</span>と変換する時、<span
                                    class="math inline">\(Q\)</span>の時間微分は</p>
                                    <p><span class="math display">\[
                                    \frac{dQ}{dt} = \frac{df}{dq}
                                    \frac{dq}{dt}
                                    \]</span></p>
                                    <p>と書ける。これは単なる合成関数の微分公式であるから何も問題はない。しかし、多くの場合<span
                                    class="math inline">\(f\)</span>は<span
                                    class="math inline">\(Q\)</span>と同一視され、</p>
                                    <p><span class="math display">\[
                                    \dot{Q} = \frac{dQ}{dq} \dot{q}
                                    \]</span></p>
                                    <p>と書かれる。さらに、ラグランジアンにおいて<span
                                    class="math inline">\(L(q,\dot{q})\)</span>とし、<span
                                    class="math inline">\(q\)</span>と<span
                                    class="math inline">\(\dot{q}\)</span>は独立だとみなすが、ラグランジアンを時間積分する際には、<span
                                    class="math inline">\(q\)</span>と<span
                                    class="math inline">\(\dot{q}\)</span>には<span
                                    class="math inline">\(\dot{q} =
                                    dq/dt\)</span>の関係がある。これを記号の節約をせずにきちんと書くなら、ラグランジアンを<span
                                    class="math inline">\(L(x,
                                    v)\)</span>と異なる記号で書いておけば独立であることがわかりやすい。これを時間積分する際には積分路が<span
                                    class="math inline">\(s(t)\)</span>で指定されるとして、<span
                                    class="math inline">\(x =
                                    s(t)\)</span>、<span
                                    class="math inline">\(v =
                                    \dot{s}(t)\)</span>と媒介変数表示をすれば、<span
                                    class="math inline">\(x\)</span>と<span
                                    class="math inline">\(v\)</span>がどのような関係があるのかがわかりやすい。媒介変数であることがわかりやすいように<span
                                    class="math inline">\(\xi\)</span>や<span
                                    class="math inline">\(\eta\)</span>といった記号を使う流儀もある。しかし筆者は、このように表記すると記号が増え、かえって本質が見えづらくなると感じる。大多数の読者は深く考えず、なんとなく「そういうものだ」と納得するであろうし、今はそれで良いと思う。もし将来、真面目に計算して何が独立で何がそうでないか混乱した時に、混乱の原因が変数の節約にあるかもしれないと思い至ればそれで良い。どうせ解析力学をきちんと理解するのは時間がかかる。まずはざっと式変形の地図を頭にイメージできるようにして、あとで「あれ？」と思ったら別の書籍を調べて正確な理解を目指せば良い。</p>
                                    <h1 id="まとめ">まとめ</h1>
                                    <p>ニュートンの運動方程式がガリレイ変換という限られた座標変換でのみ共変であったのに対して、オイラー・ラグランジュ方程式は、任意の非線形変換を含む点変換に対して共変であることが証明された。点変換の典型例は極座標表示である。二次元でもかなり面倒であるのだが、三次元の極座標が従う運動方程式を、ニュートン力学から導出するのは極めて面倒である。ラグランジアンを使ってもまだ面倒であるが、それでもかなり労力を減らすことができる。これは、単に計算が楽になるというだけでなく、系に内在する性質を見やすくするという、運動の本質をえぐり出すことにも繋がる。ここでは、座標を任意に混ぜる変換を考えた。次は運動量と座標も混ぜるような変換にたいして共変であるような運動方程式の表式が欲しくなる。それがハミルトンの運動方程式である。</p>
                    </article>
    </body>

    </html>