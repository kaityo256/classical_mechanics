<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <meta name="generator" content="pandoc">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
                                <title>微分形式</title>

        <style>
            .btn-square {
                display: inline-block;
                padding: 0.5em 0.5em;
                text-decoration: none;
                background: #668ad8;
                color: #FFF;
                border-bottom: solid 4px #626295;
                border-radius: 5px;
            }

            .btn-square:active {
                -webkit-transform: translateY(4px);
                transform: translateY(4px);
                border-bottom: none;
            }

            .markdown-body {
                box-sizing: border-box;
                min-width: 200px;
                max-width: 980px;
                margin: 0 auto;
                padding: 45px;
            }

            @media (max-width: 767px) {
                .markdown-body {
                    padding: 15px;
                }
            }
        </style>

        <meta name="viewport" content="width=device-width, initial-scale=1">

                <script
                src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
                type="text/javascript"></script>
                        <link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
        <link rel="icon" href="https://kaityo256.github.io/classical_mechanics/favicon.ico">
        <link rel="stylesheet" href="https://kaityo256.github.io/classical_mechanics/github-markdown.css"
            type="text/css" />
    </head>

    <body>
        <article class="markdown-body">
                                    <header>
                <h1 class="title">微分形式</h1>
                                                            </header>
                                    <p><a href="../index.html">[Up]</a>
                                    <a
                                    href="https://github.com/kaityo256/classical_mechanics">[Repository]</a></p>
                                    <h1
                                    id="全微分とベクトル">全微分とベクトル</h1>
                                    <p>座標変換において、基底と同じ変換を受けるベクトルを共変ベクトル、逆向きの変換を受けるベクトルを反変ベクトルと呼ぶのであった。具体的には、ある基底<span
                                    class="math inline">\(\{\mathbf{e}_i\}\)</span>から<span
                                    class="math inline">\(\{\tilde{\mathbf{e}}_i\}\)</span>への変換が</p>
                                    <p><span class="math display">\[
                                    \tilde{\mathbf{e}}_i = A_i^j
                                    \mathbf{e}_j
                                    \]</span></p>
                                    <p>で与えられている時、このベクトルで展開されたベクトルの成分</p>
                                    <p><span class="math display">\[
                                    \mathbf{u} = u^i \mathbf{e}_i =
                                    \tilde{u}^i \tilde{\mathbf{e}}_i
                                    \]</span></p>
                                    <p>には、</p>
                                    <p><span class="math display">\[
                                    u^i = A_j^i \tilde{u}^j
                                    \]</span></p>
                                    <p>の関係があり、これは基底の変換と逆向きの変換であるので、反変ベクトルとなる。また、</p>
                                    <p><span class="math display">\[
                                    (\mathbf{e}^i, \mathbf{e}_j) =
                                    (\tilde{\mathbf{e}}^i,
                                    \tilde{\mathbf{e}}_j) = \delta^i_j
                                    \]</span></p>
                                    <p>の関係を満たす双対ベクトル<span
                                    class="math inline">\(\{\mathbf{e}^i\},
                                    \{\tilde{\mathbf{e}}^i\}\)</span>の間には</p>
                                    <p><span class="math display">\[
                                    \mathbf{e}^i = A^i_j
                                    \tilde{\mathbf{e}}^j
                                    \]</span></p>
                                    <p>という関係があるため、やはり反変ベクトルであった。</p>
                                    <p>さて、<span
                                    class="math inline">\((x,y)\)</span>空間における物理量<span
                                    class="math inline">\(u(x,y)\)</span>の全微分を考えよう。</p>
                                    <p><span class="math display">\[
                                    du = \frac{\partial u}{\partial x}
                                    dx + \frac{\partial u}{\partial y}
                                    dy
                                    \]</span></p>
                                    <p>これは、あたかも<span
                                    class="math inline">\(du\)</span>というベクトルを、<span
                                    class="math inline">\(dx,
                                    dy\)</span>という基底で展開しているように見える。そこで、以下の極座標表示を例に、基底の変換則を見てみよう。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    x &amp;= r \cos \theta \\
                                    y &amp;= r \sin \theta
                                    \end{aligned}
                                    \]</span></p>
                                    <p>まずは具体的な<span
                                    class="math inline">\(r,
                                    \theta\)</span>依存性を忘れ、<span
                                    class="math inline">\(x(r, \theta),
                                    y(r,\theta)\)</span>として一般論を考える。
                                    それぞれ全微分すると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    dx &amp;= \frac{\partial x}{\partial
                                    r} dr + \frac{\partial x}{\partial
                                    \theta} d\theta\\
                                    dy &amp;= \frac{\partial y}{\partial
                                    r}dr + \frac{\partial y}{\partial
                                    \theta} d\theta
                                    \end{aligned}
                                    \]</span></p>
                                    <p>これを行列で書けば</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \begin{pmatrix}
                                    dx \\ dy
                                    \end{pmatrix} &amp;=
                                    \underbrace{
                                    \begin{pmatrix}
                                    \displaystyle \frac{\partial
                                    x}{\partial r} &amp; \displaystyle
                                    \frac{\partial x}{\partial
                                    \theta}  \\
                                    \displaystyle \frac{\partial
                                    x}{\partial y} &amp; \displaystyle
                                    \frac{\partial y}{\partial \theta}
                                    \end{pmatrix}}_A
                                    \begin{pmatrix}
                                    dr \\ d\theta
                                    \end{pmatrix}
                                    \\
                                    &amp;= A
                                    \begin{pmatrix}
                                    dr \\ d\theta
                                    \end{pmatrix}
                                    \end{aligned}
                                    \]</span></p>
                                    <p>これは、ヤコビ行列<span
                                    class="math inline">\(A\)</span>を用いた<span
                                    class="math inline">\(\{dr,
                                    d\theta\}\)</span>という基底から<span
                                    class="math inline">\(\{dx,
                                    dy\}\)</span>という基底への変換則のように見える。つまり、<span
                                    class="math inline">\(dr =
                                    \mathbf{e}_1, d\theta =
                                    \mathbf{e}_2, dx =
                                    \tilde{\mathbf{e}_1}, dy =
                                    \tilde{\mathbf{e}_2}\)</span>として、</p>
                                    <p><span class="math display">\[
                                    \tilde{\mathbf{e}}_i = A_i^j
                                    \mathbf{e}_j
                                    \]</span></p>
                                    <p>という変換が与えられたと解釈できる。</p>
                                    <p>この基底変換において、<span
                                    class="math inline">\(u(x,y) = u(r,
                                    \theta)\)</span>の全微分を調べて見よう。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    du &amp;= \frac{\partial u}{\partial
                                    x}dx +\frac{\partial u}{\partial
                                    y}dy \\
                                    &amp;=\frac{\partial u}{\partial
                                    r}dr +\frac{\partial u}{\partial
                                    \theta}d\theta
                                    \end{aligned}
                                    \]</span></p>
                                    <p>これは、</p>
                                    <p><span class="math display">\[
                                    \mathbf{u} = u^i \mathbf{e}_i =
                                    \tilde{u}^i \tilde{\mathbf{e}}_i
                                    \]</span></p>
                                    <p>という表式に対応する。</p>
                                    <p>ここで、各成分について、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{\partial u}{\partial r} &amp;=
                                    \frac{\partial u}{\partial
                                    x}\frac{\partial x}{\partial r} +
                                    \frac{\partial u}{\partial
                                    y}\frac{\partial y}{\partial r} \\
                                    \frac{\partial u}{\partial \theta}
                                    &amp;= \frac{\partial u}{\partial
                                    x}\frac{\partial x}{\partial \theta}
                                    + \frac{\partial u}{\partial
                                    y}\frac{\partial y}{\partial \theta}
                                    \end{aligned}
                                    \]</span></p>
                                    <p>が成り立つので、これを行列形式で書くと、</p>
                                    <p><span class="math display">\[
                                    \begin{pmatrix}
                                    \partial_r u \\ \partial_\theta u
                                    \end{pmatrix} =
                                    \begin{pmatrix}
                                    \displaystyle \frac{\partial
                                    x}{\partial r} &amp; \displaystyle
                                    \frac{\partial x}{\partial
                                    \theta}  \\
                                    \displaystyle \frac{\partial
                                    x}{\partial y} &amp; \displaystyle
                                    \frac{\partial y}{\partial \theta}
                                    \end{pmatrix}
                                    \begin{pmatrix}
                                    \partial_x u \\ \partial_y u
                                    \end{pmatrix}
                                    \]</span></p>
                                    <p>これは、<span
                                    class="math inline">\(dr,
                                    d\theta\)</span>から<span
                                    class="math inline">\(dx,
                                    dy\)</span>への座標変換と逆の変換を受けているため、<span
                                    class="math inline">\(u\)</span>の全微分の係数<span
                                    class="math inline">\(\partial_x u,
                                    \partial_y
                                    u\)</span>などは反変ベクトルであることがわかる。</p>
                                    <p>これは、<span
                                    class="math inline">\(u\)</span>を除くと</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \begin{pmatrix}
                                    \partial_r \\ \partial_\theta
                                    \end{pmatrix} &amp;=
                                    \begin{pmatrix}
                                    \displaystyle \frac{\partial
                                    x}{\partial r} &amp; \displaystyle
                                    \frac{\partial x}{\partial
                                    \theta}  \\
                                    \displaystyle \frac{\partial
                                    x}{\partial y} &amp; \displaystyle
                                    \frac{\partial y}{\partial \theta}
                                    \end{pmatrix}
                                    \begin{pmatrix}
                                    \partial_x\\ \partial_y
                                    \end{pmatrix}\\
                                    &amp;= A
                                    \begin{pmatrix}
                                    \partial_x\\ \partial_y
                                    \end{pmatrix}
                                    \end{aligned}
                                    \]</span></p>
                                    <p>となるため、<span
                                    class="math inline">\(dx,
                                    dy\)</span> と <span
                                    class="math inline">\(\partial_x,
                                    \partial_y\)</span> 、<span
                                    class="math inline">\(dr,
                                    d\theta\)</span> と <span
                                    class="math inline">\(\partial_r,
                                    \partial_\theta\)</span>
                                    が互いに双対ベクトルの関係にあり、変換も逆向きであること、すなわち、
                                    <span
                                    class="math inline">\(\partial_r =
                                    \mathbf{e}^1, \partial_\theta =
                                    \mathbf{e}^2, \partial_x =
                                    \tilde{\mathbf{e}}^1, \partial_y =
                                    \tilde{\mathbf{e}}^2\)</span>
                                    として、</p>
                                    <p><span class="math display">\[
                                    \mathbf{e}^i = A^i_j
                                    \tilde{\mathbf{e}}^j
                                    \]</span></p>
                                    <p>が成り立っていることがわかる。</p>
                                    <p>これを利用すると、例えば<span
                                    class="math inline">\(\partial_x
                                    \theta\)</span>や<span
                                    class="math inline">\(\partial_y
                                    \theta\)</span>などが簡単に計算できる。</p>
                                    <p>普通に計算しようとすると、<span
                                    class="math inline">\(\partial_x
                                    \theta\)</span>の計算は面倒だ。まずは具体的な</p>
                                    <p><span class="math display">\[
                                    \tan \theta = \frac{y}{x}
                                    \]</span></p>
                                    <p>として<span
                                    class="math inline">\(r\)</span>を消去し、両辺を<span
                                    class="math inline">\(x\)</span>で偏微分すると</p>
                                    <p><span class="math display">\[
                                    \frac{1}{\cos^2 \theta}
                                    \frac{\partial \theta}{\partial x} =
                                    -\frac{y}{x^2}
                                    \]</span></p>
                                    <p>ここで、<span
                                    class="math inline">\(\cos \theta =
                                    x/r\)</span>であることから以下のように求めることができる。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{\partial \theta}{\partial x}
                                    &amp;=  - \frac{x^2}{r^2}
                                    \frac{y}{x^2}\\
                                    &amp;= \frac{-y}{x^2+y^2} \\
                                    &amp;= -\frac{\sin \theta}{r}
                                    \end{aligned}
                                    \]</span></p>
                                    <p><span
                                    class="math inline">\(\partial_y
                                    \theta\)</span>も同様に求めなくてはならない。</p>
                                    <p>一方、 <span
                                    class="math inline">\(\partial_r
                                    x\)</span> や <span
                                    class="math inline">\(\partial_\theta
                                    x\)</span>
                                    などの計算が簡単であることから、以下のように行列形式で書く。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \begin{pmatrix}
                                    dx \\ dy
                                    \end{pmatrix} &amp;=
                                    \begin{pmatrix}
                                    \partial_r x &amp; \partial_\theta
                                    x  \\
                                    \partial_r y &amp; \partial_\theta y
                                    \end{pmatrix}
                                    \begin{pmatrix}
                                    dr \\ d\theta
                                    \end{pmatrix} \\
                                    &amp;=
                                    \underbrace{
                                    \begin{pmatrix}
                                    \cos \theta &amp; -r \sin \theta \\
                                    \sin \theta &amp; r \cos \theta
                                    \end{pmatrix}}_A
                                    \begin{pmatrix}
                                    dr \\ d\theta
                                    \end{pmatrix}\\
                                    &amp;=
                                    A
                                    \begin{pmatrix}
                                    dr \\ d\theta
                                    \end{pmatrix}
                                    \end{aligned}
                                    \]</span></p>
                                    <p>両辺に<span
                                    class="math inline">\(A\)</span>の逆行列をかけると</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \begin{pmatrix}
                                    dr \\ d\theta
                                    \end{pmatrix}
                                    &amp;= A^{-1}
                                    \begin{pmatrix}
                                    dx \\ dy
                                    \end{pmatrix}\\
                                    &amp;= \frac{1}{r}
                                    \begin{pmatrix}
                                    r \cos \theta &amp;  r \sin \theta
                                    \\
                                    -\sin \theta &amp;  \cos \theta
                                    \end{pmatrix}
                                    \begin{pmatrix}
                                    dx \\ dy
                                    \end{pmatrix}
                                    \end{aligned}
                                    \]</span></p>
                                    <p>これと、</p>
                                    <p><span class="math display">\[
                                    \begin{pmatrix}
                                    dr \\ d\theta
                                    \end{pmatrix} =
                                    \begin{pmatrix}
                                    \displaystyle \frac{\partial
                                    r}{\partial x} &amp; \displaystyle
                                    \frac{\partial r}{\partial y} \\
                                    \displaystyle \frac{\partial
                                    \theta}{\partial x} &amp;
                                    \displaystyle \frac{\partial
                                    \theta}{\partial y}
                                    \end{pmatrix}
                                    \begin{pmatrix}
                                    dx \\ dy
                                    \end{pmatrix}
                                    \]</span></p>
                                    <p>を見比べれば、</p>
                                    <p><span class="math display">\[
                                    \frac{\partial \theta}{\partial x} =
                                    -\frac{\sin
                                    \theta}{r},\frac{\partial
                                    \theta}{\partial y} = \frac{\cos
                                    \theta}{r}
                                    \]</span></p>
                                    <p>と求めることができる。多変数、例えば3次元の極座標などでは計算が煩雑になるが、それでもヤコビ行列を使えば発見法的に計算する必要がなく、系統的に計算ができるようになる。</p>
                                    <h1
                                    id="外積と外微分">外積と外微分</h1>
                                    <p>全微分による<span
                                    class="math inline">\(dx, dy,
                                    dz\)</span>がベクトルの基底のように見え、その双対基底が<span
                                    class="math inline">\(\partial_x,
                                    \partial_y,
                                    \partial_z\)</span>であることを見た。このルールをもう少しきちんと論じるため、微分形式を導入しよう。</p>
                                    <p>任意の次元の空間で議論できるが、わかりやすさのために3次元空間<span
                                    class="math inline">\((x,y,z)\)</span>で考えよう。この空間に定義されたスカラー関数<span
                                    class="math inline">\(f(x,y,z)\)</span>を考える。この関数の全微分を以下のように定義する。</p>
                                    <p><span class="math display">\[
                                    df \equiv \frac{\partial f}{\partial
                                    x}dx + \frac{\partial f}{\partial
                                    y}dy + \frac{\partial f}{\partial
                                    z}dz
                                    \]</span></p>
                                    <p>先ほど見たように、これは<span
                                    class="math inline">\(dx, dy,
                                    dz\)</span>を基底としたベクトルとみなすことができる。スカラー関数を全微分したものを1次微分形式、もしくは単純に
                                    <strong>1形式(1-form)</strong>
                                    と呼ぶ。また、微分する前のスカラー関数を
                                    <strong>0形式(0-form)</strong>
                                    と呼ぶ。</p>
                                    <p>ここで、外積記号<span
                                    class="math inline">\(\wedge\)</span>により、以下の性質を持つ外積を定義する。</p>
                                    <ul>
                                    <li>同じ基底の外積はゼロ</li>
                                    <li>外積の両辺を入れ替えると負符号がつく</li>
                                    </ul>
                                    <p>すなわち、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    dx \wedge dx &amp;= 0 \\
                                    dx \wedge dy &amp;= - dy \wedge dx
                                    \end{aligned}
                                    \]</span></p>
                                    <p>である(他の基底も同様)。この外積記号を用いて、任意の<span
                                    class="math inline">\(1\)</span>形式の間の外積を考えよう。
                                    以下のように2つの1形式が与えられたとする。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    du &amp;= u_x dx + u_y dy + u_z dz\\
                                    dv &amp;= v_x dx + v_y dy + v_z dz
                                    \end{aligned}
                                    \]</span></p>
                                    <p>この2つの<span
                                    class="math inline">\(1\)</span>形式の外積は、先程の外積の性質を用いると以下のように計算できる。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    du \wedge dv &amp;= (u_x dx + u_y dy
                                    + u_z dz) \wedge (v_x dx + v_y dy +
                                    v_z dz) \\
                                    &amp;=
                                    (u_x v_y  - u_y v_x ) dx \wedge dy
                                    +(u_y v_z  - u_z v_y ) dy \wedge dz
                                    +(u_z v_x  - u_x v_z ) dz \wedge dx
                                    \end{aligned}
                                    \]</span></p>
                                    <p>さて、外積を用いて外微分を定義しよう。いま、<span
                                    class="math inline">\(1\)</span>形式が</p>
                                    <p><span class="math display">\[
                                    \omega_1 = f_x dx +  f_y dy +  f_z
                                    dz
                                    \]</span></p>
                                    <p>と書かれている時、この外微分を</p>
                                    <p><span class="math display">\[
                                    d \omega_1 = df_x \wedge dx + df_y
                                    \wedge dy + df_z \wedge dz
                                    \]</span></p>
                                    <p>と定義する。</p>
                                    <p><span
                                    class="math inline">\(f_x\)</span>はスカラー関数、すなわち<span
                                    class="math inline">\(0\)</span>形式であり、一般に<span
                                    class="math inline">\(x,y,z\)</span>の関数であるから、その外微分は</p>
                                    <p><span class="math display">\[
                                    df_x = \frac{\partial f_x}{\partial
                                    x} dx + \frac{\partial f_y}{\partial
                                    y} dy + \frac{\partial f_z}{\partial
                                    z} dz
                                    \]</span></p>
                                    <p>で与えられる。<span
                                    class="math inline">\(f_y,
                                    f_z\)</span>も同様である。したがって、</p>
                                    <p><span class="math display">\[
                                    d\omega_1 =
                                    \left(\frac{\partial f_x}{\partial
                                    y} - \frac{\partial f_y}{\partial
                                    x}\right) dx \wedge dy +
                                    (\frac{\partial f_y}{\partial z} -
                                    \frac{\partial f_z}{\partial y}) dy
                                    \wedge dz + (\frac{\partial
                                    f_z}{\partial x} - \frac{\partial
                                    f_x}{\partial x}) dz \wedge dx
                                    \]</span></p>
                                    <p>となる。<span
                                    class="math inline">\(dx\wedge
                                    dy\)</span>など、<span
                                    class="math inline">\(1\)</span>形式の外積で作られた新たな基底で表現されたものを<span
                                    class="math inline">\(2\)</span>形式と呼ぶ。すなわち<span
                                    class="math inline">\(1\)</span>形式を外微分することで<span
                                    class="math inline">\(2\)</span>形式を作ることができた。同様にして、<span
                                    class="math inline">\(p\)</span>形式を外微分することで<span
                                    class="math inline">\(p+1\)</span>形式を作ることができる。</p>
                                    <p><span
                                    class="math inline">\(1\)</span>形式の基底<span
                                    class="math inline">\(dx\)</span>に対しては、偏微分演算子<span
                                    class="math inline">\(\partial_x\)</span>が双対基底となり、以下のような自然な内積を考えることができる。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \left&lt;dx,
                                    \frac{\partial}{\partial x}
                                    \right&gt; &amp;= \frac{\partial
                                    x}{\partial x} = 1\\
                                    \left&lt;dy,
                                    \frac{\partial}{\partial x}
                                    \right&gt; &amp;= \frac{\partial
                                    y}{\partial x} = 0\\
                                    \end{aligned}
                                    \]</span></p>
                                    <p>すなわち、対応する双対基底と内積をとったら1、そうでなければ0となるため、<span
                                    class="math inline">\(dx, dy,
                                    dz\)</span>と、<span
                                    class="math inline">\(\partial_x,
                                    \partial_y,
                                    \partial_z\)</span>は正規直交基底をなす。</p>
                                    <p>2形式との内積については、一番左のものと内積をとると約束する。すなわち、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \left&lt;dx \wedge dy,
                                    \frac{\partial}{\partial x}
                                    \right&gt; &amp; \equiv
                                    \left&lt;dx,
                                    \frac{\partial}{\partial x}
                                    \right&gt; dy \\
                                    &amp;=1
                                    \end{aligned}
                                    \]</span></p>
                                    <p>対応する双対ベクトルが一番左になかった場合は、入れ替えることで一番左に持ってくる。その際、入れ替えた回数だけ負符号がつく。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \left&lt;dy \wedge dx,
                                    \frac{\partial}{\partial x}
                                    \right&gt; &amp; = \left&lt;dx
                                    \wedge dy, \frac{\partial}{\partial
                                    x} \right&gt; \\
                                    &amp;= -\left&lt;dx,
                                    \frac{\partial}{\partial x}
                                    \right&gt; dy \\
                                    &amp;=1
                                    \end{aligned}
                                    \]</span></p>
                                    <p>この全微分と外積のルールは、多変数間の変換のヤコビアンを一般化したものになっている。簡単な例を挙げよう。</p>
                                    <p>二次元の極座標表示を考える。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    x &amp;= r \cos \theta \\
                                    y &amp;= r \sin \theta
                                    \end{aligned}
                                    \]</span></p>
                                    <p><span class="math inline">\(x,
                                    y\)</span>を<span
                                    class="math inline">\(r,
                                    \theta\)</span>の関数だと思って、それぞれ全微分してみよう。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    dx &amp;= \cos \theta dr - r\sin
                                    \theta d\theta\\
                                    dy &amp;= \sin \theta dr + r\cos
                                    \theta d\theta
                                    \end{aligned}
                                    \]</span></p>
                                    <p>定義に従って<span
                                    class="math inline">\(dx \wedge
                                    dy\)</span>を計算する。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    dx \wedge dy &amp;= (\cos \theta dr
                                    - r\sin \theta d\theta) (\sin \theta
                                    dr + r\cos \theta d\theta) \\
                                    &amp;= r \cos^2 \theta dr \wedge
                                    d\theta - r \sin^2 \theta d\theta
                                    \wedge dr \\
                                    &amp;= r dr \wedge d\theta
                                    \end{aligned}
                                    \]</span></p>
                                    <p>途中で<span
                                    class="math inline">\(dr \wedge dr =
                                    d\theta\wedge d\theta
                                    =0\)</span>及び<span
                                    class="math inline">\(d\theta \wedge
                                    dr = - dr \wedge
                                    d\theta\)</span>を用いた。これが、積分におけるヤコビアン</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    dx dy &amp;= \frac{\partial
                                    (x,y)}{\partial (r, \theta)} dr
                                    d\theta\\
                                    &amp;= r dr d\theta
                                    \end{aligned}
                                    \]</span></p>
                                    <p>に対応することがわかる。</p>
                                    <h1
                                    id="微分形式とベクトル解析">微分形式とベクトル解析</h1>
                                    <p>微分形式は、ベクトル解析で習った<span
                                    class="math inline">\(\mathrm{grad}\)</span>や<span
                                    class="math inline">\(\mathrm{div}\)</span>、<span
                                    class="math inline">\(\mathrm{rot}\)</span>などを一般化する概念となっている。</p>
                                    <p>例えば3次元空間におけるスカラー場<span
                                    class="math inline">\(f\)</span>の外微分は</p>
                                    <p><span class="math display">\[
                                    df = \frac{\partial f}{\partial x}dx
                                    + \frac{\partial f}{\partial y}dy +
                                    \frac{\partial f}{\partial z}dz
                                    \]</span></p>
                                    <p>であるが、<span
                                    class="math inline">\(dx, dy,
                                    dz\)</span>を、<span
                                    class="math inline">\(\mathbf{e}_x,
                                    \mathbf{e}_y,
                                    \mathbf{e}_z\)</span>とみなせば</p>
                                    <p><span class="math display">\[
                                    df =
                                    \begin{pmatrix}
                                    \partial_x f \\
                                    \partial_y f \\
                                    \partial_z f
                                    \end{pmatrix}
                                    = \mathrm{grad} f
                                    \]</span></p>
                                    <p>すなわち、これは勾配を表している。また、1形式<span
                                    class="math inline">\(\omega_1\)</span>が</p>
                                    <p><span class="math display">\[
                                    \omega_1 = B_x dx + B_y dx + B_z dz
                                    \]</span></p>
                                    <p>で与えられている時、</p>
                                    <p><span class="math display">\[
                                    d\omega_1 =  dB_x \wedge dx + B_y
                                    \wedge dx + B_z \wedge dz
                                    \]</span></p>
                                    <p>となる。ここで</p>
                                    <p><span class="math display">\[
                                    dB_x = \frac{\partial B_x}{\partial
                                    x} dx +\frac{\partial B_x}{\partial
                                    y} dy +\frac{\partial B_x}{\partial
                                    z} dz
                                    \]</span></p>
                                    <p>であるから、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    dB_x \wedge dx &amp;=
                                    \left(\frac{\partial B_x}{\partial
                                    x} dx +\frac{\partial B_x}{\partial
                                    y} dy +\frac{\partial B_x}{\partial
                                    z} dz \right) \wedge dx \\
                                    &amp;= \frac{\partial B_x}{\partial
                                    y} dy \wedge dx + \frac{\partial
                                    B_x}{\partial z} dz \wedge dx \\
                                    &amp;= - \frac{\partial
                                    B_x}{\partial y} dx \wedge dy +
                                    \frac{\partial B_x}{\partial z} dz
                                    \wedge dx
                                    \end{aligned}
                                    \]</span></p>
                                    <p>ただし、<span
                                    class="math inline">\(dx \wedge dx =
                                    0\)</span>、<span
                                    class="math inline">\(dy \wedge dx =
                                    - dx \wedge
                                    dy\)</span>を用いた。他の成分も同様に計算すると、</p>
                                    <p><span class="math display">\[
                                    dB = \left(\frac{\partial
                                    B_z}{\partial y} - \frac{\partial
                                    B_y}{\partial z} \right) dy \wedge
                                    dz + \left(\frac{\partial
                                    B_x}{\partial z} - \frac{\partial
                                    B_z}{\partial x} \right) dz \wedge
                                    dx + \left(\frac{\partial
                                    B_y}{\partial x} - \frac{\partial
                                    B_x}{\partial y} \right) dx \wedge
                                    dy
                                    \]</span></p>
                                    <p>ここで、以下の性質を満たすホッジ作用素<span
                                    class="math inline">\(\ast\)</span>を定義する。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \ast dx &amp;= dy \wedge dz \\
                                    \ast dy &amp;= dz \wedge dx \\
                                    \ast dz &amp;= dx \wedge dy
                                    \end{aligned}
                                    \]</span></p>
                                    <p>ホッジ作用素は、微分形式を裏返す演算子になっており、<span
                                    class="math inline">\(d\)</span>次元空間における<span
                                    class="math inline">\(p\)</span>形式を、<span
                                    class="math inline">\(d-p\)</span>形式に対応させる。これは双対変換であり、もう一度作用させると元に戻る。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \ast (dy \wedge dz) &amp;= dx \\
                                    \ast (dz \wedge dx) &amp;= dy \\
                                    \ast (dx \wedge dy) &amp;= dz
                                    \end{aligned}
                                    \]</span></p>
                                    <p>また、ベクトルが張る次元と等しい微分形式(<span
                                    class="math inline">\(p=d\)</span>の場合)に作用させるとスカラーとなる。</p>
                                    <p><span class="math display">\[
                                    \ast (dx \wedge dy \wedge dz) = 1
                                    \]</span></p>
                                    <p>ホッジ作用素を用いると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \ast (d\omega_1) &amp;=
                                    \left(\frac{\partial B_z}{\partial
                                    y} - \frac{\partial B_y}{\partial z}
                                    \right) dx + \left(\frac{\partial
                                    B_x}{\partial z} - \frac{\partial
                                    B_z}{\partial x} \right) dy +
                                    \left(\frac{\partial B_y}{\partial
                                    x} - \frac{\partial B_x}{\partial y}
                                    \right) dz \end{aligned}
                                    \]</span></p>
                                    <p>これはベクトル場</p>
                                    <p><span class="math display">\[
                                    \mathbf{B} =
                                    \begin{pmatrix}
                                    B_x \\ B_y \\ B_z
                                    \end{pmatrix}
                                    \]</span></p>
                                    <p>に対する回転<span
                                    class="math inline">\(\mathrm{rot}
                                    \mathbf{B}\)</span>に対応する。</p>
                                    <p>また、以下の2形式を定義する。</p>
                                    <p><span class="math display">\[
                                    \omega_2 = E_x dy \wedge dz + E_y dz
                                    \wedge dx + E_z dx \wedge dy
                                    \]</span></p>
                                    <p>この外微分を計算すると、</p>
                                    <p><span class="math display">\[
                                    d \omega_2 = \left(\frac{\partial
                                    E_x}{\partial x} + \frac{\partial
                                    E_y}{\partial y} +  \frac{\partial
                                    E_z}{\partial z} \right) dx \wedge
                                    dy \wedge dz
                                    \]</span></p>
                                    <p>さらにホッジ作用素を作用させると、</p>
                                    <p><span class="math display">\[
                                    \ast (d \omega_2) =
                                    \left(\frac{\partial E_x}{\partial
                                    x} + \frac{\partial E_y}{\partial y}
                                    +  \frac{\partial E_z}{\partial z}
                                    \right)
                                    \]</span></p>
                                    <p>これは、ベクトル場</p>
                                    <p><span class="math display">\[
                                    \mathbf{E} =
                                    \begin{pmatrix}
                                    E_x \\ E_y \\ E_z
                                    \end{pmatrix}
                                    \]</span></p>
                                    <p>に対する発散<span
                                    class="math inline">\(\mathrm{div}
                                    \mathbf{E}\)</span>に対応する。</p>
                                    <p>微分形式の定義から、任意の微分形式<span
                                    class="math inline">\(\omega\)</span>について</p>
                                    <p><span class="math display">\[
                                    d(d\omega) = 0
                                    \]</span></p>
                                    <p>が成り立つ。一般に証明するのは煩雑なので、<span
                                    class="math inline">\(\omega\)</span>が<span
                                    class="math inline">\(0\)</span>形式、すなわちスカラー場<span
                                    class="math inline">\(f\)</span>である場合を見ておこう。座標を<span
                                    class="math inline">\(x,y,z\)</span>で書くと煩雑なので、<span
                                    class="math inline">\(\{q^i\}\)</span>で記述すると、</p>
                                    <p><span class="math display">\[
                                    df = \frac{\partial f}{\partial
                                    q^i}dq^i
                                    \]</span></p>
                                    <p>であるから、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    d(df) &amp;= \sum_i d
                                    \left(\frac{\partial f}{\partial
                                    q^i}dq^i \right) \\
                                    &amp;= \sum_i\left(\frac{\partial^2
                                    f}{\partial q^i \partial q^j}
                                    dq^j\right) \wedge dq^i\\
                                    &amp;= \sum_i\frac{\partial^2
                                    f}{\partial q^i \partial q^j} dq^j
                                    \wedge dq^i \\
                                    &amp;= \sum_{i&lt;j}
                                    \left(\frac{\partial^2 f}{\partial
                                    q^i \partial q^j} - \frac{\partial^2
                                    f}{\partial q^j \partial q^i}
                                    \right) dq^j \wedge dq^i \\
                                    &amp;=0
                                    \end{aligned}
                                    \]</span></p>
                                    <p>これは、よく知られた以下の公式を一般化したものになっている。</p>
                                    <p><span class="math display">\[
                                    \mathrm{rot} (\mathrm{grad} f) = 0
                                    \]</span></p>
                                    <p>また、<span
                                    class="math inline">\(\omega\)</span>として<span
                                    class="math inline">\(1\)</span>形式を採用した場合は</p>
                                    <p><span class="math display">\[
                                    \mathrm{div} (\mathrm{rot}
                                    \mathbf{v}) = 0
                                    \]</span></p>
                                    <p>に対応する。</p>
                                    <h1
                                    id="微分形式による正準方程式の表式">微分形式による正準方程式の表式</h1>
                                    <p>前置きが長かったが、これでようやく解析力学を微分形式で表現する準備が整った。まず、正準変換の条件を微分形式で表現しよう。今、変数<span
                                    class="math inline">\((q,p)\)</span>から<span
                                    class="math inline">\((Q,P)\)</span>に変数変換をしたとする。この時、<span
                                    class="math inline">\(2\)</span>形式<span
                                    class="math inline">\(dP \wedge
                                    dQ\)</span>を考える。<span
                                    class="math inline">\(Q\)</span>、<span
                                    class="math inline">\(P\)</span>は<span
                                    class="math inline">\((q,p)\)</span>の関数であるから、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    dQ &amp;= \frac{\partial Q}{\partial
                                    q}dq + \frac{\partial Q}{\partial
                                    p}dp\\
                                    dP &amp;= \frac{\partial P}{\partial
                                    q}dq + \frac{\partial P}{\partial
                                    p}dp
                                    \end{aligned}
                                    \]</span></p>
                                    <p><span class="math inline">\(dP
                                    \wedge
                                    dQ\)</span>に代入して計算すると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    dP \wedge dQ &amp;=
                                    \left(\frac{\partial P}{\partial
                                    q}dq + \frac{\partial P}{\partial
                                    p}dp \right)
                                    \left(\frac{\partial Q}{\partial
                                    q}dq + \frac{\partial Q}{\partial
                                    p}dp\right) \\
                                    &amp;= \left(\frac{\partial
                                    P}{\partial p}\frac{\partial
                                    Q}{\partial q} - \frac{\partial
                                    P}{\partial q}\frac{\partial
                                    Q}{\partial p} \right) dp\wedge dq
                                    \end{aligned}
                                    \]</span></p>
                                    <p>すなわち、<span
                                    class="math inline">\((q,p)\)</span>から<span
                                    class="math inline">\((Q,P)\)</span>への変換のヤコビアンが現れる。正準変換の条件はヤコビアンが1であることであったから、</p>
                                    <p><span class="math display">\[
                                    dP \wedge dQ = dp \wedge dq
                                    \]</span></p>
                                    <p>が成り立つことが正準変換の条件となる。このように、正準共役な変数同士を結んだ2形式を
                                    <strong>正準2形式(canonical
                                    2-form)</strong> と呼び、一般に<span
                                    class="math inline">\(\omega\)</span>で表すことが多い。</p>
                                    <p><span class="math display">\[
                                    \omega = dp \wedge dq = dP \wedge dQ
                                    \]</span></p>
                                    <p>すなわち、正準2形式は正準変換で不変である。</p>
                                    <p>正準2形式を使うと、正準方程式を内積の形で書くことができる。正準方程式のリュービル演算子を考えよう。リュービル演算子とは、任意の物理量の時間微分を与える演算子であった。</p>
                                    <p><span class="math display">\[
                                    \frac{dA}{dt} = i\mathcal{L}A
                                    \]</span></p>
                                    <p>虚数単位は負符号については今はあまり気にしなくて良い。<span
                                    class="math inline">\(A\)</span>が<span
                                    class="math inline">\((q,p)\)</span>の関数であり、<span
                                    class="math inline">\((q,p)\)</span>が時間の関数であるなら</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{dA}{dt} &amp;= \frac{\partial
                                    A}{\partial q} \dot{q} +
                                    \frac{\partial A}{\partial p}
                                    \dot{p}\\
                                    &amp;=
                                    \underbrace{\left(\dot{q}\frac{\partial
                                    }{\partial q} + \dot{q}
                                    \frac{\partial}{\partial
                                    p}\right)}_{i\mathcal{L}}A
                                    \end{aligned}
                                    \]</span></p>
                                    <p>したがって、</p>
                                    <p><span class="math display">\[
                                    i\mathcal{L} = \dot{q}
                                    \frac{\partial}{\partial q} +
                                    \dot{p} \frac{\partial}{\partial p}
                                    \]</span></p>
                                    <p>であることがわかる。このリュービル演算子と正準2形式の内積を取る。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \left&lt;\omega,
                                    i\mathcal{L}  \right&gt;  &amp;=
                                    \left&lt;dp\wedge dq, \dot{q}
                                    \frac{\partial}{\partial q} +
                                    \dot{p} \frac{\partial}{\partial p}
                                    \right&gt; \\
                                    &amp;= \dot{p}dq - \dot{q}dp
                                    \end{aligned}
                                    \]</span></p>
                                    <p>ハミルトニアン<span
                                    class="math inline">\(H(q,p)\)</span>の全微分は</p>
                                    <p><span class="math display">\[
                                    dH = \frac{\partial H}{\partial q}dq
                                    + \frac{\partial H}{\partial p}dp
                                    \]</span></p>
                                    <p>であるから、</p>
                                    <p><span class="math display">\[
                                    \left&lt;\omega, i\mathcal{L}
                                    \right&gt; = -dH
                                    \]</span></p>
                                    <p>が、正準方程式を与える。</p>
                                    <p>多自由度の場合も同様であり、正準2形式</p>
                                    <p><span class="math display">\[
                                    \omega = dp_i \wedge dq^i
                                    \]</span></p>
                                    <p>と、リュービル演算子</p>
                                    <p><span class="math display">\[
                                    i\mathcal{L} =
                                    \dot{q}^i\frac{\partial}{\partial
                                    q^i}+\dot{p}_i\frac{\partial}{\partial
                                    p_i}
                                    \]</span></p>
                                    <p>を用いて</p>
                                    <p><span class="math display">\[
                                    \left&lt;\omega,
                                    i\mathcal{L}\right&gt; = -dH
                                    \]</span></p>
                                    <p>が正準方程式を与える。</p>
                                    <p>ここで、リュービル演算子がポアソン括弧を使って、</p>
                                    <p><span class="math display">\[
                                    \frac{dA}{dt} \equiv i\mathcal{L}A =
                                    \{A, H\}
                                    \]</span></p>
                                    <p>と書けていたことを思い出そう。ポアソン括弧は局所座標に依らない表現であったから、リュービル演算子も局所座標に依らない。さらに、正準2形式は正準変換で不変であるから、局所基底の取り方に依らない正準方程式の表式が得られたことになる。</p>
                                    <h1 id="まとめ">まとめ</h1>
                                    <p>ニュートンの運動方程式から始まり、局所座標に依らない正準方程式までたどり着いた。ここまでの長い旅路を振り返って置こう。</p>
                                    <p>我々は、力と加速度が比例する、というニュートンの運動方程式からスタートした。</p>
                                    <p><span class="math display">\[
                                    F = ma
                                    \]</span></p>
                                    <p>ここで、<span
                                    class="math inline">\(F\)</span>がポテンシャル力であり、<span
                                    class="math inline">\(F(x) =
                                    -U&#39;(x)\)</span>と書けるならば、</p>
                                    <p><span class="math display">\[
                                    m \ddot{x} = -U&#39;(x)
                                    \]</span></p>
                                    <p>と書ける。ここで、<span
                                    class="math inline">\(x\)</span>の代わりに一般化座標<span
                                    class="math inline">\(q\)</span>と、一般化速度<span
                                    class="math inline">\(\dot{q}\)</span>を用いて、ラグランジアン</p>
                                    <p><span class="math display">\[
                                    L(q, \dot{q}) = K(\dot{q}) - U(q)
                                    \]</span></p>
                                    <p>を定義すると、オイラー・ラグランジュの運動方程式</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{q}} \right) -
                                    \frac{\partial L}{\partial q} = 0
                                    \]</span></p>
                                    <p>を得る。ここで、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    p &amp;= \frac{\partial L}{\partial
                                    \dot{q}} \\
                                    H &amp;= p \dot{q} - L
                                    \end{aligned}
                                    \]</span></p>
                                    <p>というルジャンドル変換により、自由変数を一般化速度<span
                                    class="math inline">\(\dot{q}\)</span>から一般化運動量<span
                                    class="math inline">\(p\)</span>に取り直すと、オイラー・ラグランジュの運動方程式は、以下の正準方程式に書き換わる。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \dot{q} &amp;= \frac{\partial
                                    H}{\partial p}\\
                                    \dot{q} &amp;= -\frac{\partial
                                    H}{\partial q}
                                    \end{aligned}
                                    \]</span></p>
                                    <p><span
                                    class="math inline">\((q,p)\)</span>で表現された物理量<span
                                    class="math inline">\(A\)</span>の時間微分は</p>
                                    <p><span class="math display">\[
                                    \dot{A} = \frac{\partial A}{\partial
                                    q} \frac{\partial H}{\partial p} -
                                    \frac{\partial A}{\partial p}
                                    \frac{\partial H}{\partial q}
                                    \]</span></p>
                                    <p>と書けるため、リュービル演算子を</p>
                                    <p><span class="math display">\[
                                    \dot{A} \equiv i \mathcal{L} A
                                    \]</span></p>
                                    <p>と定義すると、</p>
                                    <p><span class="math display">\[
                                    i \mathcal{L} = \frac{\partial
                                    H}{\partial
                                    p}\frac{\partial}{\partial q}
                                    -\frac{\partial H}{\partial
                                    q}\frac{\partial}{\partial p}
                                    \]</span></p>
                                    <p>となるため、リュービル演算子の正準2形式<span
                                    class="math inline">\(\omega = dp
                                    \wedge
                                    dq\)</span>との内積は、ハミルトニアンの全微分を用いて</p>
                                    <p><span class="math display">\[
                                    \left&lt;\omega, i\mathcal{L}
                                    \right&gt; = -dH
                                    \]</span></p>
                                    <p>という、局所座標に依らない運動方程式が得られた。</p>
                                    <p>2つの式を並べて見ても、とても同じ現象を表現しているようには見えない。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    m \ddot{x} &amp;= -U&#39;(x) \\
                                    \left&lt;\omega, i\mathcal{L}
                                    \right&gt; &amp;= -dH
                                    \end{aligned}
                                    \]</span></p>
                                    <p>しかし、ずっと等式変形をしてきたのだから、これは紛れもなく等価な式である。これは当式変形であるから、式の予言能力は変わらない。しかし、これまで見てきたように、「同じものが異なるように見える」「異なるものが同じように見える」という新たな視点を与えることが学問の真髄である。</p>
                                    <p>解析力学を学んだことが、読者の世界を広げたなら幸いである。</p>
                    </article>
    </body>

    </html>