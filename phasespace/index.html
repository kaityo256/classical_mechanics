<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <meta name="generator" content="pandoc">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
                                <title>位相空間とリュービルの定理</title>

        <style>
            .btn-square {
                display: inline-block;
                padding: 0.5em 0.5em;
                text-decoration: none;
                background: #668ad8;
                color: #FFF;
                border-bottom: solid 4px #626295;
                border-radius: 5px;
            }

            .btn-square:active {
                -webkit-transform: translateY(4px);
                transform: translateY(4px);
                border-bottom: none;
            }

            .markdown-body {
                box-sizing: border-box;
                min-width: 200px;
                max-width: 980px;
                margin: 0 auto;
                padding: 45px;
            }

            @media (max-width: 767px) {
                .markdown-body {
                    padding: 15px;
                }
            }
        </style>

        <meta name="viewport" content="width=device-width, initial-scale=1">

                <script
                src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
                type="text/javascript"></script>
                        <link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
        <link rel="icon" href="https://kaityo256.github.io/classical_mechanics/favicon.ico">
        <link rel="stylesheet" href="https://kaityo256.github.io/classical_mechanics/github-markdown.css"
            type="text/css" />
    </head>

    <body>
        <article class="markdown-body">
                                    <header>
                <h1 class="title">位相空間とリュービルの定理</h1>
                                                            </header>
                                    <p><a href="../index.html">[Up]</a>
                                    <a
                                    href="https://github.com/kaityo256/classical_mechanics">[Repository]</a></p>
                                    <h1 id="本章の目的">本章の目的</h1>
                                    <p>本章では位相空間を扱う。位相空間を考えることで、これまでの「物体の運動を追いかける」というラグランジュ的な描像から、「運動全体を流れ場として考える」というオイラー的描像に移り変わる。また、勾配や発散といったベクトル解析の言葉で運動が表現されるのも面白いところである。さらに、正準方程式に支配される運動が生み出す流れ場が非圧縮であるというリュービルの定理を導く。</p>
                                    <h1 id="位相空間">位相空間</h1>
                                    <p>質量<span
                                    class="math inline">\(m\)</span>、ばね定数<span
                                    class="math inline">\(k\)</span>の一次元調和振動子の運動を考えよう。ニュートンの運動方程式は</p>
                                    <p><span class="math display">\[
                                    m\ddot{q} = -kq
                                    \]</span></p>
                                    <p>となる。ここで、</p>
                                    <p><span class="math display">\[
                                    \sqrt{\frac{k}{m}} t \rightarrow t
                                    \]</span></p>
                                    <p>として時間を無次元化すると、運動方程式は</p>
                                    <p><span class="math display">\[
                                    \ddot{q} = -q
                                    \]</span></p>
                                    <p>となる。対応するラグランジアンは</p>
                                    <p><span class="math display">\[
                                    L(q,\dot{q}) = \frac{1}{2}\dot{q}^2
                                    - \frac{1}{2}q^2
                                    \]</span></p>
                                    <p>となる。</p>
                                    <p><span class="math display">\[
                                    p = \frac{\partial L}{\partial
                                    \dot{q}}
                                    \]</span></p>
                                    <p>による運動量を定義し、</p>
                                    <p><span class="math display">\[
                                    H = p\dot{q} - L
                                    \]</span></p>
                                    <p>とルジャンドル変換することで、以下のハミルトニアンを得る。</p>
                                    <p><span class="math display">\[
                                    H(q,p) = \frac{1}{2}p^2 +
                                    \frac{1}{2}q^2
                                    \]</span></p>
                                    <p>このハミルトニアンの正準方程式は以下のようになる。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \dot{q} &amp;= p \\
                                    \dot{p} &amp;= - q
                                    \end{aligned}
                                    \]</span></p>
                                    <p>これは二変数の一階微分方程式であるから、この運動は初期条件として<span
                                    class="math inline">\((q,p)\)</span>の2つの変数を与えると、それ以後の運動が全て決まる。運動方程式を解くとは、<span
                                    class="math inline">\((q(t),
                                    p(t))\)</span>の時間発展を決めることだ。そこから<span
                                    class="math inline">\(t\)</span>を消去すると、<span
                                    class="math inline">\((q,p)\)</span>空間の曲線となる。これを運動の軌道と呼ぶ。自由度が1の系では、二次元空間を用意すれば過不足なく運動の軌道を記述できる。自由度が<span
                                    class="math inline">\(N\)</span>の系であれば<span
                                    class="math inline">\(2N\)</span>次元の空間が必要である。例えば、3次元空間で<span
                                    class="math inline">\(N\)</span>個の質点が相互作用しているような系は<span
                                    class="math inline">\(6N\)</span>次元の空間が必要となる。運動を過不足無く記述できるような空間を
                                    <strong>位相空間(phase
                                    space)</strong>
                                    と呼ぶ。一次元の調和振動子であれば、<span
                                    class="math inline">\((q,p)\)</span>で表現される二次元空間が位相空間である。なお、物理で使う位相空間は、数学で使う位相空間(topological
                                    space)とは異なる概念なので注意。</p>
                                    <p>ここで、系の自由度と配位空間、位相空間の関係についてまとめておこう。系の自由度とは、系の配位を一意に決めることができる変数の数である。何かの系を写真に撮った、その写真の状態を説明することを考えよう。たとえば調和振動子なら、釣り合いの位置からどれだけ離れているか、振り子なら鉛直方向からの角度のみを指定すれば、写真の状態を指定できる。このように、系を写真に撮った状態を配位(configuration)、その配位を指定するための変数を一般化座標、その一般化座標の数を自由度と呼ぶ。一般化座標が住む空間を配位空間と呼び、その次元は自由度に等しい。しかし、先程の写真からは運動を決定することができない。調和振動子なら、釣り合いの位置に戻っていくところなのか、離れていくところなのかが写真からはわからない。そこで、この系の一般化座標に対応する一般化速度も指定することで系の運動を一意に決めることができる。この、一般化座標と一般化速度が住む空間を
                                    <strong>状態空間(state
                                    space)</strong>
                                    と呼ぶことがある。さらに、一般化速度をルジャンドル変換することで得られた一般化運動量を考え、一般化座標と一般化運動量を指定することでも運動を決めることができる。この一般化座標と一般化運動量が住む世界が本章で扱う位相空間である。</p>
                                    <p>さて、この運動方程式が支配する運動について、特徴的な点についていくつか見てみよう。</p>
                                    <p>まず、現在の状態が<span
                                    class="math inline">\((q,p) =
                                    (0,1)\)</span>であるとしよう。この時の運動量と位置の時間微分は<span
                                    class="math inline">\((\dot{q},\dot{p})
                                    =
                                    (1,0)\)</span>となる。これは、質点が原点にあるためにバネからの力はかかっておらず、したがって<span
                                    class="math inline">\(\dot{p}=0\)</span>であること、正の方向に速度<span
                                    class="math inline">\(1\)</span>を持っているため、次の瞬間に<span
                                    class="math inline">\(q\)</span>が増加しようとしていることを表している。つまり、系の状態が<span
                                    class="math inline">\((0,1)\)</span>である時、次の瞬間には<span
                                    class="math inline">\((1,0)\)</span>の方向に移動するということを意味している。そこで位相空間の<span
                                    class="math inline">\((0,1)\)</span>の場所に、移動の向きとして<span
                                    class="math inline">\((1,0)\)</span>のベクトルを書いておこう。</p>
                                    <p>次に、現在の状態が<span
                                    class="math inline">\((q,p) =
                                    (1,0)\)</span>であるとしよう。この時の運動量と位置の時間微分は<span
                                    class="math inline">\((\dot{q},\dot{p})
                                    =
                                    (0,-1)\)</span>となる。これはバネが伸び切って、速度がゼロである状態であるため、あとは縮む一方であることを意味する。そこで先程と同様に位相空間の<span
                                    class="math inline">\((1,0)\)</span>の点に、<span
                                    class="math inline">\((0,-1)\)</span>のベクトルを書いておこう。</p>
                                    <p>同様な手続きで、<span
                                    class="math inline">\((0,-1)\)</span>の場所には<span
                                    class="math inline">\((-1,0)\)</span>のベクトルが、<span
                                    class="math inline">\((-1,0)\)</span>の場所には<span
                                    class="math inline">\((0,1)\)</span>のベクトルを置くことになる。こうして<span
                                    class="math inline">\((q,p)\)</span>空間の様々な場所に、その地点での<span
                                    class="math inline">\((\dot{q},\dot{p})\)</span>の値をベクトルとして書き込んでいくと、全体で回転するようなベクトル場が得られる。すなわち、運動方程式は位相空間にベクトル場を定義する写像であると考えることができる。</p>
                                    <figure>
                                    <img src="fig/phasespace.png"
                                    alt="phasespace.png" />
                                    <figcaption
                                    aria-hidden="true">phasespace.png</figcaption>
                                    </figure>
                                    <p>もともとの運動方程式は二変数の連立一階微分方程式であるから、初期条件として<span
                                    class="math inline">\((q,p)\)</span>の組を与えると、以後の運動が全てきまる。最初に<span
                                    class="math inline">\((q,p)\)</span>の状態であった質点は、微小な時間<span
                                    class="math inline">\(\delta
                                    t\)</span>だけ経過すると、<span
                                    class="math inline">\((p + \dot{p}
                                    \delta t, q + \dot{q} \delta
                                    t)\)</span>に移動するであろう。移動先を新たな初期条件と考えると、次はその場所でのベクトル<span
                                    class="math inline">\((\dot{p},
                                    \dot{q})\)</span>に従って進んでいく。運動方程式は、位相空間という地図に、「次はどこに進むべきか」という情報を与えている。</p>
                                    <h1
                                    id="ラグランジュ描像とオイラー描像">ラグランジュ描像とオイラー描像</h1>
                                    <p>ここで、運動方程式を「運動を規程するもの」という見方から「位相空間に速度場を定義するもの」という見方に移ったことに注意したい。これは、ラグランジュ描像からオイラー描像に移ったことに対応する。</p>
                                    <p>今、流れる川の中に葉っぱが落ちたとしよう。その葉っぱをずっと追いかけると、その葉っぱは水から押されて右にいったり左にいったりしながら流れていく様子が見えるだろう。このように観測者が運動する物体に並走し、その物体の軌跡を観察するのがラグランジュ描像である。ニュートンの運動方程式は、ラグランジュ描像により運動を記述する。</p>
                                    <p>一方、流れに関しては、媒質の運動をおいかけるよりも、その場にとどまって、その場所での流れがどのように変化していくかに興味があることが多い。例えば天気予報においては、ある特定の雲の運動を追いかけるよりも、ある地点において雲がどう入ってきてどう出ていくかの方が重要である。このように観測者の場所を固定し、その場所での流れを観察し続けるのがオイラー描像である。</p>
                                    <p>オイラー描像では、空間に固定された座標系を考え、物理量をその座標系における場の量として捉える。<strong>場(field)</strong>
                                    とは、物理量を空間や時間の関数として捉えることである。例えば等高線のある地図を考えよう。例えば緯度と経度のような適当な座標を指定すると、その場所での標高が決まる。この地図は、二次元座標<span
                                    class="math inline">\((x,y)\)</span>を決めると、その場所での高さ<span
                                    class="math inline">\(h(x,y)\)</span>を与えている。このように、座標を決めるとスカラー量が与えられるような場をスカラー場と呼ぶ。例えば温度や密度はスカラー量であるから、温度場や密度場はスカラー場である。</p>
                                    <p>同様に、場所を決めるとベクトルが決まるような場をベクトル場と呼ぶ。例えば流れるプールでは、場所が決まれば流れる向きが決まる。この流れの速度場はベクトル場である。正準方程式は、<span
                                    class="math inline">\((q,p)\)</span>という位相空間に、<span
                                    class="math inline">\((\dot{p},
                                    \dot{q})\)</span>というベクトル場を対応させる写像であると考えることができる。場所を指定すると、そこに住むテンソルを返すテンソル場も定義できる。材料力学などで重要となる応力場などもテンソル場である。</p>
                                    <p>さて、ベクトル場が定義された位相空間の一点にトレーサーを置こう。トレーサーはその場所のベクトルの向きに移動する。そして、移動先のベクトルの向きに動き……ということを繰り返す。川にインクを少量ずつたらしていくとそのインクにより流れ場が可視化されるように、トレーサーは位相空間における軌跡を可視化する。すなわち、位相空間におけるベクトル場とは、系の時間発展の流れを表す流れ場となっている。この流れ場の性質を調べるのが本章の目的である。</p>
                                    <h1
                                    id="位相空間とベクトル場">位相空間とベクトル場</h1>
                                    <p>一自由度系のハミルトニアン<span
                                    class="math inline">\(H(q,p)\)</span>に支配される正準方程式を考えよう。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \dot{q} &amp;= \frac{\partial
                                    H}{\partial p} \\
                                    \dot{p} &amp;= - \frac{\partial
                                    H}{\partial q}
                                    \end{aligned}
                                    \]</span></p>
                                    <p>これを、<span
                                    class="math inline">\((q,p)\)</span>で張られる位相空間に<span
                                    class="math inline">\((\dot{q},
                                    \dot{p})\)</span>という速度場を定義する式であると考える。位相空間の座標をまとめて<span
                                    class="math inline">\(\mathbf{z}\)</span>で表そう。すなわち、</p>
                                    <p><span class="math display">\[
                                    \mathbf{z} =
                                    \begin{pmatrix} q\\ p
                                    \end{pmatrix},
                                    \dot{\mathbf{z}} =
                                    \begin{pmatrix}
                                    \dot{q} \\
                                    \dot{p}
                                    \end{pmatrix}
                                    \]</span></p>
                                    <p>ハミルトニアンに関して<span
                                    class="math inline">\(q\)</span>や<span
                                    class="math inline">\(p\)</span>の偏微分があるので、ハミルトニアンをスカラー場と思って<span
                                    class="math inline">\(\mathbf{z}\)</span>で微分してみよう。</p>
                                    <p><span class="math display">\[
                                    \frac{\partial H}{\partial
                                    \mathbf{z}} \equiv \nabla H =
                                    \begin{pmatrix}
                                    \partial_q H \\
                                    \partial_p H
                                    \end{pmatrix}
                                    \]</span></p>
                                    <p>ベクトル<span
                                    class="math inline">\(\nabla
                                    H\)</span>の要素を見ると、正準方程式に現れる偏微分と上下が逆で、かつ片方に負符号がついていることがわかる。そこで、正準方程式に合うように変換するために、以下のような行列を導入しよう。</p>
                                    <p><span class="math display">\[
                                    \Omega=
                                    \begin{pmatrix}
                                    0 &amp; 1\\
                                    -1 &amp; 0
                                    \end{pmatrix}
                                    \]</span></p>
                                    <p>すると、正準方程式は以下のように表現できる。</p>
                                    <p><span class="math display">\[
                                    \dot{\mathbf{z}} = \Omega \nabla H
                                    \]</span></p>
                                    <p>ベクトル場<span
                                    class="math inline">\(\dot{\mathbf{z}}\)</span>は、位相空間にハミルトニアンが作るベクトル場であるため、
                                    <strong>ハミルトニアンベクトル場(Hamiltonian
                                    vector field)</strong>
                                    と呼ばれる。この式から、ただちに</p>
                                    <p><span class="math display">\[
                                    \dot{\mathbf{z}} \cdot \nabla H = 0
                                    \]</span></p>
                                    <p>がわかる。すなわち、ハミルトニアンベクトル場はハミルトニアンの勾配と直交している。</p>
                                    <p>この式の幾何学的な意味を考えていこう。右辺の一番左から順番に考えていく。</p>
                                    <figure>
                                    <img src="fig/phaseflow.png"
                                    alt="ハミルトンベクトル場の作り方" />
                                    <figcaption
                                    aria-hidden="true">ハミルトンベクトル場の作り方</figcaption>
                                    </figure>
                                    <p><span
                                    class="math inline">\(H(q,p)\)</span>はスカラー場である。つまり、場所を指定するとスカラーが返ってくる。ハミルトニアンは系の全エネルギーであるから、<span
                                    class="math inline">\(H(q,p)\)</span>は、位相空間上の点<span
                                    class="math inline">\((q,p)\)</span>におけるエネルギーを表している。同じエネルギーの場所をつないでいくと、エネルギーに関する等高線を描くことができる。</p>
                                    <p>次に、<span
                                    class="math inline">\(\nabla
                                    H\)</span>は、スカラー場<span
                                    class="math inline">\(H(q,p)\)</span>から作られるベクトル場である。ベクトル場であるから、場所を指定するとベクトル量が返ってくる。このベクトルは、最もエネルギーが高くなる方向を向き、かつエネルギー勾配が急であればあるほど絶対値が大きくなるという性質を持っている。それを簡単に説明しておこう。</p>
                                    <p>あるスカラー関数<span
                                    class="math inline">\(f(x,y)\)</span>があるとする。この地点<span
                                    class="math inline">\((x,y)\)</span>から、微小距離
                                    <span
                                    class="math inline">\(\varepsilon
                                    &gt;
                                    0\)</span>だけ移動するという条件で、最も<span
                                    class="math inline">\(f\)</span>の値を大きくする場所を探したい。これは、<span
                                    class="math inline">\(\varepsilon^2
                                    =
                                    \varepsilon_x^2+\varepsilon_y^2\)</span>という条件の下、<span
                                    class="math inline">\(f(x+\varepsilon_x,
                                    y+\varepsilon_y) -
                                    f(x,y)\)</span>を最大化するような方向ベクトル<span
                                    class="math inline">\((\varepsilon_x,
                                    \varepsilon_y)\)</span>を探しなさい、という問題になっている。テイラー展開により、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    f(x+\varepsilon_x, y+\varepsilon_y)
                                    - f(x,y) &amp;= \frac{\partial
                                    f}{\partial x} \varepsilon_x +
                                    \frac{\partial f}{\partial y}
                                    \varepsilon_y +
                                    O(\varepsilon_x^2)+O(\varepsilon_y^2)\\
                                    &amp;=
                                    \begin{pmatrix}
                                    \partial_x f \\
                                    \partial_y f
                                    \end{pmatrix}
                                    \cdot
                                    \begin{pmatrix}
                                    \varepsilon_x \\
                                    \varepsilon_y
                                    \end{pmatrix}
                                    +O(\varepsilon_x^2)+O(\varepsilon_y^2)
                                    \end{aligned}
                                    \]</span></p>
                                    <p>いま、方向ベクトル<span
                                    class="math inline">\((\varepsilon_x,
                                    \varepsilon_y)\)</span>の大きさを固定したまま、左辺を最大化するためには、内積を最大化する必要がある。つまり、方向ベクトルは<span
                                    class="math inline">\((\partial_x
                                    f,\partial_y
                                    f)\)</span>と平行でなければならない。故に、<span
                                    class="math inline">\(\nabla f
                                    \equiv (\partial_x f,\partial_y
                                    f)\)</span>は、スカラー場<span
                                    class="math inline">\(f\)</span>の最大傾斜の方向を表すベクトルである。そのため、<span
                                    class="math inline">\(\nabla
                                    f\)</span>はスカラー場の勾配(gradient)と呼び、<span
                                    class="math inline">\(\mathrm{grad}
                                    f\)</span>とも表す。</p>
                                    <p>さて、<span
                                    class="math inline">\(\nabla
                                    H\)</span>が位相空間におけるエネルギー勾配ベクトル場を表すことがわかった。それに行列<span
                                    class="math inline">\(\Omega\)</span>をかけたものが運動方程式となる。行列<span
                                    class="math inline">\(\Omega\)</span>は、時計回りに90度回転させる回転行列となっている。以上をまとめると、ハミルトニアンベクトルは以下のようにして作られる。</p>
                                    <ol type="1">
                                    <li>ハミルトニアン<span
                                    class="math inline">\(H\)</span>により位相空間にエネルギー場が定義される</li>
                                    <li><span
                                    class="math inline">\(\nabla
                                    H\)</span>により、エネルギーの勾配ベクトル場が定義される</li>
                                    <li><span
                                    class="math inline">\(\Omega \nabla
                                    H\)</span>により、勾配ベクトル場を反時計回りに90度回転させたものがハミルトニアンベクトル場である</li>
                                    </ol>
                                    <p>正準方程式のベクトル表現の式から、ただちに以下の関係式が満たされることがわかる。</p>
                                    <p><span class="math display">\[
                                    \dot{\mathbf{z}} \cdot \nabla H = 0
                                    \]</span></p>
                                    <p>すなわち、ハミルトニアンベクトル場と、ハミルトニアンの勾配ベクトルは直交している。我々の目的は運動方程式を解くことであった。運動方程式の解は、位相空間上ではハミルトニアンベクトル場に沿って「流れて」いく流線に対応しており、これを解曲線と呼ぶ。ハミルトニアンベクトル場が、エネルギーの勾配ベクトルと直交していることから、解曲線は<span
                                    class="math inline">\(H(q,p)\)</span>の等高線上を運動する。すなわち、運動によりエネルギーが保存する。ハミルトニアンベクトル場は、「なぜ運動によりエネルギーが保存するか？」という問いに対して「運動方程式が位相空間に作る流れの方向が、エネルギーが変化する向きと常に直交しているから」という答えを用意する。</p>
                                    <p>先ほどの調和振動子の位相空間を思い起こそう。運動方程式は位相空間に回転するような速度場を定義する。回転半径は回転によって変化しない。この回転半径がエネルギーにあたり、回転角度が時間にあたる。すなわち、時間発展とは位相空間における回転である。また、ニュートンの運動方程式は一つの調和振動子の振動する様子を記述しているが、位相空間は、この運動方程式で記述可能な運動を一度に全て記述している。このように、解析力学では居所的なものの見方から、大域的なものの見方へ視点を変化させる。</p>
                                    <h1
                                    id="リュービルの定理">リュービルの定理</h1>
                                    <p>さて、ハミルトニアンベクトル場は、もう一つ重要な性質を持っている。ハミルトニアンベクトル場が作る速度場<span
                                    class="math inline">\(\dot{\mathbf{z}}\)</span>を考えよう。この速度場と<span
                                    class="math inline">\(\nabla\)</span>の内積を考える。ベクトル同士の内積であるから、結果はスカラー量になる。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \nabla \dot{\mathbf{z}} &amp;=
                                    \begin{pmatrix}
                                    \partial_q\\
                                    \partial_p
                                    \end{pmatrix}
                                    \cdot
                                    \begin{pmatrix}
                                    \dot{q}\\
                                    \dot{p}
                                    \end{pmatrix}
                                    \\
                                    &amp;=
                                    \begin{pmatrix}
                                    \partial_q\\
                                    \partial_p
                                    \end{pmatrix}
                                    \cdot
                                    \begin{pmatrix}
                                    \partial_p H\\ -\partial_q H
                                    \end{pmatrix}\\
                                    &amp;= \frac{\partial^2 H }{\partial
                                    p \partial q} - \frac{\partial^2 H
                                    }{\partial p \partial q}\\
                                    &amp;=0
                                    \end{aligned}
                                    \]</span></p>
                                    <p>すなわち、ハミルトニアンベクトル場と<span
                                    class="math inline">\(\nabla\)</span>との内積は常にゼロとなる。この、<span
                                    class="math inline">\(\nabla
                                    \dot{\mathbf{z}}=0\)</span>の幾何学的な意味を考えてみよう。</p>
                                    <p>一次元の流れを考える。位置<span
                                    class="math inline">\(x\)</span>において、密度場<span
                                    class="math inline">\(\rho(x)\)</span>と速度場<span
                                    class="math inline">\(v(x)\)</span>が定義されている。この時、位置<span
                                    class="math inline">\(x\)</span>近傍の微小区間における物質の収支を考えよう。<span
                                    class="math inline">\(x\)</span>軸を右方向にとる。</p>
                                    <figure>
                                    <img src="fig/flow_balance.png"
                                    alt="流入の収支" />
                                    <figcaption
                                    aria-hidden="true">流入の収支</figcaption>
                                    </figure>
                                    <p>この微小区間左から流入してくる単位時間あたりの物質量は、密度と速度の積であるから<span
                                    class="math inline">\(\rho(x)v(x)\)</span>である。同様に、右から流出する物質量は<span
                                    class="math inline">\(\rho(x+h)v(x+h)\)</span>である。時刻<span
                                    class="math inline">\(t\)</span>における位置<span
                                    class="math inline">\(x\)</span>の物質量は<span
                                    class="math inline">\(h\rho(x)\)</span>であるから、単位時間あたりの変化量は<span
                                    class="math inline">\(h \partial_t
                                    \rho(x)\)</span>である。</p>
                                    <p>以上から、単位時間あたりの<span
                                    class="math inline">\(x\)</span>軸方向の収支は</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{\partial \rho}{\partial t}
                                    &amp;= \frac{\rho(x)v(x) -
                                    \rho(x+h)v(x+h)}{h} \\
                                    &amp;= - \frac{\partial}{\partial
                                    x}\left(\rho v \right) + O(h^2)\\
                                    &amp;= - v \frac{\partial
                                    \rho}{\partial x} - \rho
                                    \frac{\partial v}{\partial x}
                                    \end{aligned}
                                    \]</span></p>
                                    <p>ここで、以下の
                                    <strong>物質微分(material
                                    derivative)</strong>
                                    を定義する。</p>
                                    <p><span class="math display">\[
                                    \frac{D}{Dt} \equiv
                                    \frac{\partial}{\partial t} + v
                                    \frac{\partial}{\partial x}
                                    \]</span></p>
                                    <p>物質微分とは、流れに沿って物理量の変化を追いかけた時の変化量、すなわちラグランジュ描像に立った微分であるから、ラグランジュ微分とも呼ばれる。</p>
                                    <figure>
                                    <img
                                    src="fig/material_derivative.png"
                                    alt="物質微分" />
                                    <figcaption
                                    aria-hidden="true">物質微分</figcaption>
                                    </figure>
                                    <p>オイラー微分とラグランジュ微分は、時刻<span
                                    class="math inline">\(t\)</span>から<span
                                    class="math inline">\(h\)</span>後に、どこの場所の値と比較しているかの違いを表している。オイラー微分は、同じ場所において、異なる時間の変化を追いかけている。</p>
                                    <p><span class="math display">\[
                                    \rho(x,t+h)-\rho(x,h) \sim
                                    \frac{\partial \rho}{\partial t}h +
                                    O(h^2)
                                    \]</span></p>
                                    <p>ラグランジュ微分は、流れ(速度場)に沿って移動する観測者が感じる変化を追いかける。時刻<span
                                    class="math inline">\(t\)</span>において観測者が位置<span
                                    class="math inline">\(x(t)\)</span>におり、その場所における速度場が<span
                                    class="math inline">\(v(x)\)</span>であったなら、時刻<span
                                    class="math inline">\(t+h\)</span>後には、この観測者は<span
                                    class="math inline">\(x +
                                    vt\)</span>の場所に移動しているため、その差を取ると</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \rho(x+vh,t+h) - \rho(x,h) &amp;=
                                    \rho(x+vh,t+h) - \rho(x+vh,t)
                                    +\rho(x+vh,t)- \rho(x,h) \\
                                    &amp;= v \frac{\partial
                                    \rho}{\partial x}h + \frac{\partial
                                    \rho}{\partial t}h +O(h^2)
                                    \end{aligned}
                                    \]</span></p>
                                    <p>ラグランジュ微分を使うと、先程の式は以下のようにまとめられる。</p>
                                    <p><span class="math display">\[
                                    \frac{D \rho}{D t} = -\rho
                                    \frac{\partial v}{\partial x}
                                    \]</span></p>
                                    <p>ここまでは一次元を考えたが、高次元の場合でも全く同様に計算できる。</p>
                                    <figure>
                                    <img src="fig/lagrange2d.png"
                                    alt="lagrange2d" />
                                    <figcaption
                                    aria-hidden="true">lagrange2d</figcaption>
                                    </figure>
                                    <p>例えば2次元の密度場<span
                                    class="math inline">\(\rho(x,y)\)</span>と流れ場<span
                                    class="math inline">\(\mathbf{v}(x,y)\)</span>を考えよう。<span
                                    class="math inline">\((x,y)\)</span>から<span
                                    class="math inline">\((x+h,
                                    y+h)\)</span>の正方形の領域における物質の収支を考える。<span
                                    class="math inline">\(x\)</span>方向の収支<span
                                    class="math inline">\(J_x\)</span>は、左から<span
                                    class="math inline">\(v_x(x,y)\)</span>の速度かつ<span
                                    class="math inline">\(\rho(x,y)\)</span>の密度で流入し、右から<span
                                    class="math inline">\(v_x(x+h,y)\)</span>の速度かつ<span
                                    class="math inline">\(\rho(x+h,y)\)</span>の密度で流出するから、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    J_x &amp;= \left(v_x(x,y)\rho(x,y) -
                                    v_x(x + h,y)\rho(x,y) \right)h \\
                                    &amp;= - h^2
                                    \frac{\partial}{\partial x}
                                    \left(v_x \rho \right) + O(h^2)
                                    \end{aligned}
                                    \]</span></p>
                                    <p>同様に<span
                                    class="math inline">\(y\)</span>方向の収支は</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    J_y &amp;= \left(v_y(x,y)\rho(x,y) -
                                    v_y(x,y)\rho(x,y+h) \right)h \\
                                    &amp;= - h^2
                                    \frac{\partial}{\partial y}
                                    \left(v_y \rho \right) + O(h^2)
                                    \end{aligned}
                                    \]</span></p>
                                    <p>その結果、単位時間あたり正方形の領域内の密度が<span
                                    class="math inline">\(\Delta
                                    \rho(x,y)\)</span>だけ変化したならば、密度に面積をかけたものが物質量であるから、</p>
                                    <p><span class="math display">\[
                                    \Delta \rho h^2 = J_x + J_y
                                    \]</span></p>
                                    <p><span
                                    class="math inline">\(\Delta \rho =
                                    \partial \rho/ \partial
                                    t\)</span>だと思えば、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \Delta \rho &amp;= -
                                    \frac{\partial}{\partial x}
                                    \left(v_x \rho \right) -
                                    \frac{\partial}{\partial y}
                                    \left(v_y \rho \right) \\
                                    &amp;= - \nabla \left(\rho
                                    \mathbf{v} \right)
                                    \end{aligned}
                                    \]</span></p>
                                    <p><span class="math display">\[
                                    \frac{D}{D t} \equiv
                                    \frac{\partial}{\partial t} +
                                    \mathbf{v} \cdot \nabla
                                    \]</span></p>
                                    <p>として多次元のラグランジュ微分を定義すれば</p>
                                    <p><span class="math display">\[
                                    \frac{D \rho}{D t} = -\rho (\nabla
                                    \cdot \mathbf{v})
                                    \]</span></p>
                                    <p>と同じ式が得られる。</p>
                                    <p>ここで、右辺に現れた<span
                                    class="math inline">\(\nabla \cdot
                                    \mathbf{v}\)</span>の項の意味を考えよう。簡単のために一次元で考える。</p>
                                    <figure>
                                    <img src="fig/divergence.png"
                                    alt="divergence" />
                                    <figcaption
                                    aria-hidden="true">divergence</figcaption>
                                    </figure>
                                    <p>いま、一列に並んだ車が同じ方向に走っており、その速度<span
                                    class="math inline">\(v\)</span>が位置<span
                                    class="math inline">\(x\)</span>の関数として書けているとする。</p>
                                    <p>一般に、速度場<span
                                    class="math inline">\(\mathbf{v}\)</span>の位置による微分が正である時、流入速度よりも、流出速度の方が大きいことになる。これは、そこに何か湧き出していることを意味する。逆に、微分が負であるならば、流入速度より流出速度の方が小さく、これはそこに吸い込みがあることを意味する。</p>
                                    <p>以上から、速度場の空間微分<span
                                    class="math inline">\((\nabla \cdot
                                    \mathbf{v})\)</span>を
                                    <strong>発散(divergence)</strong>
                                    と呼び、<span
                                    class="math inline">\(\mathrm{div}
                                    \mathbf{v}\)</span>とも書く。</p>
                                    <p>さて、速度場の発散がゼロ、つまり</p>
                                    <p><span class="math display">\[
                                    \nabla \cdot \mathbf{v} = 0
                                    \]</span></p>
                                    <p>としよう。この時、密度の物質微分がゼロ、すなわち流れに追いかけた場合の密度変化がゼロとなる。この流体は流れに対して密度が変わらない。このような流体を非圧縮流体と呼ぶ。</p>
                                    <p>ハミルトニアンベクトル場に話を戻そう。ハミルトニアンベクトル場は、位相空間上に<span
                                    class="math inline">\(\dot{\mathbf{z}}\)</span>という速度場を作る。既に見たように、その発散がゼロ、すなわち</p>
                                    <p><span class="math display">\[
                                    \nabla \cdot \dot{\mathbf{z}} =0
                                    \]</span></p>
                                    <p>であるから、この速度場が作る流れは非圧縮流体となる。位相空間の流れ場は、適当な場所にトレーサーを置くと、そのトレーサーの軌跡が運動を表すのであった。いま、位相空間の微小な領域に多数のトレーサーを置いて、その時間発展を追うことにしよう。これは、水の流れに墨汁を1滴垂らすようなイメージである。流れに沿って墨汁は流れていくが、流体が非圧縮であるならば、その面積は変わらない。同様に、ハミルトニアンベクトル場は、位相空間の微小体積要素を変化させない。これを
                                    <strong>リュービルの定理(Liouville’s
                                    theorem)</strong>
                                    と呼ぶ。これは、位相空間における流れが本質的に回転であり、流体が圧縮されたり膨張されることはないことを表している。</p>
                                    <p>運動方程式は、初期条件を与えると、以後の運動を記述するのであった。それに対して、位相空間は、運動方程式が記述するすべての運動をまとめて表現している。位相空間の微小な領域に多数のトレーサーを置き、それらの運動を追いかけることを考えよう。非常に多くの同じ物理系を用意し、それらに少しずつ違う初期条件を与えて時間発展させる。そして、しばらくたった後に無作為に一つ選び、状態を観測しよう。この時、どんな状態になっているだろうか？</p>
                                    <p>これは、最初にデルタ関数的な状態の確率分布を与えておき、その確率分布がどのように時間発展するかを調べていることに対応する。位相空間における密度場とは、この確率分布に対応する。流れ場が非圧縮ということは、密度場が流れに沿って時間変化しない、ということを表すから、系が十分に混合的であるならば、長時間たてば可能なすべての状態に至るであろう。すると、与えた初期エネルギーにより許されるすべての状態が等確率で観測されることになる。</p>
                                    <p>これは、一つの系を十分長時間観測し、物理量を時間平均した結果と、少しずつ初期条件を変えた(しかしエネルギーなどのマクロな物理量は同じにした)系を多数用意し、十分に時間がたったあとにそれらの平均(アンサンブル平均)をとった結果が等しい、ということを示唆する。このような性質をエルゴード性と呼ぶ。</p>
                                    <p>エルゴード性については様々な議論があり、ここで深くは触れない。しかし、運動方程式は一つの運動を個別的に追いかけていたのに対して、位相空間を考えると運動全体の集合をまとめて扱っていること、運動とは位相空間における回転であること、回転であるから、流れが非圧縮となることなどは覚えて欲しい。</p>
                                    <h1 id="まとめ">まとめ</h1>
                                    <p>系の配位を表す変数を一般化座標と呼び、その座標が作る空間を配位空間と呼ぶのであった。一般化座標の数、すなわち配位空間の次元を自由度と呼ぶ。運動方程式は二階の微分方程式であるから、一般化座標を指定するだけでは系の状態は一意に決まらない。そこで一般化運動量を考え、<span
                                    class="math inline">\(N\)</span>自由度系の二階微分方程式を<span
                                    class="math inline">\(2N\)</span>自由度系の一階微分方程式で表した。これが正準方程式であった。正準方程式は一階の連立常備分微分方程式系であるから、系の変数を指定すれば、その後の時間発展は全て決まる。すなわち、正準変数の組を一つ指定すれば系の状態を決めることができる。この正準変数が住む空間を位相空間と呼ぶ。正準方程式とは、位相空間に速度場を作っており、この速度場は広い意味で回転運動を表している。位相空間を考えることで、一つの初期条件から決まる運動を追いかけるのではなく、その運動方程式に従う全ての系の性質を一度に調べることができる。初期条件とは、位相空間に置くトレーサーであり、運動方程式の解はそのトレーサーの軌跡である。また、位相空間に作られた流れ場は非圧縮であり、これをリュービルの定理と呼ぶ。解析力学では視点を変えるのが重要であると繰り返し述べた。位相空間を考えることで、運動全体が織りなす「流れ」が見えるようになっただろうか？</p>
                                    <h1
                                    id="余談理論の正しさ">余談：理論の正しさ</h1>
                                    <p>量子力学や相対性理論を学ぶと、「古典力学は近似的に正しい」と思う人がいる。しかし、それを「古典力学が不正確である」という意味に理解してはならない。確かに、量子力学はプランク定数が小さい極限(<span
                                    class="math inline">\(\hbar
                                    \rightarrow
                                    0\)</span>)として古典力学を含むし、ローレンツ変換は光速が速い極限(<span
                                    class="math inline">\(c\rightarrow
                                    \infty\)</span>)としてガリレイ変換を含む。その意味で、古典力学が量子力学や相対性理論のある種の極限をとった理論になっていることは間違いない。物理は世界を記述する学問であるが、理論が正しいかどうかは観測を行って決定する必要がある。一般に観測の精度は必ず有限であるため、その観測精度未満の現象については理論の対象外となる。例えば野球の投手の投げるボールは、早くても時速150キロ程度である。光速は時速10億7900万キロであるから、ボールの速度を<span
                                    class="math inline">\(v\)</span>、光速を<span
                                    class="math inline">\(c\)</span>とすると、<span
                                    class="math inline">\(\varepsilon =
                                    v/c \sim
                                    10^{-7}\)</span>である。ローレンツ変換の係数は<span
                                    class="math inline">\(1/\sqrt{1 -
                                    v^2/c^2}\)</span>であるから、</p>
                                    <p><span class="math display">\[
                                    \frac{1}{\sqrt{1 - v^2/c^2}} =
                                    \frac{1}{\sqrt{1-\varepsilon^2}}
                                    \sim 1 + \frac{\varepsilon^2}{2}
                                    \]</span></p>
                                    <p>つまり、ローレンツ変換による補正は<span
                                    class="math inline">\(10^{-14}\)</span>のオーダーとなる。野球のボールの直径は7cm程度であるから、ローレンツ収縮は概ね1フェムトメートル程度となる。これは典型的な原子のサイズより5桁も小さく、観測するのはまず不可能である。逆にいえば、系の特徴的な速度<span
                                    class="math inline">\(v\)</span>と光速<span
                                    class="math inline">\(c\)</span>の比<span
                                    class="math inline">\(c/v\)</span>が十分に小さい領域であれば、観測精度範囲内において古典力学は精密に正しい。量子力学においても同様に、ド・ブロイ系波長<span
                                    class="math inline">\(\lambda\)</span>と系の特徴的なサイズ<span
                                    class="math inline">\(L\)</span>の比<span
                                    class="math inline">\(\lambda/L\)</span>が十分に小さければ古典論が精密な結果を与える。同様なことが流体力学にも言える。流体力学は流体を連続的な場として表現するが、実際には流体は原子や分子の集まりである。しかし、よほど小さい系を考えない限り、流体は連続であるとして全く問題ない。実際、流体力学は最も成功した学問の一つであり、極めて精密に実験事実を記述できる。流れ場を連続場として扱ってよいかは、構成粒子の平均自由行程<span
                                    class="math inline">\(\lambda\)</span>と系のサイズの比<span
                                    class="math inline">\(\lambda/L\)</span>が十分に小さいかどうかで決まる。このように、多くの理論は適用範囲があり、適用可能かどうかを決める無次元量が存在する。繰り返しになるが、物理の理論の目的は世界を記述することであり、世界を記述するとは観測事実を説明することであり、観測は常に有限の精度を伴うのであるから、正しい理論とは
                                    <strong>必要な精度</strong>
                                    で観測事実を説明する理論のことである。その意味において古典力学は(適用範囲内では)正しい理論である。</p>
                    </article>
    </body>

    </html>