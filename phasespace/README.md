# 位相空間とリュービルの定理

## 本章の目的

本章では位相空間を扱う。位相空間を考えることで、これまでの「物体の運動を追いかける」というラグランジュ的な描像から、「運動全体を流れ場として考える」というオイラー的描像に移り変わる。また、勾配や発散といったベクトル解析の言葉で運動が表現されるのも面白いところである。さらに、正準方程式に支配される運動が生み出す流れ場が非圧縮であるというリュービルの定理を導く。

## 位相空間

一次元調和振動子の運動を考えよう。簡単のため、質量やバネ定数を1とすると、正準方程式は以下のようになる。

$$
\begin{aligned}
\dot{q} &= p \\
\dot{p} &= - q 
\end{aligned}
$$

これは二変数の一階微分方程式であるから、この運動は初期条件として$(q,p)$の2つの変数を与えると、それ以後の運動が全て決まる。運動方程式を解くとは、$(q(t), p(t))$の時間発展を決めることだが、そこから$t$を消去すると、$(q,p)$空間の曲線となる。これを運動の軌道と呼ぶ。自由度が1の系では、二次元空間を用意すれば過不足なく運動の軌道を記述できる。自由度が$N$の系であれば$2N$次元の空間が必要である。例えば、3次元空間で$N$個の質点が相互作用しているような系は$6N$次元の空間が必要となる。運動を過不足無く記述できるような空間を **位相空間(phase space)** と呼ぶ。一次元の調和振動子であれば、$(q,p)$で表現される二次元空間が位相空間である。なお、位相空間の座標のうち、$p$と$q$のどちらを最初の軸に選ぶかは教科書によって異なる。$(q,p)$の座標を採用する教科書が多いが、本書では$(q,p)$の座標を採用するので注意すること。回転方向や符号が他書と異なる場合がある。

さて、この運動方程式が支配する運動について、特徴的な点についていくつか見てみよう。

まず、現在の状態が$(q,p) = (1,0)$であるとしよう。この時の運動量と位置の時間微分は$(\dot{q},\dot{p}) = (0,-1)$となる。これはバネが伸び切って、速度がゼロである状態であるため、あとは縮む一方であることを意味する。そこで先程と同様に位相空間の$(1,0)$の点に、$(0,-1)$のベクトルを書いておこう。

まず、現在の状態が$(q,p) = (0,1)$であるとしよう。この時の運動量と位置の時間微分は$(\dot{q},\dot{p}) = (1,0)$となる。これは、質点が原点にあるためにバネからの力はかかっておらず、したがって$\dot{p}=0$であること、正の方向に速度$1$を持っているため、次の瞬間に$q$が増加しようとしていることを表している。つまり、系の状態が$(0,1)$である時、次の瞬間には$(1,0)$の方向に移動するということを意味している。そこで位相空間の$(0,1)$の場所に、移動の向きとして$(1,0)$のベクトルを書いておこう。

同様な手続きで、$(0,-1)$の場所には$(-1,0)$のベクトルが、$(-1,0)$の場所には$(0,1)$のベクトルを置くことになる。こうして$(q,p)$空間の様々な場所に、その地点での$(\dot{q},\dot{p})$の値をベクトルとして書き込んでいくと、全体で回転するようなベクトル場が得られる。すなわち、運動方程式は位相空間にベクトル場を定義する写像であると考えることができる。

もともとの運動方程式は二変数の連立一階微分方程式であるから、初期条件として$(q,p)$の組を与えると、以後の運動が全てきまる。最初に$(q,p)$の状態であった質点は、微小な時間$\delta t$だけ経過すると、$(p + \dot{p} \delta t, q + \dot{q} \delta t)$に移動するであろう。移動先を新たな初期条件と考えると、次はその場所でのベクトル$(\dot{p}, \dot{q})$に従って進んでいく。運動方程式は、位相空間という地図に、「次はどこに進むべきか」という情報を与えている。

## ラグランジュ描像とオイラー描像

運動方程式を「物体の運動を記述する」という見方から、「位相空間に速度場を定義する」という見方に変えることは、ラグランジュ描像からオイラー描像に移ったことに対応する。

今、流れる川の中に葉っぱが落ちたとしよう。その葉っぱをずっと追いかけると、その葉っぱは水から押されて右にいったり左にいったりしながら流れていく様子が見えるだろう。このように観測者が運動する物体に並走し、その物体の軌跡を観察するのがラグランジュ描像である。

一方、流れに関しては、媒質の運動をおいかけるよりも、その場にとどまって、その場所での流れがどのように変化していくかに興味があることが多い。例えば天気予報においては、ある特定の雲の運動を追いかけるよりも、ある地点において雲がどう入ってきてどう出ていくかの方が重要である。このように観測者の場所を固定し、その場所での流れを観察し続けるのがオイラー描像である。

オイラー描像では、物理量を場の量として捉える。**場(field)** とは、物理量を空間や時間の関数として捉えることである。例えば等高線のある地図を考えよう。例えば緯度と経度のような適当な座標を指定すると、その場所での標高が決まる。この地図は、二次元座標$(x,y)$を決めると、その場所での高さ$h(x,y)$を与えている。このように、座標を決めるとスカラー量が与えられるような場をスカラー場と呼ぶ。例えば温度や密度はスカラー量であるから、温度場や密度場はスカラー場である。

同様に、場所を決めるとベクトルが決まるような場をベクトル場と呼ぶ。例えば流れるプールでは、場所が決まれば流れる向きが決まる。この流れの速度場はベクトル場である。正準方程式は、$(q,p)$という位相空間に、$(\dot{p}, \dot{q})$というベクトル場を対応させる写像であると考えることができる。この講義では扱わないが、場所を指定すると、そこに住むテンソルを返すテンソル場も定義できる。材料力学などで重要となる応力場などもテンソル場である。

さて、ベクトル場が定義された位相空間の一点にトレーサーを置こう。トレーサーはその場所のベクトルの向きに移動する。そして、移動先のベクトルの向きに動き……ということを繰り返す。川にインクを少量ずつたらしていくとそのインクにより流れ場が可視化されるように、トレーサーは位相空間における軌跡を可視化する。すなわち、位相空間におけるベクトル場とは、系の時間発展の流れを表す流れ場となっている。この流れ場の性質を調べるのが本章の目的である。

## リュービルの定理

一自由度系のハミルトニアン$H(q,p)$に支配される正準方程式を考えよう。

$$
\begin{aligned}
\dot{q} &= \frac{\partial H}{\partial p} \\
\dot{p} &= - \frac{\partial H}{\partial q} 
\end{aligned}
$$

これを、$(q,p)$で張られる位相空間に$(\dot{p}, \dot{q})$という速度場を定義する式であると考える。位相空間の座標をまとめて$\boldsymbol{z}$で表そう。すなわち、

$$
\boldsymbol{z} =
\begin{pmatrix}
q\\
p
\end{pmatrix}, 
\dot{\boldsymbol{z}} =
\begin{pmatrix}
\dot{q} \\
\dot{p}
\end{pmatrix}
$$

ハミルトニアンに関して$p$や$q$の偏微分があるので、ハミルトニアンをスカラー場と思って$\boldsymbol{z}$で微分してみよう。

$$
\frac{\partial H}{\partial \boldsymbol{z}} \equiv \nabla H
=
\begin{pmatrix}
\partial_q H \\
\partial_p H
\end{pmatrix}
$$

ベクトル$\nabla H$の要素を見ると、正準方程式に現れる偏微分と上下が逆で、かつ片方に負符号がついていることがわかる。そこで、正準方程式に合うように変換するために、以下のような行列を導入しよう。

$$
\Omega=
\begin{pmatrix}
0 & 1\\
-1 & 0
\end{pmatrix}
$$

すると、正準方程式は以下のように表現できる。

$$
\dot{\boldsymbol{z}} = \Omega \nabla H
$$

これは、位相空間にハミルトニアンが作るベクトル場であるため、 **ハミルトニアンベクトル場(Hamiltonian vector field)** と呼ばれる。この式の幾何学的な意味を考えていこう。右辺の一番左から順番に考えていく。

TODO: 図解

$H(q,p)$はスカラー場である。つまり、場所を指定するとスカラーが返ってくる。ハミルトニアンは系の全エネルギーであるから、$H(q,p)$は、位相空間上の点$(q,p)$におけるエネルギーを表している。同じエネルギーの場所をつないでいくと、エネルギーに関する等高線を描くことができる。

次に、$\nabla H$は、スカラー場$H(q,p)$から作られるベクトル場である。ベクトル場であるから、場所を指定するとベクトル量が返ってくる。このベクトルは、最もエネルギーが高くなる方向を向き、かつエネルギー勾配が急であればあるほど絶対値が大きくなるという性質を持っている。それを簡単に説明しておこう。

あるスカラー関数$f(x,y)$があるとする。この地点$(x,y)$から、微小距離 $\varepsilon > 0$だけ移動するという条件で、最も$f$の値を大きくする場所を探したい。これは、$\varepsilon^2 = \varepsilon_x^2+\varepsilon_y^2$という条件の下、$f(x+\varepsilon_x, y+\varepsilon_y) - f(x,y)$を最大化するような方向ベクトル$(\varepsilon_x, \varepsilon_y)$を探しなさい、という問題になっている。テイラー展開により、

$$
\begin{aligned}
f(x+\varepsilon_x, y+\varepsilon_y) - f(x,y) &= \frac{\partial f}{\partial x} \varepsilon_x + \frac{\partial f}{\partial y} \varepsilon_y + O(\varepsilon_x^2)+O(\varepsilon_y^2)\\
&=
\begin{pmatrix}
\partial_x f \\
\partial_y f 
\end{pmatrix}
\cdot
\begin{pmatrix}
\varepsilon_x \\
\varepsilon_y
\end{pmatrix}
+O(\varepsilon_x^2)+O(\varepsilon_y^2)
\end{aligned}
$$

いま、方向ベクトル$(\varepsilon_x, \varepsilon_y)$の大きさを固定したまま、左辺を最大化するためには、内積を最大化する必要がある。つまり、方向ベクトルは$(\partial_x f,\partial_y f)$と平行でなければならない。逆に、$\nabla f \equiv (\partial_x f,\partial_y f)$は、スカラー場$f$の最大傾斜の方向を表すベクトルとなっている。以上から、$\nabla f$はスカラー場の勾配(gradient)を表すため、$\mathrm{grad} f$とも表す。

さて、$\nabla H$が位相空間におけるエネルギー勾配ベクトル場を表すことがわかった。それに行列$\Omega$をかけたものが運動方程式となる。行列$\Omega$は、時計回りに90度回転させる回転行列となっている。以上をまとめると、ハミルトニアンベクトルは以下のようにして作られる。

1. ハミルトニアン$H$により位相空間にエネルギー場が定義される
1. $\nabla H$により、エネルギーの勾配ベクトル場が定義される
1. $\Omega \nabla H$により、勾配ベクトル場を反時計回りに90度回転させたものがハミルトニアンベクトル場である

我々の目的は運動方程式を解くことであった。運動方程式の解は、位相空間上ではハミルトニアンベクトル場に沿って「流れて」いく流線に対応しており、これを解曲線と呼ぶ。ハミルトニアンベクトル場が、エネルギーの勾配ベクトルと直交していることから、解曲線は$H(q,p)$の等高線上を運動する。すなわち、運動によりエネルギーが保存する。ハミルトニアンベクトル場は、「なぜ運動によりエネルギーが保存するか？」という問いに対して「位相空間上での運動の方向が、エネルギーが変化する向きと常に直交しているから」という答えを用意する。

ハミルトニアンベクトル場には、もう一つ重要な性質がある。ハミルトニアンベクトル場が作る速度場$\dot{\boldsymbol{z}}$を考えよう。この速度場と$\nabla$の内積を考える。ベクトル同士の内積であるから、結果はスカラー量になる。

$$
\begin{aligned}
\nabla \dot{\boldsymbol{z}} &=
\begin{pmatrix}
\partial_q\\
\partial_p
\end{pmatrix}
\cdot
\begin{pmatrix}
\dot{q}\\
\dot{p}
\end{pmatrix}
\\
&=
\begin{pmatrix}
\partial_q\\
\partial_p
\end{pmatrix}
\cdot
\begin{pmatrix}
\partial_p H\\
-\partial_q H
\end{pmatrix}\\
&= \frac{\partial^2 H }{\partial p \partial q}
- \frac{\partial^2 H }{\partial p \partial q}\\
&=0
\end{aligned}
$$

すなわち、ハミルトニアンベクトル場と$\nabla$との内積は常にゼロとなる。この、$\nabla \dot{\boldsymbol{z}}=0$の幾何学的な意味を考えてみよう。

TODO: 以下を一次元で書いていたが、わかりにくいので二次元に書き直す。

二次元の流れを考える。位置$\boldsymbol{r}=(x,y)$において、密度場$\rho(x,y)$と速度場$\boldsymbol{v}=(v_x(\boldsymbol{r}), v_y(\boldsymbol{r}))$が定義されている。この時、$\boldsymbol{r}$近傍の微小区間における物質の収支を考えよう。右方向を$x$軸に、上方向を$y$軸にとる。

TODO: 図解

この微小区間左から流入してくる単位時間あたりの物質量は、密度と速度の積であるから$\rho(x,y)v_x(x,y)h$である。同様に、右から流出する物質量は$\rho(x+h, y)v_x(x,y)h$である。したがって、単位時間あたりの$x$軸方向の収支は
$$
\begin{aligned}
\rho(x,y)v_x(x,y)h - \rho(x+h, y)v_x(x+h,y)h &= - \rho(x,y)v_x(x,y)h - 
\left(\rho(x,y) + h\frac{\partial \rho}{\partial x}\right)
\left(v_x(x,y) + h\frac{\partial v_x}{\partial x}\right)h + O(h^2) \\
&= -h^2 v_x \frac{\partial \rho}{\partial x} + \rho \frac{\partial x}{}
\end{aligned}
$$

上下方向も同様に考えると、微小区間の物質量の単位時間あたりの変化量は

TODO: 書きかけ。続きを書くこと。

両辺を$h$で割って$h \rightarrow 0$の極限をとると、

$$
\begin{aligned}
\frac{\partial \rho}{\partial t} &= - \lim_{h \rightarrow 0}\frac{\rho(x+h)v(x+h) - \rho(x)v(x)}{h} \\
&= - \frac{\partial}{\partial x}\left(\rho v \right) \\
&= -v\frac{\partial\rho}{\partial x} - \rho \frac{\partial v}{\partial x}
\end{aligned}
$$

TODO: 物質微分の説明もする。

ここで、以下の物質微分を定義する。

$$
\frac{D}{Dt} \equiv \frac{\partial}{\partial t} + v \frac{\partial}{\partial x}
$$

物質微分とは、流れに沿って物理量の変化を追いかけた時の変化量である。すると、先程の式は以下のようにまとめられる。

$$
\frac{D \rho}{D t} = -\rho \frac{\partial v}{\partial x}
$$

ここまでは一次元で表現したが、三次元の場合でも(さらに高次元の場合でも)全く同様に、物質微分を

$$
\frac{D}{D t} \equiv \frac{\partial}{\partial t} + \boldsymbol{v} \cdot \nabla
$$

として、

$$
\frac{D \rho}{D t} = -\rho (\nabla \cdot \boldsymbol{v})
$$

を導くことができる。

ここで、右辺の意味を考えよう。速度場$\boldsymbol{v}$の位置による微分が正である時、流入速度よりも、流出速度の方が大きいことになる。これは、そこに何か湧き出していることを意味する。逆に、微分が負であるならば、流入速度より流出速度の方が小さく、これはそこに吸い込みがあることを意味する。以上から、速度場の空間微分$(\nabla \cdot \boldsymbol{v})$を **発散(divergence)** と呼び、$\mathrm{div} \boldsymbol{v}$とも書く。

さて、速度場の発散がゼロ、つまり

$$
\nabla \boldsymbol{v}
$$

としよう。この時、密度の物質微分がゼロ、すなわち流れに追いかけた場合の密度変化がゼロとなる。この流体は流れに対して密度が変わらない。このような流体を非圧縮流体と呼ぶ。

ハミルトニアンベクトル場に話を戻そう。ハミルトニアンベクトル場は、位相空間上に$\dot{\boldsymbol{z}}$という速度場を作る。既に見たように、その発散がゼロ、すなわち

$$
\nabla \cdot \dot{\boldsymbol{z}} =0
$$

であるから、この速度場が作る流れは非圧縮流体となる。位相空間の流れ場は、適当な場所にトレーサーを置くと、そのトレーサーの軌跡が運動を表すのであった。いま、位相空間の微小な領域に多数のトレーサーを置いて、その時間発展を追うことにしよう。これは、水の流れに墨汁を1滴垂らすようなイメージである。流れに沿って墨汁は流れていくが、流体が非圧縮であるならば、その面積は変わらない。同様に、ハミルトニアンベクトル場は、位相空間の微小体積要素を変化させない。これを **リュービルの定理(Liouville's theorem)** と呼ぶ。これは、位相空間における流れが本質的に回転であり、流体が圧縮されたり膨張されることはないことを表している。
