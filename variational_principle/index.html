<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <meta name="generator" content="pandoc">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
                                <title>変分原理</title>

        <style>
            .btn-square {
                display: inline-block;
                padding: 0.5em 0.5em;
                text-decoration: none;
                background: #668ad8;
                color: #FFF;
                border-bottom: solid 4px #626295;
                border-radius: 5px;
            }

            .btn-square:active {
                -webkit-transform: translateY(4px);
                transform: translateY(4px);
                border-bottom: none;
            }

            .markdown-body {
                box-sizing: border-box;
                min-width: 200px;
                max-width: 980px;
                margin: 0 auto;
                padding: 45px;
            }

            @media (max-width: 767px) {
                .markdown-body {
                    padding: 15px;
                }
            }
        </style>

        <meta name="viewport" content="width=device-width, initial-scale=1">

                <script
                src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
                type="text/javascript"></script>
                        <link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
        <link rel="icon" href="https://kaityo256.github.io/classical_mechanics/favicon.ico">
        <link rel="stylesheet" href="https://kaityo256.github.io/classical_mechanics/github-markdown.css"
            type="text/css" />
    </head>

    <body>
        <article class="markdown-body">
                                    <header>
                <h1 class="title">変分原理</h1>
                                                            </header>
                                    <p><a href="../index.html">[Up]</a>
                                    <a
                                    href="https://github.com/kaityo256/classical_mechanics">[Repository]</a></p>
                                    <h1
                                    id="本章で学ぶこと">本章で学ぶこと</h1>
                                    <p>ニュートン力学では、ニュートンの運動方程式が出発点であり、「その運動方程式はどこから来たか」に答えることができなかった。しかし、解析力学では、最小作用の原理から運動方程式を導く。これにより、運動方程式よりも一歩引いた立場から運動を記述、理解できるようになる。最小作用の原理は、変分原理と呼ばれるものの一種である。以下では、変分原理の例として最速降下曲線を挙げ、汎関数微分を導入する。解析力学は変分原理に立脚しており、その変分原理の心臓部分が関数の微分を含む汎関数の微分であるため、ここが解析力学で最も重要なパートである。</p>
                                    <h1 id="変分問題">変分問題</h1>
                                    <p>我々は、何らかの制約のなかで、何かを最小化したり最大化したりしたいことがよくある。例えばレストランでご飯を注文する際、許される予算、およびカロリー上限の中で、もっとも食べたいものを選ぶであろう。このような問題を最適化問題と呼ぶ。最適化問題には様々なものがあるが、その中に選べる選択肢が連続的な場合がある。山を登る時、山の入口から山頂まで様々な道がある。傾きがきつい道ほど疲れやすいが登山時間は短くて済み、傾きが緩い道は楽だが登山時間が長くなる。この時、もっとも疲れずに登るためのルートはどのように決めれば良いか、といった問題が典型例である。この時、我々は「疲労度」という実数値を最小化するように「登山ルート」という連続的な経路を決める必要がある。このように連続的な自由度についての最適化問題を変分問題、変分問題を解く方法を変分法と呼ぶ。以下では、変分問題とその解法について説明する。以下、ややこしい計算を実施するが、計算の詳細は気にしなくて良い。</p>
                                    <h2
                                    id="スネルの法則">スネルの法則</h2>
                                    <figure>
                                    <img src="fig/snell.png"
                                    alt="スネルの法則" />
                                    <figcaption
                                    aria-hidden="true">スネルの法則</figcaption>
                                    </figure>
                                    <p>まずは簡単な例からはじめよう。A地点からB地点まで行きたいとする。ただし、A地点付近は草原で歩きやすく、B地点は歩きにくい沼地の中にある。草原と沼地が直線で接している時、A地点からB地点まで最短で到達できる経路はどのようになるだろうか？</p>
                                    <p>草原の中、沼地の中など、歩きやすさが同じところでは、経路は直線となるであろう。従って、草原と沼地の境界にX地点をとり、その最適な場所を探すことを考える。なるべく草原を多く歩いたほうが得なのでAXを長くとりたいが、AXを長く取りすぎると全体としての経路が伸びてしまうために時間もかかる。どこかにちょうどよい点があるはずである。</p>
                                    <p>この問題を考えるため、直線AXの長さを<span
                                    class="math inline">\(l_A\)</span>、XBの長さを<span
                                    class="math inline">\(l_B\)</span>とする。草原を歩く時の速度を<span
                                    class="math inline">\(v_A\)</span>、沼地を歩く時の速度を<span
                                    class="math inline">\(v_B\)</span>とする(<span
                                    class="math inline">\(v_A&gt;v_B\)</span>)。A地点からX地点までの水平方向の距離を<span
                                    class="math inline">\(x\)</span>とすると、X地点からB地点までの水平方向の距離は<span
                                    class="math inline">\(L-x\)</span>となる。また、A地点、B地点から境界までの最短距離をそれぞれ<span
                                    class="math inline">\(h_A\)</span>、<span
                                    class="math inline">\(h_B\)</span>としよう。</p>
                                    <p>全体を歩くのにかかる時間<span
                                    class="math inline">\(T(x)\)</span>は、</p>
                                    <p><span class="math display">\[
                                    T(x) = \frac{l_A}{v_A} +
                                    \frac{l_B}{v_B}
                                    \]</span></p>
                                    <p>ただし、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    l_A(x) &amp;= \sqrt{h_A^2 + x^2} \\
                                    l_B(x) &amp;= \sqrt{h_B^2 + (L-x)^2}
                                    \\
                                    \end{aligned}
                                    \]</span></p>
                                    <p><span
                                    class="math inline">\(T(x)\)</span>を最小化する<span
                                    class="math inline">\(x\)</span>は<span
                                    class="math inline">\(T&#39;(x) =
                                    0\)</span>を満たすはずであるから、</p>
                                    <p><span class="math display">\[
                                    T&#39;(x) = \frac{l_A&#39;}{v_A} +
                                    \frac{l_B&#39;}{v_B} = 0
                                    \]</span></p>
                                    <p>ここで</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    l_A&#39;(x) &amp;=
                                    \frac{x}{\sqrt{h_A^2 + x^2}} =
                                    \frac{x}{l_A} \\
                                    l_B&#39;(x) &amp;=
                                    \frac{-(L-x)}{\sqrt{h_B^2 +
                                    (L-x)^2}} = -\frac{L-x}{l_B}\\
                                    \end{aligned}
                                    \]</span></p>
                                    <p>である。境界の法線に対して直線AX、XBのなす角をそれぞれ<span
                                    class="math inline">\(\theta_A\)</span>、<span
                                    class="math inline">\(\theta_B\)</span>とすると、三角関数の定義から、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \sin \theta_A &amp;= \frac{x}{l_A}
                                    \\
                                    \sin \theta_B &amp;= \frac{L-x}{l_B}
                                    \\
                                    \end{aligned}
                                    \]</span></p>
                                    <p>従って、</p>
                                    <p><span class="math display">\[
                                    T&#39;(x) = \frac{\sin
                                    \theta_A}{v_A} - \frac{\sin
                                    \theta_B}{v_B} = 0
                                    \]</span></p>
                                    <p>以上から、</p>
                                    <p><span class="math display">\[
                                    \frac{\sin \theta_A}{v_A} =
                                    \frac{\sin \theta_B}{v_B}
                                    \]</span></p>
                                    <p>これは、光線が平面に入射した場合、入射角と出射角(屈折角)と、その媒質中における光速との関係を表すスネルの法則にほかならない。</p>
                                    <figure>
                                    <img src="fig/huygens.png"
                                    alt="ホイヘンスの原理" />
                                    <figcaption
                                    aria-hidden="true">ホイヘンスの原理</figcaption>
                                    </figure>
                                    <p>スネルの法則は、ホイヘンスの原理によっても説明できる。ホイヘンスの原理は、波の波面から二次波とよばれる新しい波が生じ、それらが強めあうところが次の波面となる、というもので、こちらは局所的かつ逐次的な立場から屈折を説明する。</p>
                                    <p>一方、我々が求めたのは、「始点と終点が指定されている時、最も到達時間が短くなる経路」であり、大域的に問題を捉えている。光の場合、到達時間ではなく光路長を考えるのが一般的である。媒質中の光は真空中よりも速度が遅くなる。そこで、真空中での光速を媒質中の光速で割ったものを、その媒質の屈折率と呼ぶ。真空中での光速を<span
                                    class="math inline">\(c\)</span>とすると、屈折率<span
                                    class="math inline">\(n_A\)</span>を持つ媒質Aの中での速度<span
                                    class="math inline">\(v_A\)</span>は、屈折率の定義から</p>
                                    <p><span class="math display">\[
                                    v_A = \frac{c}{n_A}
                                    \]</span></p>
                                    <p>となる。これを用いると、A地点からB地点への光の到達時間<span
                                    class="math inline">\(T\)</span>は</p>
                                    <p><span class="math display">\[
                                    T = \frac{n_A l_A + n_B l_B}{c}
                                    \]</span></p>
                                    <p>となる。すなわち、実際の長さ<span
                                    class="math inline">\(l_A\)</span>に対して、光が感じる実効的な長さは<span
                                    class="math inline">\(n_A
                                    l_A\)</span>となっている。屈折率が大きい媒質であるほど光の速度は遅くなるため、光にとってその媒質は「進みにくい」物質となる。つまり、屈折率が大きいほど、光は実際の長さよりも長く感じることになる。この、実際の長さに屈折率をかけたものを光路長と呼び、光は光路長の総和を最小(停留)にするような経路を進む。これをフェルマーの原理と呼ぶ。</p>
                                    <p>もちろん光には意思はないため、異なる媒質に入射する前に「なるべく光路長を短くする経路を選ぼう」などとは思っていない。しかし、最終的に光が通った経路を見ると、それは始点と終点を決めた時に、もっとも光路長が短くなるように選ばれている。これを原理として採用し、何かの総和が最も小さくなるように運動の経路が決まると主張するのが
                                    <strong>変分原理</strong>(variational
                                    principle)
                                    である。フェルマーの原理は変分原理の一種である。</p>
                                    <p>ホイヘンスの原理が、ある瞬間の光の振る舞いに着目し、次の瞬間の光の位置を逐次的に決めていく、いわば局所的な原理であるのに対して、フェルマーの原理は全体を見渡し、光の経路を一度に決めてしまう大域的な原理である。このように、変分原理は全体を俯瞰する立場から振る舞いを決定する見方を与える。</p>
                                    <h2
                                    id="最速降下曲線">最速降下曲線</h2>
                                    <p>変分原理の有名な例として、最速降下曲線を考えよう。斜面に質点をそっと置いて離し、重力により滑らせる。ただし、摩擦は無視できるものとする。質点は斜面から離れることなく、なめらかに滑るとしよう。スタート地点とゴール地点を固定する時、もっとも早くゴールするような斜面はどのような形状であるか求めよ、というものが最速降下曲線の問題である。この問題はベルヌーイが解いて、数学者への挑戦という形で出題された。しばらく誰も解くことができなかったが、ニュートンがこれを一晩で解いて返送し、ベルヌーイが悔しがった、というのは有名な話である。</p>
                                    <figure>
                                    <img src="fig/bc_coordinate.png"
                                    alt="最速降下曲線の座標軸" />
                                    <figcaption
                                    aria-hidden="true">最速降下曲線の座標軸</figcaption>
                                    </figure>
                                    <p>問題を解くため、まず座標軸を設定しよう。質点を置く場所を原点にとる。最速降下曲線は下に落下していく問題だが、重力の働く方向を<span
                                    class="math inline">\(y\)</span>軸の正の向きにとる。</p>
                                    <p>さて、最速降下「曲線」というくらいだから答えは曲線となるのだが、これを折れ線で近似しよう。</p>
                                    <figure>
                                    <img src="fig/bc_snell.png"
                                    alt="折れ線近似とスネルの法則" />
                                    <figcaption
                                    aria-hidden="true">折れ線近似とスネルの法則</figcaption>
                                    </figure>
                                    <p>運動の始点を原点にとり、終点を<span
                                    class="math inline">\((L,
                                    H)\)</span>の場所に取ろう。<span
                                    class="math inline">\(L\)</span>を<span
                                    class="math inline">\(N\)</span>等分し、左から<span
                                    class="math inline">\(k\)</span>番目の場所を<span
                                    class="math inline">\(x_k\)</span>とする。位置<span
                                    class="math inline">\(x_k\)</span>から<span
                                    class="math inline">\(x_{k+1}\)</span>までは速度が一定であると近似し、その速度を<span
                                    class="math inline">\(v_k\)</span>としよう。</p>
                                    <p>位置<span
                                    class="math inline">\(x_k\)</span>における斜面の位置を<span
                                    class="math inline">\(y_k\)</span>とすると、エネルギー保存則より</p>
                                    <p><span class="math display">\[
                                    \frac{1}{2} m{v_k}^2 = mgy_k
                                    \]</span></p>
                                    <p>が成り立つ。従って、</p>
                                    <p><span class="math display">\[
                                    v(x_k) = \sqrt{2gy_k}
                                    \]</span></p>
                                    <p>また、位置<span
                                    class="math inline">\(x_k\)</span>から<span
                                    class="math inline">\(x+\Delta
                                    x\)</span>における曲線の長さ<span
                                    class="math inline">\(l(x_k)\)</span>は</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    l(x_k) &amp;=\sqrt{\Delta x^2 +
                                    (y_{k+1} - y_k)^2} \\
                                    &amp;\sim \Delta x \sqrt{1 +
                                    (y&#39;_k)^2} \\
                                    \end{aligned}
                                    \]</span></p>
                                    <p>ただし、<span
                                    class="math inline">\(y_{k+1} - y_k
                                    = y(x_k+\Delta x) - y(x_k) =
                                    y&#39;_k \Delta x + O(\Delta
                                    x^2)\)</span>を用いた。</p>
                                    <p>かかる時間の総和は</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    T &amp;= \sum_{k=0}^{N-1}
                                    \frac{l(x_k)}{v(x_k)} \\
                                    &amp;= \sum_{k=0}^{N-1}\frac{\sqrt{1
                                    + (y&#39;_k)^2}}{\sqrt{2gy_k}}
                                    \Delta x
                                    \end{aligned}
                                    \]</span></p>
                                    <p>であるから、<span
                                    class="math inline">\(L =
                                    N\Delta\)</span>を固定したまま<span
                                    class="math inline">\(N\rightarrow
                                    \infty\)</span>として連続極限をとると</p>
                                    <p><span class="math display">\[
                                    T= \int_0^L
                                    \frac{\sqrt{1+y&#39;^2}}{\sqrt{2gy}}
                                    dx
                                    \]</span></p>
                                    <p>関数<span
                                    class="math inline">\(y(x)\)</span>は、スカラー量を入力とし、スカラー量を返すものであった。先程の<span
                                    class="math inline">\(T\)</span>は関数<span
                                    class="math inline">\(y(x)\)</span>を入力とし、出力としてスカラー量が決まるため、「関数の関数」とみなすことができる。それを表現して<span
                                    class="math inline">\(T[y]\)</span>と書くことがある。適当な境界条件のもとで<span
                                    class="math inline">\(T[y]\)</span>を最小とするような関数<span
                                    class="math inline">\(y(x)\)</span>を見つけよ、というのが最速降下曲線問題である。</p>
                                    <p>この問題を、汎関数微分を用いて解くというのが本章の目的だが、まずは幾何学的な考察で解いてみよう。曲線を折れ線で近似した状態を考える。<span
                                    class="math inline">\(x_{k-1}\)</span>から<span
                                    class="math inline">\(x_k\)</span>までの領域の速度は<span
                                    class="math inline">\(v_{k-1}\)</span>であり、<span
                                    class="math inline">\(x_k\)</span>から<span
                                    class="math inline">\(x_{k+1}\)</span>までの速度が<span
                                    class="math inline">\(v_k\)</span>であるから、入射角<span
                                    class="math inline">\(\theta_{k-1}\)</span>と出射角<span
                                    class="math inline">\(\theta_k\)</span>を定義するとスネルの法則と同じ議論により</p>
                                    <p><span class="math display">\[
                                    \frac{\sin \theta_{k-1}}{v_{k-1}} =
                                    \frac{\sin \theta_k}{v_k}
                                    \]</span></p>
                                    <p>連続極限をとると、</p>
                                    <p><span class="math display">\[
                                    \frac{\sin \theta}{v} = C
                                    \]</span></p>
                                    <p>が場所に依らず成り立つ。ただし<span
                                    class="math inline">\(C\)</span>は定数である。エネルギー保存則から</p>
                                    <p><span class="math display">\[
                                    v = \sqrt{2g y}
                                    \]</span></p>
                                    <p>であったから、</p>
                                    <p><span class="math display">\[
                                    2gC^2 y = \sin^2 \theta
                                    \]</span></p>
                                    <p>である。あとの便利のために<span
                                    class="math inline">\(2gC^2 =
                                    1/2a\)</span>とすると</p>
                                    <p><span class="math display">\[
                                    y = 2a \sin^2 \theta
                                    \]</span></p>
                                    <p>である。両辺<span
                                    class="math inline">\(\theta\)</span>で微分すると</p>
                                    <p><span class="math display">\[
                                    \frac{dy}{d\theta} = 4 a \sin \theta
                                    \cos \theta
                                    \]</span></p>
                                    <p>となる。また、傾きと三角関数の定義から</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{dy}{dx} &amp;=
                                    \tan\left(\frac{\pi}{2} - \theta
                                    \right) \\
                                    &amp;= \frac{\cos \theta}{\sin
                                    \theta}
                                    \end{aligned}
                                    \]</span></p>
                                    <p>ここから<span
                                    class="math inline">\(x\)</span>を<span
                                    class="math inline">\(\theta\)</span>の関数として求めよう。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{dx}{d\theta} &amp;=
                                    \frac{dx}{dy} \frac{dy}{d\theta} \\
                                    &amp;=\frac{\sin
                                    \theta}{\cos\theta}\left( 4 a \sin
                                    \theta \cos \theta\right) \\
                                    &amp;= 4 a \sin^2 \theta \\
                                    &amp;= 2 a (1 - \cos 2\theta)
                                    \end{aligned}
                                    \]</span></p>
                                    <p>両辺を<span
                                    class="math inline">\(\theta\)</span>で積分すると</p>
                                    <p><span class="math display">\[
                                    x = 2 a \left(\theta - \frac{1}{2}
                                    \sin \theta \right)
                                    \]</span></p>
                                    <p><span class="math display">\[
                                    y = 2a \sin^2 \theta = a (1 - \cos 2
                                    \theta)
                                    \]</span></p>
                                    <p>であったから、<span
                                    class="math inline">\(s =
                                    2\theta\)</span>とすると</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    x &amp;= a (s - \sin s) \\
                                    y &amp;= a (1 - \cos s)
                                    \end{aligned}
                                    \]</span></p>
                                    <p>これはサイクロイド曲線を表現している。</p>
                                    <h1 id="汎関数微分">汎関数微分</h1>
                                    <p>先程、最速降下曲線の問題を、スネルの法則を援用して幾何学的な考察で解いた。このような問題を一般的に扱うのが変分法である。変分法の説明のため、まず汎関数微分の導入を行う。</p>
                                    <p>ある関数<span
                                    class="math inline">\(f(x)\)</span>を考える。引数である<span
                                    class="math inline">\(x\)</span>は複素数でもベクトルでもよいが、簡単のためスカラーで実数であるものとする。関数<span
                                    class="math inline">\(f(x)\)</span>とは、実数<span
                                    class="math inline">\(x\)</span>を入力すると、対応する実数<span
                                    class="math inline">\(f(x)\)</span>を返してくれるものだ。すなわち、実数に実数を対応付ける写像になっている。一方、関数に実数を対応づける写像を
                                    <strong>汎関数</strong>(functional)
                                    と呼ぶ。様々な汎関数があり得るが、力学においては以下のような定積分として現れる。</p>
                                    <p><span class="math display">\[
                                    I[f] = \int_a^b f(x) dx
                                    \]</span></p>
                                    <p>積分範囲 <span
                                    class="math inline">\((a,b)\)</span>
                                    を固定すると、<span
                                    class="math inline">\(F\)</span>は関数に実数を対応付けるため汎関数になっていることがわかる。例えば引数として<span
                                    class="math inline">\(f(x) =
                                    x\)</span>を代入すると</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    I[x] &amp;= \int_a^b x dx\\
                                    &amp;=
                                    \left[\frac{x^2}{2}\right]_a^b\\
                                    &amp;= \frac{b^2-a^2}{2}
                                    \end{aligned}
                                    \]</span></p>
                                    <p>となるし、<span
                                    class="math inline">\(f(x) =
                                    \exp(x)\)</span>とすると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    I[\exp(x)] &amp;= \int_a^b
                                    \mathrm{e}^x dx\\
                                    &amp;= \left[ \mathrm{e}^x
                                    \right]_a^b \\
                                    &amp;= \mathrm{e}^b - \mathrm{e}^a
                                    \end{aligned}
                                    \]</span></p>
                                    <p>となる。このように汎関数とは、何かしら関数を放り込むと、対応する実数を返してくれるものである。</p>
                                    <p>さて、関数では、引数である実数が変化すると値が変化するのであった。汎関数では、関数の形が変わると値が変わる。関数の形がほんの少しだけ変化したとき、値がどのように変化するかを調べるのが汎関数微分である。</p>
                                    <p>まず、通常の微分について考えよう。関数<span
                                    class="math inline">\(f(x)\)</span>が、微小量<span
                                    class="math inline">\(\varepsilon\)</span>を用いて</p>
                                    <p><span class="math display">\[
                                    f(x+\varepsilon) = f(x) +
                                    \frac{df}{dx} \varepsilon +
                                    O(\varepsilon^2)
                                    \]</span></p>
                                    <p>のように表すことができる時、<span
                                    class="math inline">\(df/dx\)</span>を<span
                                    class="math inline">\(f(x)\)</span>の微分と呼ぶのであった。</p>
                                    <p>同様に、汎関数の微分について考えよう。関数<span
                                    class="math inline">\(f(x)\)</span>に対して、何か適当な関数<span
                                    class="math inline">\(\phi(x)\)</span>を考える。ただし関数<span
                                    class="math inline">\(\phi(x)\)</span>は、積分の端点でゼロ、すなわち<span
                                    class="math inline">\(\phi(a) =
                                    \phi(b) =
                                    0\)</span>を満たすように選ぶ。その理由は後に説明する。<span
                                    class="math inline">\(\varepsilon\)</span>を微小量として</p>
                                    <p><span class="math display">\[
                                    I[f+\varepsilon \phi] = I[f]
                                    +  \varepsilon \int_a^b \frac{\delta
                                    I}{\delta f}  \phi(x) dx  +
                                    O(\varepsilon^2)
                                    \]</span></p>
                                    <p>と表せる時、<span
                                    class="math inline">\(\delta
                                    I/\delta f\)</span>を、<span
                                    class="math inline">\(I\)</span>の
                                    <strong>汎関数微分</strong>(functional
                                    derivative)
                                    、もしくは第一変分と呼ぶ。</p>
                                    <p>解析力学では、汎関数の積分の中に関数の関数、すなわち合成関数が入ることが多い。そこで、以下のような式を考える。</p>
                                    <p><span class="math display">\[
                                    I[f] = \int_a^b F(f(x)) dx
                                    \]</span></p>
                                    <p><span
                                    class="math inline">\(F(x)\)</span>は普通の関数である。例えば
                                    <span class="math inline">\(F(x) =
                                    x^2\)</span>であるならば、<span
                                    class="math inline">\(I[f]\)</span>は、「関数<span
                                    class="math inline">\(f(x)\)</span>の自乗を<span
                                    class="math inline">\(a &lt; x &lt;
                                    b\)</span>で積分した値を返しなさい」という意味になる。ここで、関数
                                    <span
                                    class="math inline">\(f(x)\)</span>を微小量<span
                                    class="math inline">\(\varepsilon\)</span>
                                    を用いて <span
                                    class="math inline">\(f(x) +
                                    \varepsilon
                                    \phi(x)\)</span>と変化させた時、<span
                                    class="math inline">\(I\)</span>がどのように変化するか見てみよう。</p>
                                    <p><span class="math display">\[
                                    I[f + \varepsilon \phi] = \int_a^b
                                    F(f(x)+ \varepsilon \phi(x) ) dx
                                    \]</span></p>
                                    <p>ここで、ある<span
                                    class="math inline">\(x\)</span>を固定すると、<span
                                    class="math inline">\(f(x)\)</span>や<span
                                    class="math inline">\(\phi(x)\)</span>は単なる値になるから
                                    <span
                                    class="math inline">\(\varepsilon
                                    \phi(x)\)</span>をまとめて微小量とみなして良い。そこで</p>
                                    <p><span class="math display">\[
                                    F(f(x) + \varepsilon \phi(x)) =
                                    F(f(x)) + F&#39;(f(x)) \varepsilon
                                    \phi(x) + O(\varepsilon^2)
                                    \]</span></p>
                                    <p>とできる。元の積分に代入すると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    I[f + \varepsilon \phi] &amp;=
                                    \int_a^b F(f(x)+ \varepsilon \phi(x)
                                    ) dx \\
                                    &amp;= \underbrace{\int_a^b F[f(x)]
                                    dx}_{I[f]} + \varepsilon \int_a^b
                                    F&#39;[f(x)]\phi(x) dx
                                    +O(\varepsilon^2) \\
                                    &amp;= I[f] + \varepsilon \int_a^b
                                    F&#39;[f(x)]\phi(x) dx
                                    +O(\varepsilon^2)
                                    \end{aligned}
                                    \]</span></p>
                                    <p>汎関数微分の定義から、</p>
                                    <p><span class="math display">\[
                                    \frac{\delta I}{\delta f} =
                                    F&#39;[f(x)]
                                    \]</span></p>
                                    <p>となる。<span
                                    class="math inline">\(\varepsilon
                                    \phi(x)\)</span>を、改めて <span
                                    class="math inline">\(\delta
                                    f(x)\)</span>と表記しよう。ここで、これは<span
                                    class="math inline">\(\delta\)</span>と<span
                                    class="math inline">\(f(x)\)</span>の積ではなく、<span
                                    class="math inline">\(\delta
                                    f\)</span>という一つの関数であることに注意。すると、</p>
                                    <p><span class="math display">\[
                                    \underbrace{I[f + \delta f]  -
                                    I[f]}_{\delta I} = \int_a^b
                                    F&#39;[f(x)]\delta f dx +
                                    O(\varepsilon^2)
                                    \]</span></p>
                                    <p>ここで左辺を<span
                                    class="math inline">\(\delta
                                    I\)</span>と書いて、<span
                                    class="math inline">\(\varepsilon^2\)</span>のオーダーの項を無視すると、以下のように表記できる。</p>
                                    <p><span class="math display">\[
                                    \delta I = \int_a^b
                                    F&#39;[f(x)]\delta f dx
                                    \]</span></p>
                                    <p>これは、関数の全微分</p>
                                    <p><span class="math display">\[
                                    df = f&#39; dx
                                    \]</span></p>
                                    <p>の汎関数版である。要するに汎関数微分とは、積分の中の合成関数<span
                                    class="math inline">\(F[f]\)</span>を、<span
                                    class="math inline">\(f\)</span>を変数とみなして微分しろ、ということに過ぎない。</p>
                                    <p>さて、解析力学では汎関数の中の積分の合成関数<span
                                    class="math inline">\(F\)</span>が、関数<span
                                    class="math inline">\(f(x)\)</span>と、その微分<span
                                    class="math inline">\(f&#39;(x)\)</span>に依存することが多い。すなわち、</p>
                                    <p><span class="math display">\[
                                    I[f] = \int_a^b F(f(x), f&#39;(x))
                                    dx
                                    \]</span></p>
                                    <p>という形を考えることが多い。なぜなら、力学は位置と速度で表現されており、速度は位置の時間微分であるためだ(現在の議論における変数<span
                                    class="math inline">\(x\)</span>が、力学では時間<span
                                    class="math inline">\(t\)</span>にあたることに注意)。このような場合に汎関数微分がどうなるかを見ておこう。</p>
                                    <p>まず、二変数関数<span
                                    class="math inline">\(F(f,g)\)</span>を考える。関数$Fの全微分は</p>
                                    <p><span class="math display">\[
                                    dF = \frac{\partial F}{\partial f}
                                    df +\frac{\partial F}{\partial g} dg
                                    \]</span></p>
                                    <p>で与えられる。</p>
                                    <p>さて、この引数<span
                                    class="math inline">\(f\)</span>、<span
                                    class="math inline">\(g\)</span>がそれぞれ<span
                                    class="math inline">\(x\)</span>の関数であるとしよう。この関数<span
                                    class="math inline">\(F\)</span>を<span
                                    class="math inline">\(a &lt; x &lt;
                                    b\)</span>の範囲で積分した量を<span
                                    class="math inline">\(I\)</span>とすると</p>
                                    <p><span class="math display">\[
                                    I = \int_a^b F(f(x), g(x)) dx
                                    \]</span></p>
                                    <p>である。ここで、汎関数微分を行おう。<span
                                    class="math inline">\(f \rightarrow
                                    f + \delta f\)</span>、<span
                                    class="math inline">\(g \rightarrow
                                    g + \delta
                                    g\)</span>と変化した時、<span
                                    class="math inline">\(I \rightarrow
                                    I + \delta
                                    I\)</span>と変化したならば、</p>
                                    <p><span class="math display">\[
                                    \delta I = \int_a^b
                                    \left(\frac{\partial F}{\partial f}
                                    \delta f(x) +  \frac{\partial
                                    F}{\partial g} \delta g(x)   \right)
                                    dx
                                    \]</span></p>
                                    <p>ここまでは、二変数関数<span
                                    class="math inline">\(F(f,
                                    g)\)</span>における汎関数微分の一般論である。さて、ここで<span
                                    class="math inline">\(f\)</span>と<span
                                    class="math inline">\(g\)</span>が常に</p>
                                    <p><span class="math display">\[
                                    \frac{d f}{dx} = g
                                    \]</span></p>
                                    <p>という関係を満たすことを要請しよう。この関係を満たしつつ、<span
                                    class="math inline">\(f \rightarrow
                                    f + \delta
                                    f\)</span>と変化し、その結果<span
                                    class="math inline">\(g \rightarrow
                                    g + \delta
                                    g\)</span>と変化したとする。ただし、それぞれ積分範囲の端点でゼロ、すなわち<span
                                    class="math inline">\(\delta f(a)
                                    =\delta f(b) = \delta g(a) = \delta
                                    g(b)=0\)</span>を満たすように変化させる。変化後も微分の関係を満たさなければならないのだから、</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dx} (f + \delta f) = g +
                                    \delta g
                                    \]</span></p>
                                    <p>もともと<span
                                    class="math inline">\(g(x) =
                                    f&#39;(x)\)</span>であったから、両辺から引くと</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dx} (\delta f) = \delta g
                                    \]</span></p>
                                    <p>となる。これを先程の汎関数微分の式に代入すると</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \delta I &amp;= \int_a^b
                                    \left(\frac{\partial F}{\partial f}
                                    \delta f +  \frac{\partial
                                    F}{\partial g} \frac{d}{dx}(\delta
                                    f)   \right) dx \\
                                    &amp;= \int_a^b \frac{\partial
                                    F}{\partial f} \delta f dx +
                                    \left[\frac{\partial F}{\partial g}
                                    \delta f \right]_a^b - \int_a^b
                                    \frac{d}{dx}\left(\frac{\partial
                                    F}{\partial g}\right) \delta f dx\\
                                    &amp;= \int_a^b \left(
                                    \frac{\partial F}{\partial f} -
                                    \frac{d}{dx} \left(\frac{\partial
                                    F}{\partial g} \right)\right) \delta
                                    f dx
                                    \end{aligned}
                                    \]</span></p>
                                    <p>最後に、<span
                                    class="math inline">\(g=f&#39;\)</span>であるから、<span
                                    class="math inline">\(g\)</span>での偏微分を<span
                                    class="math inline">\(f&#39;\)</span>での偏微分で表すと</p>
                                    <p><span class="math display">\[
                                    \delta I = \int_a^b \left(
                                    \frac{\partial F}{\partial f} -
                                    \frac{d}{dx} \left(\frac{\partial
                                    F}{\partial f&#39;} \right)\right)
                                    \delta f dx
                                    \]</span></p>
                                    <p>これが、関数と関数の導関数に依存する汎関数</p>
                                    <p><span class="math display">\[
                                    I[f] = \int_a^b F(f(x), f&#39;(x))
                                    dx
                                    \]</span></p>
                                    <p>の汎関数微分となる。汎関数微分の定義は</p>
                                    <p><span class="math display">\[
                                    \delta I \equiv I[f+\delta f]
                                    -I[f]  = \int_a^b \frac{\delta
                                    F}{\delta f}  \delta f dx  +
                                    O(\delta f^2)
                                    \]</span></p>
                                    <p>であったから、</p>
                                    <p><span class="math display">\[
                                    \frac{\delta F}{\delta f} =
                                    \frac{\partial F}{\partial f} -
                                    \frac{d}{dx} \left(\frac{\partial
                                    F}{\partial f&#39;} \right)
                                    \]</span></p>
                                    <p>である。形式的に分母を払った</p>
                                    <p><span class="math display">\[
                                    \delta F = \left(\frac{\partial
                                    F}{\partial f} - \frac{d}{dx}
                                    \left(\frac{\partial F}{\partial
                                    f&#39;} \right)\right) \delta f
                                    \]</span></p>
                                    <p>という形で書くことも多い。</p>
                                    <h1 id="変分法">変分法</h1>
                                    <h2
                                    id="最速降下曲線-1">最速降下曲線</h2>
                                    <p>汎関数微分の導入が終わったので、これを用いて最速降下曲線の問題をもう一度考えよう。我々は、関数<span
                                    class="math inline">\(y(x)\)</span>を与えると、通過時間<span
                                    class="math inline">\(T\)</span>を与える以下の関係式を得たのであった。</p>
                                    <p><span class="math display">\[
                                    T[y] = \int_0^L
                                    \frac{\sqrt{1+y&#39;^2}}{\sqrt{2gy}}
                                    dx
                                    \]</span></p>
                                    <p>積分の中身を、<span
                                    class="math inline">\(y(x)\)</span>と<span
                                    class="math inline">\(y&#39;(x)\)</span>の関数<span
                                    class="math inline">\(F(y,
                                    y&#39;)\)</span>とみなすと、</p>
                                    <p><span class="math display">\[
                                    T[y] = \int_0^L F(y,y&#39;) dx
                                    \]</span></p>
                                    <p>と書くことができる。この時、</p>
                                    <p><span class="math display">\[
                                    F(y,y&#39;) =
                                    \frac{\sqrt{1+y&#39;^2}}{\sqrt{2gy}}
                                    \]</span></p>
                                    <p>である。</p>
                                    <p>この<span
                                    class="math inline">\(T\)</span>を最小化するような<span
                                    class="math inline">\(y(x)\)</span>を求めなさい、というのが変分問題である。いま、<span
                                    class="math inline">\(T\)</span>を最小にするような<span
                                    class="math inline">\(y(x)\)</span>が選ばれたとしよう。すると、そこからどのように<span
                                    class="math inline">\(y(x)\)</span>を変化させても、<span
                                    class="math inline">\(T\)</span>は増えるはずだ。すなわち、<span
                                    class="math inline">\(y \rightarrow
                                    y + \delta
                                    y\)</span>という変化に対して、<span
                                    class="math inline">\(T \rightarrow
                                    T+ \delta
                                    T\)</span>と変化するなら、</p>
                                    <p><span class="math display">\[
                                    \delta T = \int_0^a \frac{\delta
                                    F}{\delta y} \delta y dx  + O(\delta
                                    y^2)
                                    \]</span></p>
                                    <p>どのような<span
                                    class="math inline">\(\delta
                                    y\)</span>に対しても一次のオーダーで<span
                                    class="math inline">\(T\)</span>が変わらない、すなわち<span
                                    class="math inline">\(\delta T
                                    =0\)</span>になるのであるから、</p>
                                    <p><span class="math display">\[
                                    \frac{\delta F}{\delta y} = 0
                                    \]</span></p>
                                    <p>が成り立たなければならない。<span
                                    class="math inline">\(F\)</span>が<span
                                    class="math inline">\(y\)</span>と<span
                                    class="math inline">\(y&#39;\)</span>の関数である時、</p>
                                    <p><span class="math display">\[
                                    \frac{\delta F}{\delta y} \equiv
                                    \frac{\partial F}{\partial y} -
                                    \frac{d}{dx} \left(\frac{\partial
                                    F}{\partial y&#39;} \right)
                                    \]</span></p>
                                    <p>が成り立つのであるから、<span
                                    class="math inline">\(F(y,y&#39;) =
                                    \sqrt{1+y&#39;^2}/\sqrt{2gy}\)</span>
                                    を代入して整理すると、<span
                                    class="math inline">\(y\)</span>が満たすべき微分方程式が得られる。</p>
                                    <p>ここで、計算の便利のためにベルトラミの公式を導出しておこう。<span
                                    class="math inline">\(f(x)\)</span>および<span
                                    class="math inline">\(f&#39;(x)\)</span>に依存する関数<span
                                    class="math inline">\(F(f,f&#39;)\)</span>がオイラー・ラグランジュの方程式</p>
                                    <p><span class="math display">\[
                                    \frac{d}{dt}\left(\frac{\partial
                                    F}{\partial f&#39;}\right) -
                                    \frac{\partial F}{\partial f} = 0
                                    \]</span></p>
                                    <p>を満たし、かつ<span
                                    class="math inline">\(F\)</span>が<span
                                    class="math inline">\(x\)</span>に陽に依存しない、すなわち</p>
                                    <p><span class="math display">\[
                                    \frac{\partial F}{\partial x} = 0
                                    \]</span></p>
                                    <p>が成り立つとき、以下の量の<span
                                    class="math inline">\(x\)</span>微分がゼロとなる。</p>
                                    <p><span class="math display">\[
                                    B = F - f&#39; \frac{\partial
                                    F}{\partial f&#39;}
                                    \]</span></p>
                                    <p>証明は簡単で、<span
                                    class="math inline">\(dB/dx\)</span>を計算すれば良い。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{dB}{dx} &amp;= \frac{\partial
                                    F}{\partial f} f&#39;
                                    +  \frac{\partial F}{\partial
                                    f&#39;} f&#39;&#39; - f&#39;&#39;
                                    \frac{\partial F}{\partial f&#39;} -
                                    f&#39;
                                    \underbrace{\frac{d}{dx}\left(\frac{\partial
                                    F}{\partial f&#39;}
                                    \right)}_{=\partial x F} \\
                                    &amp;= \frac{\partial F}{\partial f}
                                    f&#39; +  \frac{\partial F}{\partial
                                    f&#39;} f&#39;&#39; - f&#39;&#39;
                                    \frac{\partial F}{\partial f&#39;} -
                                    f&#39; \frac{\partial F}{\partial x}
                                    \\
                                    &amp;= 0
                                    \end{aligned}
                                    \]</span></p>
                                    <p>すなわち、ある定数<span
                                    class="math inline">\(C\)</span>を用いて<span
                                    class="math inline">\(B(f,f&#39;)=C\)</span>と表現できる。</p>
                                    <p>これを先程の<span
                                    class="math inline">\(F(y,y&#39;) =
                                    \sqrt{1+y&#39;^2}/\sqrt{2gy}\)</span>に適用すると、ある定数<span
                                    class="math inline">\(C\)</span>を用いて</p>
                                    <p><span class="math display">\[
                                    F - y&#39; \frac{\partial
                                    F}{\partial y&#39;} = C
                                    \]</span></p>
                                    <p>が成り立つから、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    F - y&#39; \frac{\partial
                                    F}{\partial y&#39;} &amp;=
                                    \frac{\sqrt{1+y&#39;^2}}{\sqrt{2gy}}
                                    -
                                    \frac{y&#39;^2}{\sqrt{2gy}\sqrt{1+y&#39;^2}}
                                    \\
                                    &amp;=
                                    \frac{1}{\sqrt{2gy}\sqrt{1+y&#39;^2}}
                                    \\
                                    &amp;= C
                                    \end{aligned}
                                    \]</span></p>
                                    <p><span
                                    class="math inline">\(y&#39;\)</span>について整理すると、</p>
                                    <p><span class="math display">\[
                                    y&#39; =　\sqrt{\frac{1
                                    -2gC^2y}{2gC^2y}}
                                    \]</span></p>
                                    <p><span class="math inline">\(2gC^2
                                    =
                                    1/2a\)</span>とすると、以下の微分方程式を得る。</p>
                                    <p><span class="math display">\[
                                    \frac{dy}{dx} = -\sqrt{\frac{2a -
                                    y}{y}}
                                    \]</span></p>
                                    <p>これと、角度の定義</p>
                                    <p><span class="math display">\[
                                    \frac{dy}{dx} = \frac{\cos
                                    \theta}{\sin \theta}
                                    \]</span></p>
                                    <p>を合わせると、<span
                                    class="math inline">\(y = 2a \sin^2
                                    \theta\)</span>が結論される。これはスネルの法則</p>
                                    <p><span class="math display">\[
                                    \frac{\sin \theta }{v} = C
                                    \]</span></p>
                                    <p>に等価である。したがって、変分原理からスネルの法則が導かれた。</p>
                                    <p>このように、何か連続的な経路(この場合は斜面の形を表す関数<span
                                    class="math inline">\(y(x)\)</span>)を与えると実数(この場合は通過時間)が決まるような問題は汎関数の最小化問題として定式化できることが多い。このような問題を変分問題と呼ぶ。被積分関数は、目的となる関数<span
                                    class="math inline">\(f(x)\)</span>とその導関数の関数<span
                                    class="math inline">\(F(f,f&#39;)\)</span>であることが多い。この時、最小化したい汎関数<span
                                    class="math inline">\(I\)</span>について汎関数微分を行い、第一変分がゼロとなる、という条件から<span
                                    class="math inline">\(f(x)\)</span>に関する微分方程式を得る。あとはこの微分方程式を解けば、目的の関数が得られる。この一連の手続きを変分法と呼ぶ。特に、汎関数<span
                                    class="math inline">\(I\)</span>について、関数を少し変化させた時の変化分<span
                                    class="math inline">\(\delta
                                    I\)</span>を変分と呼び、被積分関数<span
                                    class="math inline">\(F\)</span>の変化分<span
                                    class="math inline">\(\delta
                                    F\)</span>を計算することを「変分をとる」と呼ぶことが多い。</p>
                                    <h1
                                    id="オイラーラグランジュ方程式">オイラー・ラグランジュ方程式</h1>
                                    <p>さて、解析力学に戻ろう。位置と速度の関数としてラグランジアン<span
                                    class="math inline">\(L(x(t),v(t))\)</span>が与えられたとする。先程までの議論とは異なり、積分変数が<span
                                    class="math inline">\(x\)</span>から<span
                                    class="math inline">\(t\)</span>となり、<span
                                    class="math inline">\(x(t)\)</span>は時間の関数となることに注意。ここで、<span
                                    class="math inline">\(\dot{x} =
                                    v\)</span>であるので、以後は<span
                                    class="math inline">\(L(x,\dot{x})\)</span>と書こう。このラグランジアンを、適当な期間<span
                                    class="math inline">\(t_1 &lt; t
                                    &lt;
                                    t_2\)</span>について時間積分する。</p>
                                    <p><span class="math display">\[
                                    I = \int_{t_1}^{t_2} L(x,\dot{x}) dt
                                    \]</span></p>
                                    <p>この量<span
                                    class="math inline">\(I\)</span>を作用、この積分を作用積分と呼ぶ。ここで、運動の軌道<span
                                    class="math inline">\(x(t)\)</span>はこの作用が最小になるように決まることを要請するのが最小作用の原理であった。そのような軌道は汎関数微分がゼロとなるはずであるから、被積分関数である<span
                                    class="math inline">\(L\)</span>について変分を取ると、先程前の議論から</p>
                                    <p><span class="math display">\[
                                    \delta L = \left( \frac{\partial
                                    L}{\partial x} -
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{x}} \right)
                                    \right)\delta x
                                    \]</span></p>
                                    <p>となる。これが任意の<span
                                    class="math inline">\(\delta
                                    x\)</span>についてゼロとなるのだから、</p>
                                    <p><span class="math display">\[
                                    \frac{\partial L}{\partial x} -
                                    \frac{d}{dt}\left(\frac{\partial
                                    L}{\partial \dot{x}} \right) = 0
                                    \]</span></p>
                                    <p>が成り立つ。この式を
                                    <strong>オイラー・ラグランジュ方程式</strong>(Euler-Laglange
                                    equation)
                                    と呼ぶ。ユークリッド座標を用いた時、これがもとのニュートンの運動法定式に帰着するのは既に見た。その意味でこの式の情報量はニュートンの運動方程式と同じである。しかし、ニュートンの運動方程式がガリレイ変換に対してのみ共変であったのに対して、オイラー・ラグランジュ方程式はより広い範囲の変換に対して共変となる。これを利用すると変数変換が楽になる。</p>
                                    <p>さて、ラグランジアンは運動エネルギーとポテンシャルエネルギーの差であった。ポテンシャルエネルギーが時間に依存するようなケースでない限り、ラグランジアンは時間に陽に依存しないことが多い。ラグランジアンが時間に陽に依存しない場合、ベルトラミの公式が適用できる。すなわち、</p>
                                    <p><span class="math display">\[
                                    B = L - \dot{x} \frac{\partial
                                    L}{\partial \dot{q}}
                                    \]</span></p>
                                    <p>が時間不変量となる。ここで、ラグランジアンが</p>
                                    <p><span class="math display">\[
                                    L(x,\dot{x}) = \frac{1}{2}
                                    m\dot{x}^2 - U(x)
                                    \]</span></p>
                                    <p>の形であったとすると、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    B &amp;= L - \dot{x} \frac{\partial
                                    L}{\partial \dot{x}}\\
                                    &amp;= \frac{1}{2} m\dot{x}^2 - U(x)
                                    - m\dot{x}^2\\
                                    &amp;= - \left( \frac{1}{2}
                                    m\dot{x}^2 + U(x) \right)\\
                                    &amp;= -E
                                    \end{aligned}
                                    \]</span></p>
                                    <p>すなわち、エネルギー保存則を表している。また、これは自由変数を<span
                                    class="math inline">\(\dot{x}\)</span>から<span
                                    class="math inline">\(p =
                                    \partial_{\dot{x}}L\)</span>に取り直すルジャンドル変換をしたことに対応する。</p>
                                    <h1 id="停留条件">停留条件</h1>
                                    <p>これまで「力の釣り合いを与える座標は、ポテンシャル関数<span
                                    class="math inline">\(U(x)\)</span>を最小にするように決まる」「運動方程式の解は、作用を最小にするように決まる」などと「最小」という言葉を雑に使ってきた。しかし、実際に我々が要請しているのは、求めたい解(釣り合いの位置や運動方程式の解)に対して、ポテンシャルの変化分が一次のオーダーでゼロであるということだけであり、その点が最小であるとは限らない。</p>
                                    <p>いま、静止している物体に働く力が釣り合っているとする。すなわち、その物体の位置<span
                                    class="math inline">\(x\)</span>において、力<span
                                    class="math inline">\(F(x)=0\)</span>である。この時、物体の位置<span
                                    class="math inline">\(x\)</span>を少しずらした時にどうなるかは、<span
                                    class="math inline">\(x\)</span>まわりの<span
                                    class="math inline">\(F(x)\)</span>の関数形による。</p>
                                    <figure>
                                    <img src="fig/magnet.png"
                                    alt="磁石と力の釣り合い" />
                                    <figcaption
                                    aria-hidden="true">磁石と力の釣り合い</figcaption>
                                    </figure>
                                    <p>例えば、磁石のS極とN極の間に、小さな磁石があり、力が釣り合っているとしよう。両側が反発するように配置した場合、釣り合いの位置からずらしたら、元に戻るような力が働く。すなわち、釣り合いの位置はポテンシャルの最小値を与える。</p>
                                    <p>一方、引力がつりあうように磁石を配置すると、釣り合いの位置から少しでもずれたら力の均衡が崩れ、どちらかの磁石にくっついてしまうであろう。この場合、釣り合いの位置はポテンシャルの最大値を与える。</p>
                                    <p>また、微分がゼロであるような点は最大値、最小値を与えるとも限らない。例えば、<span
                                    class="math inline">\(0 \le x \le
                                    1\)</span>で定義された以下の関数を考える。</p>
                                    <p><span class="math display">\[
                                    f(x) = 6 x^3 - 9x^2 + 4x
                                    \]</span></p>
                                    <p>微分すると、</p>
                                    <p><span class="math display">\[
                                    f&#39;(x) = 18 x^2 - 18 x +4 =
                                    2(3x-1)(3x-2)
                                    \]</span></p>
                                    <p>すなわち、この関数は<span
                                    class="math inline">\(x=1/3,
                                    2/3\)</span>で微分がゼロとなる。しかし、図示してみるとわかるように、この関数は微分がゼロとなる点で最大値も最小値も与えない。</p>
                                    <figure>
                                    <img src="fig/stationary.png"
                                    alt="最大値、最小値、極大値、極小値" />
                                    <figcaption
                                    aria-hidden="true">最大値、最小値、極大値、極小値</figcaption>
                                    </figure>
                                    <p>この関数の<span
                                    class="math inline">\(x=1/3\)</span>の点のように、微分がゼロとなる点の近傍では最大値となるような点を
                                    <strong>極大</strong>(local maximum)
                                    と呼ぶ。同様に、<span
                                    class="math inline">\(x=2/3\)</span>のように、その点の近傍では最小となる点を
                                    <strong>極小</strong>(local minimum)
                                    と呼ぶ。</p>
                                    <p>この関数は以下の点において最大値、最小値、極大値、極小値を取る。</p>
                                    <ul>
                                    <li><span
                                    class="math inline">\(x=0\)</span>
                                    において最小値 <span
                                    class="math inline">\(f(0)=0\)</span></li>
                                    <li><span
                                    class="math inline">\(x=1/3\)</span>
                                    において極大値 <span
                                    class="math inline">\(f(1/3)=5/9\)</span></li>
                                    <li><span
                                    class="math inline">\(x=2/3\)</span>
                                    において極小値 <span
                                    class="math inline">\(f(2/3)=4/9\)</span></li>
                                    <li><span
                                    class="math inline">\(x=1\)</span>
                                    において最大値 <span
                                    class="math inline">\(f(1)=0\)</span></li>
                                    </ul>
                                    <p>また、<span
                                    class="math inline">\(f(x) =
                                    x^3\)</span>という関数を考えると、<span
                                    class="math inline">\(f&#39;(x) =
                                    0\)</span>であるが<span
                                    class="math inline">\(x=0\)</span>は極小も極大も与えない。また、二変数関数<span
                                    class="math inline">\(f(x,y) = x^2 -
                                    y^2\)</span>は、原点で<span
                                    class="math inline">\(x\)</span>,<span
                                    class="math inline">\(y\)</span>による偏微分がいずれもゼロとなるが、極大値も極小値も与えない。このような点を
                                    <strong>鞍点 </strong>(saddle point)
                                    と呼ぶ。このように、微分がゼロとなる点をまとめて　<strong>停留点</strong>(stationary
                                    point) と呼ぶ。</p>
                                    <p>作用積分においても、変分がゼロとなるような関数が必ずしも作用を最小にするとは限らない。極小値となることが多いので「極小作用の法則」と呼ぶこともあるが、例えば調和振動子などは作用積分が極小値を与えない。そういう意味で「停留作用の法則」と呼ぶのが最も正確である。しかし、本書では以後、最小作用の法則と呼び、あたかも運動方程式の解が作用を最小にするかのように説明する。</p>
                                    <h1
                                    id="変分原理のまとめ">変分原理のまとめ</h1>
                                    <p>運動方程式から出発し、ダランベールの原理からラグランジアンという量を考え、ラグランジアンの積分を作用と呼ぶと、運動方程式の解が作用積分を最小にするように決まるということを見た。この流れを逆に考え、まず世の中にラグランジアンというものがあり、その積分を作用と呼び、作用を最小にするように運動が決まっていると要請するのが変分原理(ハミルトンの原理)である。変分原理は原理であるから、そこに理由を求めることはできない。したがって、最小作用の原理を「自然は無駄を嫌う」のように理屈をつけるのはナンセンスである。しかし、意思を持たぬはずの物体が、何かのコストを最小にしようとしているかのように見えるのこと自体は興味く、なぜ世界がそのように記述されているのか考えてみるのは有益であろう。</p>
                                    <h1
                                    id="コラム最後に去るものからの手紙">コラム：最後に去るものからの手紙</h1>
                                    <p>神奈川県にある三崎臨海実験所は、日本最初の臨海実験所として創設されたが、第二次世界大戦中、海軍により接収され、特殊潜航艇の基地となっていた。そのために軍事施設とみなされ、終戦後に米軍に接収されることになる。接収のため米軍将校が実験所に来ると、入り口に張り紙がしてあるのを見つける。その張り紙にはこのようなことが書いてあった。「ここは60年の歴史を持つ海洋生物学の研究所です。もしあなたたちが東海岸から来たのなら、Woods
                                    Holeの名を聞いたことがあるかもしれません。
                                    西海岸から来たのなら、Pacific
                                    Grove、もしくはPuget Sound
                                    海洋研究所を知っていることでしょう。ここはそういう場所です。ここを手荒に扱わないでください。我々の平和的研究への道を閉ざさないでください。武器や戦争のための設備は壊してかまいません。でも、日本の学生のために実験設備は残しておいてください。あなたたちのここでの仕事が終わったら、大学に連絡をしてください。
                                    我々はこの科学の家に戻って来ます。」</p>
                                    <p>署名はなく、ただ最後に「The last
                                    one to go
                                    (最後に立ち去るものより)」とだけ記された張り紙は将校の心を動かした。その将校の手により、この張り紙は「あなた方の名声は、敵国にまで広がっていたようです」と、ウッズホール海洋生物学研究所(Marine
                                    Biological Laboratories,
                                    MBL)に送られた。書き置きには署名がなかったが、MBLの研究者は内容と筆跡からすぐに團勝磨によるものだとわかった。研究者たちは「Katy(團)とJean(團夫人)は無事だ！」と喜んだらしい。團勝磨は発生生物学者で、東京帝国大学を卒業後、ペンシルバニア大学に留学し、MBLで研究を行っていた。日本人が海外で呼びやすいようなニックネームを名乗ることはよくあるが、團はMBLでは「Katy」と名乗っていたらしい。團はMBLで多くの研究者と親交を深めるが、後に妻となり、日本に連れ帰ったジーン・クラークともここで知り合っている。</p>
                                    <p>この張り紙はTimes誌で「Appeal to
                                    the
                                    Goths」として大きく取り上げられた。「Goths」とはゴート族のことで、以前、西ゴート族がローマを陥落させ、略奪した事件になぞらえたらしい。この手紙が将校の心を動かしたおかげかはわからないが、三崎臨海実験所は破壊を免れる。米軍の接収解除はその年の大晦日、米軍が撤収したのは翌年3月であり、そこから実験所の復旧を始める。破壊を免れたとはいえ内部はひどい状況であり、後片付けだけで一年近くを要したらしい。しかし、実験所は復活し、現在も東大理学系研究科附属臨海実験所として今に至る。團勝磨が残した書き置きは、今もウッズホール海洋生物学研究所に飾られている。</p>
                                    <p>参考：<a
                                    href="https://woodsholemuseum.org/oldpages/sprtsl/v30n2-lastone.pdf">ウッズホール海洋生物学研究所の記事</a></p>
                    </article>
    </body>

    </html>