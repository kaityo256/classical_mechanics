<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <meta name="generator" content="pandoc">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
                                <title>変分原理</title>

        <style>
            .btn-square {
                display: inline-block;
                padding: 0.5em 0.5em;
                text-decoration: none;
                background: #668ad8;
                color: #FFF;
                border-bottom: solid 4px #626295;
                border-radius: 5px;
            }

            .btn-square:active {
                -webkit-transform: translateY(4px);
                transform: translateY(4px);
                border-bottom: none;
            }

            .markdown-body {
                box-sizing: border-box;
                min-width: 200px;
                max-width: 980px;
                margin: 0 auto;
                padding: 45px;
            }

            @media (max-width: 767px) {
                .markdown-body {
                    padding: 15px;
                }
            }
        </style>

        <meta name="viewport" content="width=device-width, initial-scale=1">

                <script
                src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
                type="text/javascript"></script>
                        <link href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" rel="stylesheet">
        <link rel="icon" href="https://kaityo256.github.io/classical_mechanics/favicon.ico">
        <link rel="stylesheet" href="https://kaityo256.github.io/classical_mechanics/github-markdown.css"
            type="text/css" />
    </head>

    <body>
        <article class="markdown-body">
                                    <header>
                <h1 class="title">変分原理</h1>
                                                            </header>
                                    <p><a href="../index.html">[Up]</a>
                                    <a
                                    href="https://github.com/kaityo256/classical_mechanics">[Repository]</a></p>
                                    <h1
                                    id="本章で学ぶこと">本章で学ぶこと</h1>
                                    <p>ニュートン力学では、ニュートンの運動方程式が出発点であり、「その運動方程式はどこから来たか」に答えることができなかった。しかし、解析力学では、最小作用の原理から運動方程式を導く。これにより、運動方程式よりも一歩引いた立場から運動を記述、理解できるようになる。最小作用の原理は、変分原理と呼ばれるものの一種である。以下では、変分原理の例としてスネルの法則、最速降下曲線、懸垂線について紹介し、これらを一般的に扱うために汎関数微分を導入する。</p>
                                    <h1
                                    id="スネルの法則">スネルの法則</h1>
                                    <figure>
                                    <img src="fig/snell.png"
                                    alt="スネルの法則" />
                                    <figcaption
                                    aria-hidden="true">スネルの法則</figcaption>
                                    </figure>
                                    <p>まずは簡単な例からはじめよう。A地点からB地点まで行きたいとする。ただし、A地点付近は草原で歩きやすく、B地点は歩きにくい沼地の中にある。草原と沼地が直線で接しており、A地点、<span
                                    class="math inline">\(B\)</span>地点から境界までの距離はそれぞれ<span
                                    class="math inline">\(h_A\)</span>、<span
                                    class="math inline">\(h_B\)</span>、A地点とB地点の横方向の距離は<span
                                    class="math inline">\(L\)</span>であるとする。A地点からB地点まで最短で到達できる経路はどのようになるか？</p>
                                    <p>草原の中、沼地の中など、歩きやすさが同じところでは、経路は直線となるであろう。従って、草原と沼地の境界にX地点をとり、その最適な場所を探すことを考える。なるべく草原を多く歩いたほうが得なのでAXを長くとりたいが、AXを長く取りすぎると全体としての経路が伸びてしまうために時間もかかる。どこかにちょうどよい点があるはずである。</p>
                                    <p>この問題を考えるため、直線AXの長さを<span
                                    class="math inline">\(l_A\)</span>、XBの長さを<span
                                    class="math inline">\(l_B\)</span>とする。草原を歩く時の速度を<span
                                    class="math inline">\(v_A\)</span>、沼地を歩く時の速度を<span
                                    class="math inline">\(v_B\)</span>とする(<span
                                    class="math inline">\(v_A&gt;v_B\)</span>)。A地点からX地点までの水平方向の距離を<span
                                    class="math inline">\(x\)</span>とすると、X地点からB地点までの水平方向の距離は<span
                                    class="math inline">\(L-x\)</span>となる。また、A地点、B地点から境界までの最短距離をそれぞれ<span
                                    class="math inline">\(h_A\)</span>、<span
                                    class="math inline">\(h_B\)</span>としよう。</p>
                                    <p>全体を歩くのにかかる時間<span
                                    class="math inline">\(T(x)\)</span>は</p>
                                    <p><span class="math display">\[
                                    T(x) = \frac{l_A}{v_A} +
                                    \frac{l_B}{v_B}
                                    \]</span></p>
                                    <p>ただし、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    l_A(x) &amp;= \sqrt{h_A^2 + x^2} \\
                                    l_B(x) &amp;= \sqrt{h_B^2 + (L-x)^2}
                                    \\
                                    \end{aligned}
                                    \]</span></p>
                                    <p><span
                                    class="math inline">\(T(x)\)</span>を最小化する<span
                                    class="math inline">\(x\)</span>は<span
                                    class="math inline">\(T&#39;(x) =
                                    0\)</span>を満たすはずであるから、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    l_A&#39;(x) &amp;=
                                    \frac{x}{\sqrt{h_A^2 + x^2}} =
                                    \frac{x}{l_A} \\
                                    l_B&#39;(x) &amp;=
                                    \frac{-x}{\sqrt{h_B^2 + (L-x)^2}} =
                                    -\frac{L-x}{l_B}\\
                                    \end{aligned}
                                    \]</span></p>
                                    <p>に注意すると、</p>
                                    <p><span class="math display">\[
                                    T&#39;(x) = \frac{x}{l_A v_A} -
                                    \frac{L-x}{l_B v_B} = 0
                                    \]</span></p>
                                    <p>ここで、境界の法線に対して直線AX、XBのなす角をそれぞれ<span
                                    class="math inline">\(\theta_A\)</span>、<span
                                    class="math inline">\(\theta_B\)</span>とすると、三角関数の定義から、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \sin \theta_A &amp;= \frac{x}{l_A}
                                    \\
                                    \sin \theta_B &amp;= \frac{L-x}{l_B}
                                    \\
                                    \end{aligned}
                                    \]</span></p>
                                    <p>これを用いて先程の式を書き直すと、</p>
                                    <p><span class="math display">\[
                                    \frac{\sin \theta_A}{v_A} =
                                    \frac{\sin \theta_B}{v_B}
                                    \]</span></p>
                                    <p>これは、光線が平面に入射した場合、入射角と出射角(屈折角)と、その媒質中における光速との関係を表すスネルの法則にほかならない。</p>
                                    <p>TODO:
                                    変分原理とホイヘンスの原理図解？</p>
                                    <p>スネルの法則は、ホイヘンスの原理によっても説明できる。ホイヘンスの原理は、波の波面から二次波とよばれる新しい波が生じ、それらが強めあうところが次の波面となる、というもので、こちらはミクロな立場から屈折を説明する。</p>
                                    <p>一方、我々が求めたのは、「始点と終点が指定されている時、最も到達時間が短くなる経路」であり、これは変分原理の最も簡単な例となっている。光の場合、到達時間ではなく光路長を考えるのが一般的である。媒質中の光は真空中よりも速度が遅くなる。そこで、真空中での光速を媒質中の光速で割ったものを、その媒質の屈折率と呼ぶ。真空中での光速を<span
                                    class="math inline">\(c\)</span>とすると、屈折率<span
                                    class="math inline">\(n_A\)</span>を持つ媒質Aの中での速度<span
                                    class="math inline">\(v_A\)</span>は、屈折率の定義から</p>
                                    <p><span class="math display">\[
                                    v_A = \frac{c}{n_A}
                                    \]</span></p>
                                    <p>となる。これを用いると、A地点からB地点への光の到達時間<span
                                    class="math inline">\(T\)</span>は</p>
                                    <p><span class="math display">\[
                                    T = \frac{n_A l_A + n_B l_B}{c}
                                    \]</span></p>
                                    <p>となる。すなわち、実際の長さ<span
                                    class="math inline">\(l_A\)</span>に対して、光が感じる実効的な長さは<span
                                    class="math inline">\(n_A
                                    l_A\)</span>となっている。屈折率が大きい媒質であるほど光の速度は遅くなるため、光にとってその媒質は「進みにくい」物質となる。つまり、屈折率が大きいほど、光は実際の長さよりも長く感じることになる。この、実際の長さに屈折率をかけたものを光路長と呼び、光は光路長の総和を最小(停留)にするような経路を進む。これをフェルマーの原理と呼ぶ。</p>
                                    <p>もちろん光には意思はないため、異なる媒質に入射する前に「なるべく光路長を短くする経路を選ぼう」などとは思っていない。しかし、最終的に光が通った経路を見ると、それは始点と終点を決めた時に、もっとも光路長が短くなるように選ばれている。このように、何かの総和が最も小さくなるように経路などが決まると主張するのが変分原理である。ホイヘンスの原理が、ある瞬間の光の振る舞いに着目し、次の瞬間の光の位置を逐次的に決めていく形であるのに対して、変分原理は全体を見渡し、光の経路を一度に決めてしまう。このように、変分原理は全体を俯瞰する立場から振る舞いを決定する見方を与える。</p>
                                    <h1
                                    id="最速降下曲線">最速降下曲線</h1>
                                    <p>変分原理の有名な例として、最速降下曲線を考えよう。斜面に質点をそっと置いて離し、重力により滑らせる。ただし、摩擦は無視できるものとする。質点は斜面から離れることなく、なめらかに滑るとしよう。スタート地点とゴール地点を固定する時、もっとも早くゴールするような斜面はどのような形状であるか求めよ、というものが最速降下曲線の問題である。この問題はベルヌーイが解いて、数学者への挑戦という形で出題された。しばらく誰も解くことができなかったが、ニュートンがこれを一晩で解いて返送し、ベルヌーイが悔しがった、というのは有名な話である。</p>
                                    <figure>
                                    <img src="fig/bc_coordinate.png"
                                    alt="座標軸" />
                                    <figcaption
                                    aria-hidden="true">座標軸</figcaption>
                                    </figure>
                                    <p>問題を解くため、まず座標軸を設定しよう。質点を置く場所を原点にとる。最速降下曲線は下に落下していく問題だが、重力の働く方向を<span
                                    class="math inline">\(y\)</span>軸の正の向きにとる。</p>
                                    <p>さて、最速降下「曲線」というくらいだから答えは曲線となるのだが、これを折れ線で近似しよう。</p>
                                    <figure>
                                    <img src="fig/bc_snell.png"
                                    alt="折れ線近似" />
                                    <figcaption
                                    aria-hidden="true">折れ線近似</figcaption>
                                    </figure>
                                    <p>運動の始点を原点にとり、終点を<span
                                    class="math inline">\((L,
                                    H)\)</span>の場所に取ろう。<span
                                    class="math inline">\(L\)</span>を<span
                                    class="math inline">\(N\)</span>等分し、左から<span
                                    class="math inline">\(k\)</span>番目の場所を<span
                                    class="math inline">\(x_k\)</span>とする。位置<span
                                    class="math inline">\(x_k\)</span>から<span
                                    class="math inline">\(x_{k+1}\)</span>までは速度が一定であると近似し、その速度を<span
                                    class="math inline">\(v_k\)</span>としよう。</p>
                                    <p>位置<span
                                    class="math inline">\(x_k\)</span>における斜面の位置を<span
                                    class="math inline">\(y_k\)</span>とすると、エネルギー保存則より</p>
                                    <p><span class="math display">\[
                                    \frac{1}{2} m{v_k}^2 = mgy_k
                                    \]</span></p>
                                    <p>が成り立つ。従って、</p>
                                    <p><span class="math display">\[
                                    v(x_k) = \sqrt{2gy_k}
                                    \]</span></p>
                                    <p>また、位置<span
                                    class="math inline">\(x_k\)</span>から<span
                                    class="math inline">\(x+\Delta
                                    x\)</span>における曲線の長さ<span
                                    class="math inline">\(l(x_k)\)</span>は</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    l(x_k) &amp;=\sqrt{\Delta x^2 +
                                    (y_{k+1} - y_k)^2} \\
                                    &amp;\sim \Delta x \sqrt{1 +
                                    (y&#39;_k)^2} \\
                                    \end{aligned}
                                    \]</span></p>
                                    <p>ただし、<span
                                    class="math inline">\(y_{k+1} - y_k
                                    = y(x_k+\Delta x) - y(x_k) =
                                    y&#39;_k \Delta x + O(\Delta
                                    x^2)\)</span>を用いた。</p>
                                    <p>かかる時間の総和は</p>
                                    <p><span class="math display">\[
                                    T = \sum_{k=0}^{N-1}
                                    \frac{l(x_k)}{v(x_k)} \Delta x
                                    \]</span></p>
                                    <p>であるから、<span
                                    class="math inline">\(N\)</span>に関して連続極限をとれば、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    T &amp;= \int_0^L \frac{l(x)}{v(x)}
                                    dx \\
                                    &amp;= \int_0^L
                                    \frac{\sqrt{1+y&#39;^2}}{\sqrt{2gy}}
                                    dx
                                    \end{aligned}
                                    \]</span></p>
                                    <p>関数<span
                                    class="math inline">\(y(x)\)</span>は、スカラー量を入力とし、スカラー量を返すものであった。先程の<span
                                    class="math inline">\(T\)</span>は関数<span
                                    class="math inline">\(y(x)\)</span>を入力とし、出力としてスカラー量が決まるため、「関数の関数」とみなすことができる。それを表現して<span
                                    class="math inline">\(T[y]\)</span>と書くことがある。境界条件のもとで<span
                                    class="math inline">\(T[y]\)</span>を最小とするような関数<span
                                    class="math inline">\(y(x)\)</span>を見つけよ、というのが最速降下曲線問題である。</p>
                                    <p>この問題を、汎関数微分を用いて解くというのが本章の目的だが、まずは物理的な考察で解いてみよう。曲線を折れ線で近似した状態を考える。<span
                                    class="math inline">\(x_{k-1}\)</span>から<span
                                    class="math inline">\(x_k\)</span>までの領域の速度は<span
                                    class="math inline">\(v_{k-1}\)</span>であり、<span
                                    class="math inline">\(x_k\)</span>から<span
                                    class="math inline">\(x_{k+1}\)</span>までの速度が<span
                                    class="math inline">\(v_k\)</span>であるから、入射角<span
                                    class="math inline">\(\theta_{k-1}\)</span>と出射角<span
                                    class="math inline">\(\theta_k\)</span>を定義するとスネルの法則と同じ議論により</p>
                                    <p><span class="math display">\[
                                    \frac{\sin \theta_{k-1}}{v_{k-1}} =
                                    \frac{\sin \theta_k}{v_k}
                                    \]</span></p>
                                    <p>連続極限をとると、</p>
                                    <p><span class="math display">\[
                                    \frac{\sin \theta}{v} = C
                                    \]</span></p>
                                    <p>が場所に依らず成り立つ。ただし<span
                                    class="math inline">\(C\)</span>は定数である。傾きと三角関数の定義から</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    \frac{dy}{dx} &amp;=
                                    \tan\left(\frac{\pi}{2} - \theta
                                    \right) \\
                                    &amp;= - \frac{\cos \theta}{\sin
                                    \theta} \\
                                    &amp;= - \frac{\sqrt{1-\sin^2
                                    \theta}}{\sin \theta}
                                    \end{aligned}
                                    \]</span></p>
                                    <p><span class="math inline">\(\sin
                                    \theta = v C = C
                                    \sqrt{2gy}\)</span>を代入して整理すると、</p>
                                    <p><span class="math display">\[
                                    \frac{dy}{dx} = - \sqrt{\frac{2a -
                                    y}{y}}
                                    \]</span></p>
                                    <p>となる。ただし<span
                                    class="math inline">\(a =
                                    1/(4gC^2)\)</span>である。これを真面目に解いてみよう。</p>
                                    <p><span class="math inline">\(y =
                                    2au\)</span>と変数変換すると、</p>
                                    <p><span class="math display">\[
                                    \frac{du}{dx} = - \frac{1}{2a}
                                    \sqrt{\frac{1-u}{u}}
                                    \]</span></p>
                                    <p>さらに</p>
                                    <p><span class="math display">\[
                                    \tan \frac{s}{2} =
                                    \sqrt{\frac{u}{1-u}}
                                    \]</span></p>
                                    <p>と変数変換すると、半角公式</p>
                                    <p><span class="math display">\[
                                    \tan^2 \frac{s}{2} = \frac{1 - \cos
                                    s}{1  + \cos s}
                                    \]</span></p>
                                    <p>を用いて、ただちに</p>
                                    <p><span class="math display">\[
                                    u = \frac{1 + \cos s}{2}
                                    \]</span></p>
                                    <p>と求まる。両辺を微分すると</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    du &amp;= - \frac{\sin s}{2} ds \\
                                    &amp;= - \sin \frac{s}{2} \cos
                                    \frac{s}{2} ds
                                    \end{aligned}
                                    \]</span></p>
                                    <p><span class="math display">\[
                                    du = - \frac{1}{2a} \frac{\cos
                                    \frac{s}{2}}{\sin \frac{s}{2}} dx
                                    \]</span></p>
                                    <p>であったから、<span
                                    class="math inline">\(du\)</span>を消去して、</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    dx &amp;= 2a \sin^2 \frac{s}{2} ds
                                    \\
                                    &amp;= a (1 - \cos s) ds
                                    \end{aligned}
                                    \]</span></p>
                                    <p>両辺積分すると、</p>
                                    <p><span class="math display">\[
                                    x = a (x-\sin s)
                                    \]</span></p>
                                    <p><span
                                    class="math inline">\(y\)</span>と合わせて、以下の媒介変数表示での解を得る。</p>
                                    <p><span class="math display">\[
                                    \begin{aligned}
                                    x &amp;= a (s-\cos s) \\
                                    y &amp;= a (1 + \cos s) \\
                                    \end{aligned}
                                    \]</span></p>
                                    <p>これはサイクロイド曲線を表現している。</p>
                                    <h1 id="懸垂線">懸垂線</h1>
                                    <p>変分原理の題材のもう一つの例として、懸垂線を挙げよう。一様な重力下で紐の両端を持ち、少し緩める。この時、紐はどのような形になるであろうか。</p>
                                    <p>TODO: 力の釣り合い</p>
                                    <p>これは電信柱の間の電線が作る形状でもある。</p>
                                    <h1 id="汎関数微分">汎関数微分</h1>
                                    <h2 id="停留条件">停留条件</h2>
                                    <p>いま、静止している物体に働く力が釣り合っているとする。すなわち、その物体の位置<span
                                    class="math inline">\(x\)</span>において、力<span
                                    class="math inline">\(F(x)=0\)</span>である。この時、物体の位置<span
                                    class="math inline">\(x\)</span>を少しずらした時にどうなるかは、<span
                                    class="math inline">\(x\)</span>まわりの<span
                                    class="math inline">\(F(x)\)</span>の関数系による。</p>
                                    <p>TODO: 磁石の絵</p>
                                    <p>例えば、磁石のS極とN極の間に、小さな磁石があり、力が釣り合っているとしよう。</p>
                                    <p>TODO: 関数の図解</p>
                                    <p>$ 0 x
                                    $で定義された以下の関数を考える。</p>
                                    <p><span class="math display">\[
                                    f(x) = 6 x^3 - 9x^2 + 4x
                                    \]</span></p>
                                    <p>この関数は以下の点において最大値、最小値、極大値、極小値を取る。</p>
                                    <ul>
                                    <li><span
                                    class="math inline">\(x=0\)</span>
                                    において最小値 <span
                                    class="math inline">\(f(0)=0\)</span></li>
                                    <li><span
                                    class="math inline">\(x=1/3\)</span>
                                    において極大値 <span
                                    class="math inline">\(f(1/3)=5/9\)</span></li>
                                    <li><span
                                    class="math inline">\(x=2/3\)</span>
                                    において極小値 <span
                                    class="math inline">\(f(2/3)=4/9\)</span></li>
                                    <li><span
                                    class="math inline">\(x=1\)</span>
                                    において最大値 <span
                                    class="math inline">\(f(1)=0\)</span></li>
                                    </ul>
                                    <p>このうち、<span
                                    class="math inline">\(f&#39;(x) =
                                    0\)</span>となるのは、極小値と極大値を取る点のみである。</p>
                                    <h1 id="変分原理-1">変分原理</h1>
                                    <h1
                                    id="オイラーラグランジュ方程式">オイラー・ラグランジュ方程式</h1>
                    </article>
    </body>

    </html>