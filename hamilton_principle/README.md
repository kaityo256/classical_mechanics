# ハミルトンの原理

## 本章で学ぶこと

運動エネルギーを$K$、ポテンシャルエネルギーを$U$とすると、ラグランジアン$L$は$L=K-U$で与えられる。ここで、なぜ全エネルギー$K+U$ではなく、$K-U$なのか疑問に思う人も多いだろう。簡単にいえば「部分積分により負符号が出るから」なのだが、その物理的な意義は奥が深く、すぐに理解することは難しいかもしれない。以下では仮想仕事の原理と比較しながらラグランジアンの導出を行うことで、少なくとも数式上ではどのように$K-U$が出てくるかを理解する。

## ダランベールの原理

仮想仕事の原理は、力が釣り合っており物体が静止している場合、すなわち静力学に適用する原理であった。これを動力学に応用するため、まずダランベールの原理について述べる。

ニュートンの運動方程式から始めよう。

$$
m \frac{d^2x}{dt^2} = F
$$

ここで、運動方程式の二階微分が扱いづらいので、新たな変数$v$を用いて一階の連立微分方程式にしておく。

$$
\begin{aligned}
\frac{dx}{dt} &= v \\
m \frac{dv}{dt} &= F
\end{aligned}
$$

この微分方程式の気持ちは、運動方程式を$v$に関する一階の微分方程式に落とす代わりに、$x$に関する時間微分が$v$であるという条件の中で解を探しなさい、というものだ。

仮想仕事の原理では物体は静止していたために左辺はゼロであったが、今回は動いている場合を扱うのでゼロではない。さて、この運動方程式の左辺を右辺に移項しよう。

$$
0 = - m \frac{dv}{dt} + F
$$

ここで、慣性項$m v/dt$を力とみなすと、式の上では力が釣り合っているかのように見える。そこで、右辺を仮想的な力であるとみなし、$F_D$とおく。

$$
F_D = - m \frac{dv}{dt} + F
$$

そして、力$F_D$が働いている状態で、拘束条件を破らない仮想変位$\delta x$だけ動いた時の仮想仕事を考える。

$$
W = F_D \delta x
$$

いま、$F_D=0$であったのだから、この力のする仮想仕事はゼロである。

$$
W = (- m \frac{dv}{dt} + F) \delta x = 0
$$

これを **ダランベールの原理(d'Alembert's principle)** と呼ぶ。ダランベールの原理とは、加速度がゼロでない時に、慣性項を移項することで、あたかも力であるように解釈し、その上で仮想仕事の原理を適用しようとするものである。

特に、力が保存力である場合を考えると、

$$
F(x) = -U'(x)
$$

であるから、

$$
W = - m \frac{dv}{dt}\delta x  -U(x) \delta x = 0
$$

$$
\begin{aligned}
\delta U &\equiv U(x+\delta x) - U(x) \\
&= U'(x) \delta x\\
&= -F \delta x
\end{aligned}
$$

であるから、最終的にダランベールの原理は以下のように書ける。

$$
W = - m \frac{dv}{dt}\delta x -\delta U = 0
$$

さて、静力学における仮想仕事の原理では、釣り合いの位置$x$において力$F(x)$がゼロである、すなわち

$$
F(x) = 0
$$

という条件を、$F(x) = - U'(x)$を満たすポテンシャル関数$U(x)$を考え、

$$
\delta U \equiv U(x+\delta) - U(x) = 0
$$

を満たす$x$を探せ、という条件に読み替えた。これにより、「位置に依存するベクトル量である力$F(x)$がゼロになる$x$を探せ」という問題が、「あるスカラー関数の最小値を取るような$x$を探せ」という問題に読み替えられた。

動力学においても同様な手続きを考える。すなわち、「ある時刻において、$\dot{x} = v$という条件を満たす変数の組$(v, x)$について、運動方程式を満たすものを探せ。」という問題を、「あるスカラー関数を最小化するような速度$v$と位置$x$を探せ。ただし$v,x$は$\dot{x} = v$という条件を満たすものとする。」という問題に帰着させたい。そのために、保存力の場合のダランベールの原理をもう一度眺めてみる。

$$
W = - m \frac{dv}{dt}\delta x -\delta U = 0
$$

$\delta U$とは、位置が$x$から$x + \delta x$に移動した時のポテンシャルエネルギーの変化分である。これを、ポテンシャルエネルギーの変化が、運動エネルギーの変化に吸収されたと解釈したいので、運動エネルギーの変化を考える。運動エネルギーを速度$v$の関数

$$
K(v) = \frac{1}{2}mv^2
$$

とする。いま、位置$x$、速度$v$を持つ物体が、運動方程式に従って運動した結果、位置が$x+\delta x$、速度が $v + \delta v$に変化したと考えると、運動エネルギーの変化は以下で与えられる。

$$
\begin{aligned}
\delta K &\equiv K(v+\delta v) - K(v) \\
&=K'(v) \delta v \\
&= mv \delta v
\end{aligned}
$$

変化前の位置と速度、変化後の位置と速度がそれぞれ運動方程式を満たしていることから、

$$
\begin{aligned}
\frac{dx}{dt} &= v \\
\frac{d}{dt}(x+\delta x) &= v + \delta v
\end{aligned}
$$

したがって、

$$
\delta v = \frac{d}{dt} \delta x
$$

が満たされる。これを運動エネルギーの変化に代入すると、以下を得る。

$$
\delta K = m v \frac{d}{dt} \delta x
$$

これと、仮想仕事の運動エネルギーに由来すると思われる項$ -m (dv/dt) \delta x$を見比べると、部分積分したくなるであろう。これによりラグランジアンが導入される。

## ラグランジアンとハミルトンの原理

時刻$t_1$から時刻$t_2$まで、運動方程式の解$(v(t), x(t))$が得られたとしよう。我々はこれから、ダランベールの原理を使って、運動エネルギーとポテンシャルエネルギーの変化について追いかけたい。そこで、運動エネルギーの時間積分を考える。積分範囲は$t_1$から$t_2$までとしよう。

$$
\int_{t_1}^{t_2} K(v) dt
$$

ただし、この積分は、運動方程式の解$(v(t), x(t))$にそって実行するものとする。ここで、$t=t_1$と$t=t_2$における運動エネルギーを固定したまま、運動が少しずれた経路を辿ったと仮定する。この時の運動エネルギーの変化分の積分値を計算してみよう。

時刻$t$における速度は$v(t)$であったが、少しだけずれた経路$v(t) + \delta v(t)$を考える。ただし、最初と最後の運動エネルギーは固定しているから$\delta v(t_1)=\delta v(t_2)=0$である。運動エネルギーの変化分の積分値は

$$
\begin{aligned}
\delta \int_{t_1}^{t_2} K dt &= \int_{t_1}^{t_2}  \delta K dt \\
&= \int_{t_1}^{t_2} \left( K(v+\delta v) - K(v)\right) dt \\
&= \int_{t_1}^{t_2} K'(v) \delta v dt \\
&= \int_{t_1}^{t_2} m v \delta v dt \\
&= \int_{t_1}^{t_2} m v \frac{d}{dt} \left(\delta x\right) dt \\
&= - \int_{t_1}^{t_2} m \frac{dv}{dt} \delta x dv
\end{aligned}
$$

ここで、少しずれた経路での変数の組$(v+\delta v, x+\delta x)$は運動方程式を満たさないが、位置の微分が速度であるという条件は満たすので $\delta v = \dot{\delta x}$ であることを使った。

さて、ダランベールの原理により、

$$
- m \frac{dv}{dt} \delta x =  \delta U
$$

であったから、

$$
\int_{t_1}^{t_2} \delta K dt = \int_{t_1}^{t_2} \delta U dt
$$

以上から、
$$
\int_{t_1}^{t_2} \delta (K-U) dt = 0
$$
を得た。

さて、静力学においては、位置に依存する力$F(x)$がゼロであるような位置$x$を探すという力の釣り合い問題、すなわち

$$
F(x) = 0
$$

を満たす$x$を探せ、という問題を、力の積分であるポテンシャルエネルギー

$$
U(x) = \int F(x) dx
$$

を考え、

$U(x)$を最小にする$x$を探せ、という問題に読み替えた。

動力学でも同様に、ダランベールの原理から

$$
L(x, v) = K(v) - U(x)
$$

という量を考え、その積分の最小値を与えるような$(v(t),x(t))$の組を探す問題に帰着させる。静力学では時間変化がなかったので積分変数は$x$であったが、動力学では位置と速度が変化するため積分変数は$t$となる。

$$
I = \int L(x, v) dt
$$

この量$I$を **作用 (action)**、この積分を作用積分と呼び、作用積分を与えるような被積分関数$L$を **ラグランジアン (Lagrangian)** と呼ぶ。あるラグランジアンが与えられた時、物体の軌道$x(t)$は、この作用積分を最小にするように決まる。これを **ハミルトンの原理 (Hamilton's principle)** もしくは **最小作用の原理 (least action principle)** と呼ぶ。保存力に対するポテンシャル関数と対比し、ラグランジアンを運動ポテンシャルと呼ぶこともある。

## ラグランジアンと運動方程式

ラグランジアンとニュートンの運動方程式の関係を確認しておこう。簡単のため、一体かつ一次元の問題を考える。ポテンシャル力$U(x)$に支配された運動のラグランジアンは

$$
L(v, x) = \frac{1}{2}mv^2 - U(x)
$$

であった。これを$v$、$x$の独立な関数とみなして、まずは$x$で偏微分しよう。

$$
\frac{\partial L}{\partial x} = - U'(x).
$$

次に、$v$で偏微分する。

$$
\frac{\partial L}{\partial v} = mv.
$$

ニュートンの運動方程式はもともと

$$
m \frac{dv}{dt} = -U'(x)
$$

であったから、ラグランジアンで運動方程式を表現すると、

$$
\frac{d}{dt} \left(\frac{\partial L}{\partial v}\right) = \frac{\partial L}{\partial x}.
$$

もしくは、右辺を左辺に移項して

$$
\frac{d}{dt} \left(\frac{\partial L}{\partial v}\right) - \frac{\partial L}{\partial x} = 0.
$$

これを、**オイラー・ラグランジュ(Euler-Lagrange)の式**と呼ぶ。ニュートンの運動方程式を変形しただけであるから、本質的にはニュートンの運動方程式と等価な式であるが、後で見るようにこの形式で書いておくと変数変換が非常にやりやすくなる。

ここでは発見法的にラグランジアンと運動方程式の関係を導いたが、これはユークリッド座標でない場合には適用できない。一般の座標については、変分原理を用いて定式化される。変分原理については次章で扱う。

## ハミルトンの原理のまとめ

仮想仕事の原理では、位置の関数である力についてその原始関数であるポテンシャル関数を考え、そのポテンシャル関数が最小になるような点として釣り合いの点が決まると考えて定式化した。これを動力学に拡張するため、まずにより慣性項と力を同一視し、そこに仮想仕事の原理を適用した(ダランベールの原理)。しかし、一般に力は位置だけの関数であることが多いが、慣性項のポテンシャルに対応する運動エネルギーは一般に速度の関数となる。そこで、両者が依存する時間に対して積分した量をポテンシャルとして考え、それを最小にするように運動が決まると考える。この時、位置も速度も変化するが、速度が位置の時間微分であるという条件から部分積分することで、動力学におけるポテンシャルであるラグランジアンを導出した。ラグランジアンを(適切な境界条件のもと)時間積分したものが最小になるように運動が決まる、という主張がハミルトンの原理である。
