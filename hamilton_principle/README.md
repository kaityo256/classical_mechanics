# ハミルトンの原理

## 本章で学ぶこと

運動エネルギーを$K$、ポテンシャルエネルギーを$U$とすると、ラグランジアン$L$は$L=K-U$で与えられる。ここで、なぜ全エネルギー$K+U$ではなく、$K-U$なのか疑問に思う人も多いだろう。簡単にいえば「部分積分により負符号が出るから」なのだが、その物理的な意義は奥が深く、すぐに理解することは難しいかもしれない。以下では仮想仕事の原理と比較しながらラグランジアンの導出を行うことで、少なくとも数式上ではどのように$K-U$が出てくるかを理解する。

## ダランベールの原理

仮想仕事の原理は、力が釣り合っており物体が静止している場合、すなわち静力学に適用する原理であった。これを動力学に応用するため、まずダランベールの原理について述べる。

ニュートンの運動方程式から始めよう。

$$
m \frac{d^2x}{dt^2} = F
$$

ここで、運動方程式の二階微分が扱いづらいので、新たな変数$v$を用いて一階の連立微分方程式にしておく。

$$
\begin{aligned}
\frac{dx}{dt} &= v \\
m \frac{dv}{dt} &= F
\end{aligned}
$$

仮想仕事の原理では物体は静止していたために左辺はゼロであったが、今回は動いている場合を扱うのでゼロではない。さて、この運動方程式の左辺を右辺に移項しよう。

$$
0 = - m \frac{dv}{dt} + F
$$

ここで、慣性項$m v/dt$を力とみなすと、式の上では力が釣り合っているかのように見える。そこで、右辺を仮想的な力であるとみなし、$F_D$とおく。

$$
F_D = - m \frac{dv}{dt} + F
$$

そして、力$F_D$が働いている状態で、拘束条件を破らない仮想変位$\delta x$だけ動いた時の仮想仕事を考える。

$$
W = F_D \delta x
$$

いま、$F_D=0$であったのだから、この力のする仮想仕事はゼロである。

$$
W = (- m \frac{dv}{dt} + F) \delta x = 0
$$

これを **ダランベールの原理(d'Alembert's principle)** と呼ぶ。ダランベールの原理とは、加速度がゼロでない時に、慣性項を移項することで、あたかも力であるように解釈し、その上で仮想仕事の原理を適用しようとするものである。

特に、力が保存力である場合を考えると、

$$
F(x) = -U'(x)
$$

であるから、

$$
W = - m \frac{dv}{dt}\delta x  -U(x) \delta x = 0
$$

$$
\begin{aligned}
\delta U &\equiv U(x+\delta x) - U(x) \\
&= U'(x) \delta x\\
&= -F \delta x
\end{aligned}
$$

であるから、最終的にダランベールの原理は以下のように書ける。

$$
W = - m \frac{dv}{dt}\delta x -\delta U = 0
$$

さて、静力学における仮想仕事の原理では、釣り合いの位置$x$において力$F(x)$がゼロである、すなわち

$$
F(x) = 0
$$

という条件を、$F(x) = - U'(x)$を満たすポテンシャル関数$U(x)$を考え、

$$
\delta U \equiv U(x+\delta) - U(x) = 0
$$

を満たす$x$を探せ、という条件に読み替えた。これにより、「位置に依存するベクトル量である力$F(x)$がゼロになる$x$を探せ」という問題が、「あるスカラー関数の最小値を取るような$x$を探せ」という問題に読み替えられた。

動力学においても、同様なことをしたい。すなわち、「ある時刻において運動方程式を満たす速度$v$と位置$x$の組を探せ」という問題を、「あるスカラー関数を最小化するような速度$v$と位置$x$を探せ」という問題に帰着させたい。そのために、保存力の場合のダランベールの原理をもう一度眺めてみる。

$$
W = - m \frac{dv}{dt}\delta x -\delta U = 0
$$

$\delta U$とは、位置が$x$から$x + \delta x$に移動した時のポテンシャルエネルギーの変化分である。これを、ポテンシャルエネルギーの変化が、運動エネルギーの変化に吸収されたと解釈したいので、運動エネルギーの変分を考える。

$$
K(v) = \frac{1}{2}mv^2
$$

として、

$$
\begin{aligned}
\delta K &\equiv K(v+\delta v) - K(v) \\
&=K'(v) \delta v \\
&= mv \delta v
\end{aligned}
$$

ここで運動方程式から

$$
\delta v = \frac{d}{dt} \delta x
$$

を満たすので、

$$
\delta K = m v \frac{d}{dt} \delta x
$$

これと、仮想仕事の運動エネルギーに由来すると思われる項$ -m (dv/dt) \delta x$を見比べると、部分積分したくなるであろう。これによりラグランジアンが導入される。

## ラグランジアン

時刻$t_1$から時刻$t_2$まで、運動方程式の解$(v(t), x(t))$が得られたとしよう。我々はこれから、ダランベールの原理を使って、運動エネルギーとポテンシャルエネルギーの変化について追いかけたい。そこで、運動エネルギーの時間積分を考える。

$$
I = \int_{t_1}^{t_2} K(v) dt
$$

ただし、この積分は、運動方程式の解$v(t)$にそって実行するものとする。ここで、$t=t_1$と$t=t_2$における運動エネルギーを固定したまま、運動が少しずれた経路を辿ったと過程する。この時の運動エネルギーの変化分の積分値を計算してみる。

時刻$t$における速度は$v(t)$であったが、少しだけずれた経路$v(t) + \delta v(t)$を考える。ただし、最初と最後の運動エネルギーは固定しているから$\delta v(t_1)=\delta v(t_2)=0$である。運動エネルギーの変化分の積分値は

$$
\begin{aligned}
\delta I &= \delta \int_{t_1}^{t_2} K dt \\
&= \int_{t_1}^{t_2}  \delta K dt \\
&= \int_{t_1}^{t_2} K'(v) \delta v dt \\
&= \int_{t_1}^{t_2} m v \delta v dt \\
&= \int_{t_1}^{t_2} m v \frac{d}{dt} \left(\delta x\right) dt \\
&= - \int_{t_1}^{t_2} m \frac{dv}{dt} \delta x
\end{aligned}
$$

さて、ダランベールの原理により、
$$

- m \frac{dv}{dt} \delta x - \delta U = 0
$$
であったから、
$$
\begin{aligned}
\delta I &= \int_{t_1}^{t_2} \delta K dt \\
&= \int_{t_1}^{t_2} \delta U dt
\end{aligned}
$$

以上から、
$$
\int_{t_1}^{t_2} \delta (K-U) dt = 0
$$
を得た。

静力学においては、
$$
\delta U = 0 \Leftrightarrow F=0
$$
のように、力が釣り合っているという条件をポテンシャルの変分がゼロであるという条件に読み替えた。そこで、動力学でも同様に、
$$
L(v, x) = K(v) - U(x)
$$
という量を考え、
$$
\delta L = 0 \Leftrightarrow m\frac{dv}{dt} = -U'(x)
$$
という関係式を要求する。この量$L$を力学ポテンシャル、もしくはラグランジアンと呼ぶ。静力学において、釣り合いの位置がポテンシャルエネルギーを最小にする場所として決まったように、運動は、この力学ポテンシャルを最小にするように選ばれる。より正確に言えば、これを最小にするような速度$v$、位置$x$が、もともとの運動方程式の解となるように、この力学ポテンシャルが選ばれている。

## オイラー・ラグランジュ方程式

ラグランジアンを用いた運動方程式の表現を導いておこう。簡単のため、一体かつ一次元の問題を考える。ポテンシャル力$U(x)$に支配された運動のラグランジアンは

$$
L(v, x) = \frac{1}{2}mv^2 - U(x)
$$

であった。これを$v$、$x$の独立な関数とみなして、まずは$x$で偏微分しよう。

$$
\frac{\partial L}{\partial x} = - U'(x).
$$

次に、$v$で偏微分する。

$$
\frac{\partial L}{\partial v} = mv.
$$

ニュートンの運動方程式はもともと

$$
m \frac{dv}{dt} = -U'(x)
$$

であったから、ラグランジアンで運動方程式を表現すると、

$$
\frac{d}{dt} \left(\frac{\partial L}{\partial v}\right) = \frac{\partial L}{\partial x}.
$$

もしくは、右辺を左辺に移項して

$$
\frac{d}{dt} \left(\frac{\partial L}{\partial v}\right) - \frac{\partial L}{\partial x} = 0.
$$

これを、**オイラー・ラグランジュ(Euler-Lagrange)の式**と呼ぶ。ニュートンの運動方程式を変形しただけであるから、本質的にはニュートンの運動方程式と等価な式であるが、後で見るようにこの形式で書いておくと変数変換が非常にやりやすくなる。
