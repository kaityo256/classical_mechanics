# 仮想仕事の原理

ここまで長い間準備をしてきたが、いよいよ解析力学に入る。解析力学の目的は、同じ現象を一歩ひいた観点から記述することだ。その第一歩が仮想仕事の原理である。ニュートン力学では、力という直接目に見えるものを、ポテンシャルという目に見えないものから導出されるものとして記述した。仮想仕事の原理では、力の釣り合いという静力学を仮想仕事という観点から記述する。これは後にダランベールの原理を用いて動力学へ拡張され、変分原理によりラグランジュ形式の力学へと繋がっていく。

## 仕事

仮想仕事について学ぶ前に、仕事について復習しておこう。物体に力$F$が働き、力と同じ方向に距離$x$だけ移動したとする。この時、その積$W=Fx$を **仕事(work)** と呼ぶ。物体は、受けた仕事の分だけエネルギーを得る。以下ではそれを見てみよう。

保存力のみが働いている系では、エネルギーが保存しているのであった。今、保存力$F$の他に、外部からの力$F_\mathrm{ex}$が働いているとする。運動方程式は以下のように書ける。

$$
m\frac{dx^2}{dt^2} = F + F_\mathrm{ex}.
$$

保存力だけ左辺に移項しよう。

$$
m\frac{dx^2}{dt^2} -F = F_\mathrm{ex}.
$$

$F$は保存力であるから、あるポテンシャル関数$U(x)$が存在し、$F=-U'(x)$と表現できる。

$$
m\frac{dx^2}{dt^2} + U'(x) = F_\mathrm{ex}.
$$

両辺を$x$で積分する。積分範囲は$x_i$から$x_f$までとしよう。

$$
\int_{x_i}^{x_f} \left(m\frac{dx^2}{dt^2}\right)dx + \int_{x_i}^{x_f} U'(x)dx = \int_{x_i}^{x_f}F_\mathrm{ex} dx.
$$

ここで

$$
\begin{aligned}
m \frac{dx^2}{dt^2} &= m \frac{dv}{dt} \\
&= m \frac{dv}{dx} \underbrace{\frac{dx}{dt}}_{v} \\
&= m v \frac{dv}{dx} \\
&= \frac{d}{dx}\left( \frac{1}{2}mv^2\right)
\end{aligned}
$$

従って、全エネルギーを

$$
E(x) = \frac{1}{2}mv^2 + U
$$

により定義すると、

$$
\int_{x_i}^{x_f} \frac{dE}{dx} dx = \int_{x_i}^{x_f}F_\mathrm{ex} dx
$$

つまり、

$$
\Delta E \equiv E(x_f) - E(x_i) = \int_{x_i}^{x_f}F_\mathrm{ex} dx
$$

となった。左辺は、物体のエネルギーの変化を表している。ここで、右辺の量を

$$
W \equiv \int_{x_i}^{x_f}F_\mathrm{ex} dx
$$

と定義すると

$$
\Delta E = W.
$$

つまり、物体のエネルギーの変化$\Delta E$は、物体にかかる外力の距離に関する積分$W$だけ変化する。この$W$が仕事と呼ぶ。

2つほど簡単な例を挙げよう。

TODO:図解

まず、物体が平面上に静止した状態から、一定の力$F_\mathrm{ex}$をかけ続けて距離$l$だけ運動させた結果、速度が$V$になったとしよう。運動方程式は

$$
m \frac{d^2 x}{dt^2} = F_\mathrm{ex}
$$

両辺を$x$で積分すると、

$$
\int_0^l m \frac{d^2 x}{dt^2}dx = F_\mathrm{ex} l
$$

左辺は

$$
\begin{aligned}
\int_0^l m \frac{d^2 x}{dt^2}dx &= \int_0^l \frac{d}{dx} \left(\frac{1}{2}mv^2 \right) dx \\
&= \left[ \frac{1}{2}mv^2 \right]_0^l\\
&= \frac{1}{2}mV^2
\end{aligned}
$$

つまり、

$$
F_\mathrm{ex} l = \frac{1}{2}mV^2
$$

であり、外からした仕事が運動エネルギーに変換されたことがわかる。

TODO:図解

次に、バネ定数$k$のバネにつながれた物体を、釣り合いの位置で静止した状態から距離$l$だけ正の方向に引っ張り、最後に静止させるような操作を考える。運動方程式は以下で与えられる。

$$
m \frac{d^2 x}{dt^2} = -kx + F_\mathrm{ex}.
$$

両辺を$0$から$l$まで$x$で積分すると、

$$
\left[\frac{1}{2}mv^2 + \frac{1}{2}kx^2 \right]_0^l = \int_0^l F_\mathrm{ex} dx \equiv W
$$

物体は最初と最後は静止していたのであるから$v=0$なので

$$
\frac{1}{2}kx^2 = W.
$$

要するに、与えられた仕事が位置エネルギーに変換されたことがわかる。

ここまで「当たり前だ」と思うかもしれないが、我々は運動方程式しか使っていないことに注意してほしい。運動方程式を出発として、等式変形しているだけであるから、ここで得られた情報は全ては運動方程式にもともと含まれている。しかし、運動方程式を変形することでエネルギーや仕事という概念を作り出すことができた。これにより、微分方程式を直接解くことなく運動をより直感的かつ平易に扱うことができる。また、運動方程式は一般にベクトルを扱う必要があるが、エネルギーや仕事はスカラー量であるために、より扱いやすいという利点もある。

## 仮想仕事の原理

物体に働く力が釣り合っている状態を考える。力が位置の関数$F(x)$として与えられているとしよう。例えば、バネにぶら下げられた物体において、バネによる上向きの力と重力による下向きの力が釣り合っている状態を考える。この釣り合いの位置を$x_0$すると、

$$
F(x_0) = 0
$$

である。この力を表すポテンシャルを$U(x)$としよう。ポテンシャル関数を微分し、負符号をつけたものが力であった。

$$
F(x) = -U'(x)
$$

釣り合いの位置近傍において、ポテンシャル関数をテイラー展開しよう。

$$
U(x_0+\delta x) = U(x_0) + U'(x_0)\delta x +U''(x)\frac{\delta x^2}{2} + O(\delta x^3)
$$

釣り合いの位置では力がゼロであるから、

$$
U'(x_0)\delta x = -F(x_0) \delta x = 0
$$

となる。ここで、$F(x_0) \delta x$は力と距離の積であるから、仕事の次元を持っている。そこで、

$$
W = F(x_0) \delta x
$$

とし、$W$を **仮想仕事(virtual work)** 、$\delta x$を **仮想変位(virtual displacement** と呼ぶ。定義から、力の釣り合いの近傍では仮想仕事はゼロとなる。ここまでは、単に力の釣り合い近傍では、対応するポテンシャルの一次微分がゼロである、ということを言っているにすぎない。

TODO: 図解

次に、系に束縛条件がある場合を考える。束縛条件とは、系の運動を制限するような条件のことである。例えば、摩擦のない斜面にバネでぶら下がって静止している質量$m$の物体を考えよう。この物体に働く力は、バネからの力$F$、重力$mg$、そして斜面からの抗力$N$である。抗力$N$は、物体を斜面上に制限するように働くため、束縛力の一種である。

この物体に働く力の関係を、まずは仮想仕事を使わずに求めてみよう。斜面の角度を$\theta$とし、鉛直方向を$y$軸、水平方向を$x$軸にとると、運動方程式は

$$
\begin{aligned}
m\ddot{x} &= F \cos \theta - N\sin \theta \\
m\ddot{y} &= F \sin \theta + N \cos \theta - mg
\end{aligned}
$$

静止状態であれば$\ddot{x} = \ddot{y} = 0$である。これらの式から$N$を消去すると、

$$
F = mg \sin \theta
$$

という関係式が求まる。

次に、この式を仮想変位の観点から考えてみよう。物体は斜面をすべることしかできないから、その方向に$x$軸をとる。系は一次元的に運動するから、$y$軸は考える必要はない。

いま、物体を釣り合いの状態から斜面を登る方向に$\delta x$だけ仮想的に動かしたとする。すると、バネが物体にする仕事が$F\delta x$、重力の方向に下るため、重力が物体にする仕事は$-mg \sin \theta \delta x$。従って、この物体にされる仮想仕事$W$は

$$
\begin{aligned}
W &= F \delta x - mg \sin \theta \delta x \\
&= (F - mg \sin \theta) \delta x
\end{aligned}
$$

これがゼロであることから、ただちに

$$
F = mg \sin \theta
$$

という関係式が求まった。先程の運動方程式を経由する方法に比べて、抗力$N$が全く現れなかったことに注意したい。一般に、束縛力は仕事をしない。そして仮想変位は束縛条件を破らない方向にとるため、その向きは必ず束縛力と直交する。これにより、仮想仕事について考えれば、どうせ後で消去する束縛力を考慮せずに済む。

以上の話を一般化しよう。三次元空間中にある質点に力$\boldsymbol{F}$が働いている。質点の位置を$\boldsymbol{r}$とすると、運動方程式は以下のように書ける。

$$
m \ddot{\boldsymbol{r}} = \boldsymbol{F}
$$

TODO:続きを書く。

TODO: 拘束条件、自由度、一般化座標について書く。

例えば、光が屈折率の異なる媒質に入射すると屈折するという観測事実がスネルの法則である。この法則をミクロな立場から、波面の重ね合わせで説明するのがホイヘンスの原理である。しかし、光線の始点と終点を与えた時、光線は最も光路長が短くなる経路を選ぶという説明がフェルマーの原理である。どちらも同じ現象を説明する原理であるが、後者は、まるで光がこれから進もうとする世界を全て知った上で計画的に経路を選んでいるかのように解釈する。

仮想仕事の原理も同様であり、力という量に対して、それを位置で積分したポテンシャルという量を考え、「釣り合いの位置にいる」という条件を「力がゼロであるような位置にいる」という条件から「ポテンシャルを最小にするような位置にいる」という条件に読み替える。すると、物体が感じているのはその場における力だけであるにも関わらず、位置の関数であるポテンシャルをより広い範囲で「知って」おり、その最小値を取るような場所を選んでいるかのように扱う。この立場をさらに発展させ、動力学に拡張したのが次回で学ぶハミルトンの原理である。

## 余談：雑草の名前

「三角関数なんて日常生活では使わないのだから学んでも無駄だ」という話題を定期的に見かける。数学でサインやコサインを習った時、加法定理や倍角、半角公式といった大量の公式に辟易した人は多いであろう。ほとんどの人にとってそんな公式を日常使うことなどないのだから、なぜこんなものを学ばなければならないのか疑問に思うのも当然である。もちろん、三角関数は様々なところに顔を出す、非常に重要な概念であるから学ぶのであるが、それ以外にも学問には「世界を広げる」という重要な役割がある。

歩いてると、ふと道端にある雑草が目に止まったとしよう。普段気にもかけていなかったが、小さく可愛らしい青い花が気になり、スマートフォンで画像検索し、それが「オオイヌノフグリ」という名前であることを知る。そして「イヌノフグリ」が「犬の陰嚢」であることを知って、なんでこんな可愛らしい花にそんな名前をつけたのか、と思うかもしれない。

「世の中に雑草という名の草はない」という言葉があるが、別に全ての雑草の名前を知る必要はない。ただ、オオイヌノフグリを知ったことで、他の雑草にも名前があり、それぞれになんらかの由来があるということが想像できる。それだけで世界が広がっている。

ニュートン力学で用は足りるのだから、解析力学を学ぶ必要などない。技術者でもなければ、電磁気学を学ぶ必要もないだろう。しかし、解析力学を学ぶと、バネにつながった質点が振動している様子を見て円運動を思い浮かべることができる。電磁気学を学ぶと、電子レンジ中ので飛び交う電磁波に思いを馳せたり、なぜ釣り人が偏光サングラスをしているのかが理解できたりする。それらを学ぶ前に比べて少しだけ世界が違って見える。多くの学問は日常生活に直結しないが、学んだあなたに、少しだけ異なる世界の見方を提供する。それはあなたの生活を少しだけ豊かにしてくれることであろう。
